{
"chunks": [
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 0,
"heading": "",
"global_index": 0,
"start_char": 0,
"end_char": 167
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 1,
"heading": "ABSTRACT",
"global_index": 1,
"start_char": 169,
"end_char": 1395
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 2,
"heading": "1. INTRODUCTION",
"global_index": 2,
"start_char": 1397,
"end_char": 3401
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 3,
"heading": "1. INTRODUCTION",
"global_index": 3,
"start_char": 3401,
"end_char": 5194
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 4,
"heading": "1. INTRODUCTION",
"global_index": 4,
"start_char": 4985,
"end_char": 6652
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 5,
"heading": "2. PROBLEM STATEMENT",
"global_index": 5,
"start_char": 6654,
"end_char": 8675
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 6,
"heading": "2. PROBLEM STATEMENT",
"global_index": 6,
"start_char": 8675,
"end_char": 10775
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 7,
"heading": "2. PROBLEM STATEMENT",
"global_index": 7,
"start_char": 10775,
"end_char": 11253
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 8,
"heading": "2. PROBLEM STATEMENT",
"global_index": 8,
"start_char": 10753,
"end_char": 11340
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 9,
"heading": "3. GPU: OVERVIEW AND K-SELECTION",
"global_index": 9,
"start_char": 11342,
"end_char": 13399
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 10,
"heading": "3. GPU: OVERVIEW AND K-SELECTION",
"global_index": 10,
"start_char": 13399,
"end_char": 15494
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 11,
"heading": "3. GPU: OVERVIEW AND K-SELECTION",
"global_index": 11,
"start_char": 15494,
"end_char": 17548
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 12,
"heading": "3. GPU: OVERVIEW AND K-SELECTION",
"global_index": 12,
"start_char": 17548,
"end_char": 17978
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 13,
"heading": "3. GPU: OVERVIEW AND K-SELECTION",
"global_index": 13,
"start_char": 17286,
"end_char": 19111
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 14,
"heading": "4. FAST K-SELECTION ON THE GPU",
"global_index": 14,
"start_char": 19113,
"end_char": 20365
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 15,
"heading": "4. FAST K-SELECTION ON THE GPU",
"global_index": 15,
"start_char": 20365,
"end_char": 22198
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 16,
"heading": "4. FAST K-SELECTION ON THE GPU",
"global_index": 16,
"start_char": 22198,
"end_char": 22764
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 17,
"heading": "4. FAST K-SELECTION ON THE GPU",
"global_index": 17,
"start_char": 22343,
"end_char": 24252
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 18,
"heading": "4. FAST K-SELECTION ON THE GPU",
"global_index": 18,
"start_char": 24252,
"end_char": 26106
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 19,
"heading": "4. FAST K-SELECTION ON THE GPU",
"global_index": 19,
"start_char": 26106,
"end_char": 26839
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 20,
"heading": "0. All lanes",
"global_index": 20,
"start_char": 26505,
"end_char": 27480
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 21,
"heading": "0. All lanes",
"global_index": 21,
"start_char": 27482,
"end_char": 29445
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 22,
"heading": "0. All lanes",
"global_index": 22,
"start_char": 29445,
"end_char": 30072
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 23,
"heading": "5. COMPUTATION LAYOUT",
"global_index": 23,
"start_char": 29857,
"end_char": 31927
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 24,
"heading": "5. COMPUTATION LAYOUT",
"global_index": 24,
"start_char": 31927,
"end_char": 32885
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 25,
"heading": "64. The codes are stored as sequential groups of bbytes per",
"global_index": 25,
"start_char": 32722,
"end_char": 32937
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 26,
"heading": "64. The codes are stored as sequential groups of bbytes per",
"global_index": 26,
"start_char": 32939,
"end_char": 34994
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 27,
"heading": "64. The codes are stored as sequential groups of bbytes per",
"global_index": 27,
"start_char": 34994,
"end_char": 36900
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 28,
"heading": "64. The codes are stored as sequential groups of bbytes per",
"global_index": 28,
"start_char": 36900,
"end_char": 38933
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 29,
"heading": "64. The codes are stored as sequential groups of bbytes per",
"global_index": 29,
"start_char": 38429,
"end_char": 38743
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 30,
"heading": "6. EXPERIMENTS & APPLICATIONS",
"global_index": 30,
"start_char": 38745,
"end_char": 40529
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 31,
"heading": "6. EXPERIMENTS & APPLICATIONS",
"global_index": 31,
"start_char": 40529,
"end_char": 42596
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 32,
"heading": "6. EXPERIMENTS & APPLICATIONS",
"global_index": 32,
"start_char": 42596,
"end_char": 44086
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 33,
"heading": "6. EXPERIMENTS & APPLICATIONS",
"global_index": 33,
"start_char": 43719,
"end_char": 45236
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 34,
"heading": "104. We compare the search performance in terms of same",
"global_index": 34,
"start_char": 45238,
"end_char": 47224
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 35,
"heading": "104. We compare the search performance in terms of same",
"global_index": 35,
"start_char": 47224,
"end_char": 48329
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 36,
"heading": "104. We compare the search performance in terms of same",
"global_index": 36,
"start_char": 48074,
"end_char": 50149
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 37,
"heading": "104. We compare the search performance in terms of same",
"global_index": 37,
"start_char": 50149,
"end_char": 51520
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 38,
"heading": "8. REFERENCES",
"global_index": 38,
"start_char": 51466,
"end_char": 52849
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 39,
"heading": "8. REFERENCES",
"global_index": 39,
"start_char": 52851,
"end_char": 55132
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 40,
"heading": "8. REFERENCES",
"global_index": 40,
"start_char": 55132,
"end_char": 57389
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 41,
"heading": "8. REFERENCES",
"global_index": 41,
"start_char": 57389,
"end_char": 59603
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 42,
"heading": "8. REFERENCES",
"global_index": 42,
"start_char": 59603,
"end_char": 60699
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 43,
"heading": "8. REFERENCES",
"global_index": 43,
"start_char": 59907,
"end_char": 62013
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 44,
"heading": "8. REFERENCES",
"global_index": 44,
"start_char": 62013,
"end_char": 64020
},
{
"doc_id": "Billion-scale_similarity_search_with_GPUs",
"chunk_index": 45,
"heading": "8. REFERENCES",
"global_index": 45,
"start_char": 64020,
"end_char": 65421
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 0,
"heading": "",
"global_index": 46,
"start_char": 0,
"end_char": 1993
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 1,
"heading": "",
"global_index": 47,
"start_char": 1993,
"end_char": 4011
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 2,
"heading": "",
"global_index": 48,
"start_char": 4011,
"end_char": 4301
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 3,
"heading": "",
"global_index": 49,
"start_char": 4085,
"end_char": 6143
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 4,
"heading": "",
"global_index": 50,
"start_char": 6143,
"end_char": 8059
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 5,
"heading": "",
"global_index": 51,
"start_char": 8059,
"end_char": 9232
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 6,
"heading": "",
"global_index": 52,
"start_char": 8902,
"end_char": 10939
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 7,
"heading": "",
"global_index": 53,
"start_char": 10939,
"end_char": 12887
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 8,
"heading": "",
"global_index": 54,
"start_char": 12887,
"end_char": 13828
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 9,
"heading": "",
"global_index": 55,
"start_char": 13435,
"end_char": 15493
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 10,
"heading": "",
"global_index": 56,
"start_char": 15493,
"end_char": 17569
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 11,
"heading": "",
"global_index": 57,
"start_char": 17569,
"end_char": 18108
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 12,
"heading": "",
"global_index": 58,
"start_char": 17861,
"end_char": 19810
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 13,
"heading": "",
"global_index": 59,
"start_char": 19810,
"end_char": 20777
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 14,
"heading": "# Train: all (59k)Figure 1: Retriever top- kaccuracy with different num-",
"global_index": 60,
"start_char": 20532,
"end_char": 21674
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 15,
"heading": "# Train: all (59k)Figure 1: Retriever top- kaccuracy with different num-",
"global_index": 61,
"start_char": 21676,
"end_char": 23703
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 16,
"heading": "# Train: all (59k)Figure 1: Retriever top- kaccuracy with different num-",
"global_index": 62,
"start_char": 23703,
"end_char": 25759
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 17,
"heading": "# Train: all (59k)Figure 1: Retriever top- kaccuracy with different num-",
"global_index": 63,
"start_char": 25759,
"end_char": 26584
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 18,
"heading": "# Train: all (59k)Figure 1: Retriever top- kaccuracy with different num-",
"global_index": 64,
"start_char": 26246,
"end_char": 28283
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 19,
"heading": "# Train: all (59k)Figure 1: Retriever top- kaccuracy with different num-",
"global_index": 65,
"start_char": 28283,
"end_char": 30121
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 20,
"heading": "# Train: all (59k)Figure 1: Retriever top- kaccuracy with different num-",
"global_index": 66,
"start_char": 30121,
"end_char": 31166
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 21,
"heading": "# Train: all (59k)Figure 1: Retriever top- kaccuracy with different num-",
"global_index": 67,
"start_char": 30737,
"end_char": 32573
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 22,
"heading": "# Train: all (59k)Figure 1: Retriever top- kaccuracy with different num-",
"global_index": 68,
"start_char": 32573,
"end_char": 34563
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 23,
"heading": "# Train: all (59k)Figure 1: Retriever top- kaccuracy with different num-",
"global_index": 69,
"start_char": 34563,
"end_char": 35075
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 24,
"heading": "# Train: all (59k)Figure 1: Retriever top- kaccuracy with different num-",
"global_index": 70,
"start_char": 34723,
"end_char": 36758
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 25,
"heading": "# Train: all (59k)Figure 1: Retriever top- kaccuracy with different num-",
"global_index": 71,
"start_char": 36758,
"end_char": 38812
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 26,
"heading": "# Train: all (59k)Figure 1: Retriever top- kaccuracy with different num-",
"global_index": 72,
"start_char": 38812,
"end_char": 39792
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 27,
"heading": "# Train: all (59k)Figure 1: Retriever top- kaccuracy with different num-",
"global_index": 73,
"start_char": 39373,
"end_char": 41418
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 28,
"heading": "# Train: all (59k)Figure 1: Retriever top- kaccuracy with different num-",
"global_index": 74,
"start_char": 41418,
"end_char": 43483
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 29,
"heading": "# Train: all (59k)Figure 1: Retriever top- kaccuracy with different num-",
"global_index": 75,
"start_char": 43483,
"end_char": 44027
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 30,
"heading": "2019. Latent retrieval for weakly supervised open",
"global_index": 76,
"start_char": 43505,
"end_char": 44264
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 31,
"heading": "2018. Denoising distantly supervised open-domain",
"global_index": 77,
"start_char": 44320,
"end_char": 46469
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 32,
"heading": "2018. Denoising distantly supervised open-domain",
"global_index": 78,
"start_char": 46469,
"end_char": 48540
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 33,
"heading": "2018. Denoising distantly supervised open-domain",
"global_index": 79,
"start_char": 48540,
"end_char": 49277
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 34,
"heading": "2018. Denoising distantly supervised open-domain",
"global_index": 80,
"start_char": 48740,
"end_char": 50806
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 35,
"heading": "2018. Denoising distantly supervised open-domain",
"global_index": 81,
"start_char": 50806,
"end_char": 52713
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 36,
"heading": "2018. Denoising distantly supervised open-domain",
"global_index": 82,
"start_char": 52713,
"end_char": 53246
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 37,
"heading": "2018. Denoising distantly supervised open-domain",
"global_index": 83,
"start_char": 52938,
"end_char": 54963
},
{
"doc_id": "Dense_Passage_Retrieval_for_Open-Domain_Question_Answering",
"chunk_index": 38,
"heading": "2018. Denoising distantly supervised open-domain",
"global_index": 84,
"start_char": 54963,
"end_char": 55879
},
{
"doc_id": "PASSAGE_RE-RANKING_WITH_BERT",
"chunk_index": 0,
"heading": "",
"global_index": 85,
"start_char": 0,
"end_char": 194
},
{
"doc_id": "PASSAGE_RE-RANKING_WITH_BERT",
"chunk_index": 1,
"heading": "ABSTRACT",
"global_index": 86,
"start_char": 196,
"end_char": 2051
},
{
"doc_id": "PASSAGE_RE-RANKING_WITH_BERT",
"chunk_index": 2,
"heading": "ABSTRACT",
"global_index": 87,
"start_char": 2051,
"end_char": 3460
},
{
"doc_id": "PASSAGE_RE-RANKING_WITH_BERT",
"chunk_index": 3,
"heading": "ABSTRACT",
"global_index": 88,
"start_char": 3311,
"end_char": 5309
},
{
"doc_id": "PASSAGE_RE-RANKING_WITH_BERT",
"chunk_index": 4,
"heading": "ABSTRACT",
"global_index": 89,
"start_char": 5309,
"end_char": 7013
},
{
"doc_id": "PASSAGE_RE-RANKING_WITH_BERT",
"chunk_index": 5,
"heading": "ABSTRACT",
"global_index": 90,
"start_char": 6902,
"end_char": 8970
},
{
"doc_id": "PASSAGE_RE-RANKING_WITH_BERT",
"chunk_index": 6,
"heading": "ABSTRACT",
"global_index": 91,
"start_char": 8970,
"end_char": 9289
},
{
"doc_id": "PASSAGE_RE-RANKING_WITH_BERT",
"chunk_index": 7,
"heading": "ABSTRACT",
"global_index": 92,
"start_char": 9100,
"end_char": 9347
},
{
"doc_id": "PASSAGE_RE-RANKING_WITH_BERT",
"chunk_index": 8,
"heading": "REFERENCES",
"global_index": 93,
"start_char": 9349,
"end_char": 11505
},
{
"doc_id": "PASSAGE_RE-RANKING_WITH_BERT",
"chunk_index": 9,
"heading": "REFERENCES",
"global_index": 94,
"start_char": 11505,
"end_char": 12437
},
{
"doc_id": "PASSAGE_RE-RANKING_WITH_BERT",
"chunk_index": 10,
"heading": "REFERENCES",
"global_index": 95,
"start_char": 12185,
"end_char": 13441
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 0,
"heading": "",
"global_index": 96,
"start_char": 0,
"end_char": 2047
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 1,
"heading": "",
"global_index": 97,
"start_char": 2047,
"end_char": 4075
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 2,
"heading": "",
"global_index": 98,
"start_char": 4075,
"end_char": 4659
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 3,
"heading": "",
"global_index": 99,
"start_char": 4269,
"end_char": 6295
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 4,
"heading": "",
"global_index": 100,
"start_char": 6295,
"end_char": 8155
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 5,
"heading": "",
"global_index": 101,
"start_char": 8155,
"end_char": 9118
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 6,
"heading": "",
"global_index": 102,
"start_char": 8797,
"end_char": 10842
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 7,
"heading": "",
"global_index": 103,
"start_char": 10842,
"end_char": 12825
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 8,
"heading": "",
"global_index": 104,
"start_char": 12825,
"end_char": 13201
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 9,
"heading": "",
"global_index": 105,
"start_char": 12753,
"end_char": 14798
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 10,
"heading": "",
"global_index": 106,
"start_char": 14798,
"end_char": 16630
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 11,
"heading": "",
"global_index": 107,
"start_char": 16630,
"end_char": 17200
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 12,
"heading": "",
"global_index": 108,
"start_char": 16820,
"end_char": 18854
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 13,
"heading": "",
"global_index": 109,
"start_char": 18854,
"end_char": 19846
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 14,
"heading": "",
"global_index": 110,
"start_char": 19599,
"end_char": 21451
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 15,
"heading": "",
"global_index": 111,
"start_char": 21451,
"end_char": 23538
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 16,
"heading": "",
"global_index": 112,
"start_char": 23538,
"end_char": 23901
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 17,
"heading": "",
"global_index": 113,
"start_char": 23468,
"end_char": 25553
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 18,
"heading": "",
"global_index": 114,
"start_char": 25553,
"end_char": 27505
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 19,
"heading": "",
"global_index": 115,
"start_char": 27505,
"end_char": 28787
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 20,
"heading": "",
"global_index": 116,
"start_char": 28660,
"end_char": 30566
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 21,
"heading": "",
"global_index": 117,
"start_char": 30566,
"end_char": 32464
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 22,
"heading": "2019. Latent retrieval for weakly supervised open",
"global_index": 118,
"start_char": 32203,
"end_char": 33693
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 23,
"heading": "2021. Rethinking search: making domain experts",
"global_index": 119,
"start_char": 33748,
"end_char": 34914
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 24,
"heading": "2021. Rethinking search: making domain experts",
"global_index": 120,
"start_char": 34914,
"end_char": 36981
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 25,
"heading": "2021. Rethinking search: making domain experts",
"global_index": 121,
"start_char": 36981,
"end_char": 39024
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 26,
"heading": "2021. Rethinking search: making domain experts",
"global_index": 122,
"start_char": 39024,
"end_char": 39608
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 27,
"heading": "2021. Rethinking search: making domain experts",
"global_index": 123,
"start_char": 39221,
"end_char": 40201
},
{
"doc_id": "Precise_Zero-Shot_Dense_Retrieval_without_Relevance_Labels",
"chunk_index": 28,
"heading": "2021. Rethinking search: making domain experts",
"global_index": 124,
"start_char": 40203,
"end_char": 41059
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 0,
"heading": "",
"global_index": 125,
"start_char": 0,
"end_char": 1970
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 1,
"heading": "",
"global_index": 126,
"start_char": 1970,
"end_char": 3062
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 2,
"heading": "",
"global_index": 127,
"start_char": 2901,
"end_char": 4829
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 3,
"heading": "",
"global_index": 128,
"start_char": 4829,
"end_char": 6900
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 4,
"heading": "",
"global_index": 129,
"start_char": 6900,
"end_char": 7845
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 5,
"heading": "",
"global_index": 130,
"start_char": 7467,
"end_char": 9533
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 6,
"heading": "",
"global_index": 131,
"start_char": 9533,
"end_char": 11180
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 7,
"heading": "",
"global_index": 132,
"start_char": 11111,
"end_char": 13192
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 8,
"heading": "",
"global_index": 133,
"start_char": 13192,
"end_char": 15202
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 9,
"heading": "",
"global_index": 134,
"start_char": 15202,
"end_char": 15569
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 10,
"heading": "",
"global_index": 135,
"start_char": 15311,
"end_char": 17338
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 11,
"heading": "",
"global_index": 136,
"start_char": 17338,
"end_char": 19329
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 12,
"heading": "",
"global_index": 137,
"start_char": 19329,
"end_char": 20156
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 13,
"heading": "",
"global_index": 138,
"start_char": 19872,
"end_char": 21912
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 14,
"heading": "",
"global_index": 139,
"start_char": 21912,
"end_char": 23795
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 15,
"heading": "",
"global_index": 140,
"start_char": 23795,
"end_char": 24309
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 16,
"heading": "",
"global_index": 141,
"start_char": 23967,
"end_char": 25978
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 17,
"heading": "",
"global_index": 142,
"start_char": 25978,
"end_char": 28032
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 18,
"heading": "",
"global_index": 143,
"start_char": 28032,
"end_char": 28514
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 19,
"heading": "",
"global_index": 144,
"start_char": 28283,
"end_char": 30355
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 20,
"heading": "",
"global_index": 145,
"start_char": 30355,
"end_char": 31612
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 21,
"heading": "",
"global_index": 146,
"start_char": 31445,
"end_char": 33395
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 22,
"heading": "",
"global_index": 147,
"start_char": 33395,
"end_char": 35432
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 23,
"heading": "",
"global_index": 148,
"start_char": 35432,
"end_char": 36048
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 24,
"heading": "",
"global_index": 149,
"start_char": 35573,
"end_char": 37643
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 25,
"heading": "",
"global_index": 150,
"start_char": 37643,
"end_char": 39523
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 26,
"heading": "",
"global_index": 151,
"start_char": 39362,
"end_char": 41479
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 27,
"heading": "",
"global_index": 152,
"start_char": 41479,
"end_char": 43395
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 28,
"heading": "",
"global_index": 153,
"start_char": 43150,
"end_char": 45294
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 29,
"heading": "",
"global_index": 154,
"start_char": 45294,
"end_char": 47378
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 30,
"heading": "",
"global_index": 155,
"start_char": 47158,
"end_char": 49270
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 31,
"heading": "",
"global_index": 156,
"start_char": 49270,
"end_char": 51303
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 32,
"heading": "",
"global_index": 157,
"start_char": 51303,
"end_char": 51651
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 33,
"heading": "",
"global_index": 158,
"start_char": 51193,
"end_char": 53293
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 34,
"heading": "",
"global_index": 159,
"start_char": 53293,
"end_char": 55386
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 35,
"heading": "",
"global_index": 160,
"start_char": 55386,
"end_char": 55670
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 36,
"heading": "",
"global_index": 161,
"start_char": 55202,
"end_char": 57350
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 37,
"heading": "",
"global_index": 162,
"start_char": 57350,
"end_char": 59455
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 38,
"heading": "",
"global_index": 163,
"start_char": 59229,
"end_char": 60371
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 39,
"heading": "",
"global_index": 164,
"start_char": 60373,
"end_char": 62296
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 40,
"heading": "",
"global_index": 165,
"start_char": 62296,
"end_char": 63116
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 41,
"heading": "",
"global_index": 166,
"start_char": 62936,
"end_char": 64985
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 42,
"heading": "",
"global_index": 167,
"start_char": 64985,
"end_char": 66857
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 43,
"heading": "",
"global_index": 168,
"start_char": 66857,
"end_char": 67545
},
{
"doc_id": "Retrieval-Augmented_Generation_for_Knowledge-Intensive_NLP_Tasks",
"chunk_index": 44,
"heading": "",
"global_index": 169,
"start_char": 67185,
"end_char": 69149
}
],
"corpus_tokens": [
[
"billion",
"scale",
"similarity",
"search",
"with",
"gpus",
"jeff",
"johnson",
"facebook",
"ai",
"research",
"new",
"y",
"orkmatthijs",
"douze",
"facebook",
"ai",
"research",
"parisherv",
"e",
"j",
"egou",
"facebook",
"ai",
"research",
"paris"
],
[
"similarity",
"search",
"application",
"in",
"specialized",
"database",
"systems",
"handling",
"complex",
"data",
"such",
"as",
"images",
"or",
"videos",
"which",
"are",
"typically",
"represented",
"by",
"high",
"dimensional",
"features",
"and",
"require",
"indexing",
"structures",
"this",
"paper",
"tackles",
"the",
"problem",
"of",
"better",
"utilizing",
"gpus",
"for",
"this",
"task",
"while",
"gpus",
"excel",
"at",
"data",
"parallel",
"tasks",
"prior",
"approaches",
"are",
"bot",
"tlenecked",
"by",
"algorithms",
"that",
"expose",
"less",
"parallelism",
"such",
"as",
"k",
"min",
"selection",
"or",
"make",
"poor",
"use",
"of",
"the",
"memory",
"hierarchy",
"we",
"propose",
"a",
"design",
"for",
"k",
"selection",
"that",
"operates",
"at",
"up",
"to",
"55",
"of",
"theoretical",
"peak",
"performance",
"enabling",
"a",
"nearest",
"neighbor",
"implementation",
"that",
"is",
"8",
"5",
"faster",
"than",
"prior",
"gpu",
"state",
"of",
"the",
"art",
"we",
"apply",
"it",
"in",
"similarity",
"search",
"scenarios",
"by",
"proposing",
"optimized",
"design",
"for",
"brute",
"force",
"ap",
"proximate",
"and",
"compressed",
"domain",
"search",
"based",
"on",
"product",
"quantization",
"in",
"all",
"these",
"setups",
"we",
"outperform",
"the",
"state",
"of",
"the",
"art",
"by",
"large",
"margins",
"our",
"implementation",
"enables",
"the",
"construction",
"of",
"a",
"high",
"accuracy",
"k",
"nn",
"graph",
"on",
"95",
"million",
"images",
"from",
"the",
"yfcc100m",
"dataset",
"in",
"35",
"minutes",
"and",
"of",
"a",
"graph",
"connecting",
"1",
"billion",
"vectors",
"in",
"less",
"than",
"12",
"hours",
"on",
"4",
"maxwell",
"titan",
"x",
"gpus",
"we",
"have",
"open",
"sourced",
"our",
"approach1for",
"the",
"sake",
"of",
"comparison",
"and",
"reproducibility"
],
[
"images",
"and",
"videos",
"constitute",
"a",
"new",
"massive",
"source",
"of",
"data",
"for",
"indexing",
"and",
"search",
"extensive",
"metadata",
"for",
"this",
"con",
"tent",
"is",
"often",
"not",
"available",
"search",
"and",
"interpretation",
"of",
"this",
"and",
"other",
"human",
"generated",
"content",
"like",
"text",
"is",
"and",
"important",
"a",
"variety",
"of",
"machine",
"learning",
"and",
"deep",
"learn",
"ing",
"algorithms",
"are",
"being",
"used",
"to",
"interpret",
"and",
"classify",
"these",
"complex",
"real",
"world",
"entities",
"popular",
"examples",
"include",
"the",
"text",
"representation",
"known",
"as",
"word2vec",
"32",
"representations",
"of",
"images",
"by",
"convolutional",
"neural",
"networks",
"39",
"19",
"and",
"im",
"age",
"descriptors",
"for",
"instance",
"search",
"20",
"such",
"representations",
"orembeddings",
"are",
"usually",
"real",
"valued",
"high",
"dimensional",
"vec",
"tors",
"of",
"50",
"to",
"1000",
"dimensions",
"many",
"of",
"these",
"vector",
"repre",
"sentations",
"can",
"only",
"be",
"produced",
"on",
"gpu",
"systems",
"1https",
"github",
"com",
"facebookresearch",
"faissas",
"the",
"underlying",
"processes",
"either",
"have",
"high",
"arithmetic",
"com",
"plexity",
"and",
"or",
"high",
"data",
"bandwidth",
"demands",
"28",
"or",
"cannot",
"be",
"partitioned",
"without",
"failing",
"due",
"to",
"communi",
"cation",
"overhead",
"or",
"representation",
"quality",
"38",
"once",
"pro",
"duced",
"their",
"manipulation",
"is",
"itself",
"arithmetically",
"intensive",
"however",
"how",
"to",
"utilize",
"gpu",
"assets",
"is",
"not",
"straightforward",
"more",
"generally",
"how",
"to",
"exploit",
"new",
"heterogeneous",
"architec",
"tures",
"is",
"a",
"key",
"subject",
"for",
"the",
"database",
"community",
"9",
"in",
"this",
"context",
"searching",
"by",
"numerical",
"similarity",
"rather",
"than",
"via",
"structured",
"relations",
"is",
"more",
"suitable",
"this",
"could",
"be",
"to",
"the",
"most",
"similar",
"content",
"to",
"a",
"picture",
"or",
"to",
"the",
"vectors",
"that",
"have",
"the",
"highest",
"response",
"to",
"a",
"linear",
"on",
"all",
"vectors",
"of",
"a",
"collection",
"one",
"of",
"the",
"most",
"expensive",
"operations",
"to",
"be",
"performed",
"on",
"large",
"collections",
"is",
"to",
"compute",
"a",
"k",
"nn",
"graph",
"it",
"is",
"a",
"directed",
"graph",
"where",
"each",
"vector",
"of",
"the",
"database",
"is",
"a",
"node",
"and",
"each",
"edge",
"connects",
"a",
"node",
"to",
"its",
"knearest",
"neighbors",
"this",
"is",
"our",
"application",
"note",
"state",
"of",
"the",
"art",
"methods",
"like",
"nn",
"descent",
"15",
"have",
"a",
"large",
"memory",
"overhead",
"on",
"top",
"of",
"the",
"dataset",
"itself",
"and",
"cannot",
"readily",
"scale",
"to",
"the",
"billion",
"sized",
"databases",
"we",
"consider"
],
[
"this",
"is",
"our",
"application",
"note",
"state",
"of",
"the",
"art",
"methods",
"like",
"nn",
"descent",
"15",
"have",
"a",
"large",
"memory",
"overhead",
"on",
"top",
"of",
"the",
"dataset",
"itself",
"and",
"cannot",
"readily",
"scale",
"to",
"the",
"billion",
"sized",
"databases",
"we",
"consider",
"such",
"applications",
"must",
"deal",
"with",
"the",
"curse",
"of",
"dimension",
"ality",
"46",
"rendering",
"both",
"exhaustive",
"search",
"or",
"exact",
"index",
"ing",
"for",
"non",
"exhaustive",
"search",
"impractical",
"on",
"billion",
"scale",
"databases",
"this",
"is",
"why",
"there",
"is",
"a",
"large",
"body",
"of",
"work",
"on",
"approximate",
"search",
"and",
"or",
"graph",
"construction",
"to",
"handle",
"huge",
"datasets",
"that",
"do",
"not",
"in",
"ram",
"several",
"approaches",
"employ",
"an",
"internal",
"compressed",
"representation",
"of",
"the",
"vec",
"tors",
"using",
"an",
"encoding",
"this",
"is",
"especially",
"convenient",
"for",
"memory",
"limited",
"devices",
"like",
"gpus",
"it",
"turns",
"out",
"that",
"accept",
"ing",
"a",
"minimal",
"accuracy",
"loss",
"results",
"in",
"orders",
"of",
"magnitude",
"of",
"compression",
"21",
"the",
"most",
"popular",
"vector",
"compression",
"methods",
"can",
"be",
"into",
"either",
"binary",
"codes",
"18",
"22",
"or",
"quantization",
"methods",
"25",
"37",
"both",
"have",
"the",
"desirable",
"property",
"that",
"searching",
"neighbors",
"does",
"not",
"require",
"recon",
"structing",
"the",
"vectors",
"our",
"paper",
"focuses",
"on",
"methods",
"based",
"on",
"product",
"quanti",
"zation",
"pq",
"codes",
"as",
"these",
"were",
"shown",
"to",
"be",
"more",
"than",
"binary",
"codes",
"34",
"in",
"addition",
"binary",
"codes",
"incur",
"im",
"portant",
"overheads",
"for",
"non",
"exhaustive",
"search",
"methods",
"35",
"several",
"improvements",
"were",
"proposed",
"after",
"the",
"original",
"prod",
"uct",
"quantization",
"proposal",
"known",
"as",
"ivfadc",
"25",
"most",
"are",
"to",
"implement",
"on",
"gpu",
"for",
"instance",
"the",
"inverted",
"multi",
"index",
"4",
"useful",
"for",
"high",
"speed",
"low",
"quality",
"operating",
"points",
"depends",
"on",
"a",
"complicated",
"multi",
"sequence",
"algorithm",
"the",
"optimized",
"product",
"quantization",
"or",
"opq",
"17",
"is",
"a",
"linear",
"transformation",
"on",
"the",
"input",
"vectors",
"that",
"improves",
"the",
"accuracy",
"of",
"the",
"product",
"quantization",
"it",
"can",
"be",
"applied",
"1arxiv",
"1702",
"08734v1",
"cs",
"cv",
"28",
"feb",
"2017"
],
[
"as",
"a",
"pre",
"processing",
"the",
"simd",
"optimized",
"ivfadc",
"imple",
"mentation",
"from",
"2",
"operates",
"only",
"with",
"sub",
"optimal",
"parame",
"ters",
"few",
"coarse",
"quantization",
"centroids",
"many",
"other",
"meth",
"ods",
"like",
"lopq",
"and",
"the",
"polysemous",
"codes",
"27",
"16",
"are",
"too",
"complex",
"to",
"be",
"implemented",
"on",
"gpus",
"there",
"are",
"many",
"implementations",
"of",
"similarity",
"search",
"on",
"gpus",
"but",
"mostly",
"with",
"binary",
"codes",
"36",
"small",
"datasets",
"44",
"or",
"exhaustive",
"search",
"14",
"40",
"41",
"to",
"the",
"best",
"of",
"our",
"knowl",
"edge",
"only",
"the",
"work",
"by",
"wieschollek",
"et",
"al",
"47",
"appears",
"suit",
"able",
"for",
"billion",
"scale",
"datasets",
"with",
"quantization",
"codes",
"this",
"is",
"the",
"prior",
"state",
"of",
"the",
"art",
"on",
"gpus",
"which",
"we",
"compare",
"against",
"in",
"section",
"6",
"4",
"this",
"paper",
"makes",
"the",
"following",
"contributions",
"a",
"gpuk",
"selection",
"algorithm",
"operating",
"in",
"fast",
"register",
"memory",
"and",
"enough",
"to",
"be",
"fusable",
"with",
"other",
"kernels",
"for",
"which",
"we",
"provide",
"a",
"complexity",
"analysis",
"a",
"near",
"optimal",
"algorithmic",
"layout",
"for",
"exact",
"and",
"ap",
"proximatek",
"nearest",
"neighbor",
"search",
"on",
"gpu",
"a",
"range",
"of",
"experiments",
"that",
"show",
"that",
"these",
"improve",
"ments",
"outperform",
"previous",
"art",
"by",
"a",
"large",
"margin",
"on",
"mid",
"to",
"large",
"scale",
"nearest",
"neighbor",
"search",
"tasks",
"in",
"single",
"or",
"multi",
"gpu",
"the",
"paper",
"is",
"organized",
"as",
"follows",
"section",
"2",
"introduces",
"the",
"context",
"and",
"notation",
"section",
"3",
"reviews",
"gpu",
"archi",
"tecture",
"and",
"discusses",
"problems",
"appearing",
"when",
"using",
"it",
"for",
"similarity",
"search",
"section",
"4",
"introduces",
"one",
"of",
"our",
"main",
"con",
"tributions",
"i",
"e",
"our",
"k",
"selection",
"method",
"for",
"gpus",
"while",
"sec",
"tion",
"5",
"provides",
"details",
"regarding",
"the",
"algorithm",
"computation",
"layout",
"finally",
"section",
"6",
"provides",
"extensive",
"experiments",
"for",
"our",
"approach",
"compares",
"it",
"to",
"the",
"state",
"of",
"the",
"art",
"and",
"shows",
"concrete",
"use",
"cases",
"for",
"image",
"collections"
],
[
"we",
"are",
"concerned",
"with",
"similarity",
"search",
"in",
"vector",
"collec",
"tions",
"given",
"the",
"query",
"vector",
"x",
"rdand",
"the",
"collection2",
"yi",
"i",
"0",
"yi",
"rd",
"we",
"search",
"l",
"k",
"argmini",
"0",
"x",
"yi",
"2",
"1",
"i",
"e",
"we",
"search",
"the",
"knearest",
"neighbors",
"of",
"xin",
"terms",
"of",
"l2",
"distance",
"the",
"l2",
"distance",
"is",
"used",
"most",
"often",
"as",
"it",
"is",
"op",
"timized",
"by",
"design",
"when",
"learning",
"several",
"embeddings",
"e",
"g",
"20",
"due",
"to",
"its",
"attractive",
"linear",
"algebra",
"properties",
"the",
"lowest",
"distances",
"are",
"collected",
"by",
"k",
"selection",
"for",
"an",
"array",
"ai",
"i",
"0",
"k",
"selection",
"the",
"klowest",
"valued",
"elements",
"asi",
"i",
"0",
"k",
"asi",
"asi",
"1",
"along",
"with",
"the",
"indices",
"si",
"i",
"0",
"k",
"0",
"si",
"of",
"those",
"elements",
"from",
"the",
"input",
"array",
"the",
"aiwill",
"be",
"32",
"bit",
"point",
"values",
"the",
"siare",
"32",
"or",
"64",
"bit",
"integers",
"other",
"comparators",
"are",
"sometimes",
"desired",
"e",
"g",
"for",
"cosine",
"similarity",
"we",
"search",
"for",
"highest",
"values",
"the",
"order",
"between",
"equivalent",
"keys",
"asi",
"asjis",
"not",
"batching",
"typically",
"searches",
"are",
"performed",
"in",
"batches",
"ofnqquery",
"vectors",
"xj",
"j",
"0",
"nq",
"xj",
"rd",
"in",
"parallel",
"which",
"allows",
"for",
"more",
"when",
"executing",
"on",
"multiple",
"cpu",
"threads",
"or",
"on",
"gpu",
"batching",
"for",
"k",
"selection",
"entails",
"selecting",
"nq",
"kelements",
"and",
"indices",
"from",
"nqseparate",
"arrays",
"where",
"each",
"array",
"is",
"of",
"a",
"potentially",
"length",
"k",
"2to",
"avoid",
"clutter",
"in",
"0",
"based",
"indexing",
"we",
"use",
"the",
"array",
"no",
"tation",
"0",
"denote",
"the",
"range",
"0",
"1",
"inclusive",
"exact",
"search",
"the",
"exact",
"solution",
"computes",
"the",
"full",
"pair",
"wise",
"distance",
"matrix",
"d",
"xj",
"yi",
"2",
"2",
"j",
"0",
"nq",
"i",
"0",
"rnq",
"in",
"practice",
"we",
"use",
"the",
"decomposition",
"xj",
"yi",
"2",
"2",
"xj",
"2",
"yi",
"2",
"2",
"xj",
"yi",
"2",
"the",
"two",
"terms",
"can",
"be",
"precomputed",
"in",
"one",
"pass",
"over",
"the",
"matrices",
"xandywhose",
"rows",
"are",
"the",
"xj",
"and",
"yi",
"the",
"bottleneck",
"is",
"to",
"evaluate",
"xj",
"yi",
"equivalent",
"to",
"the",
"matrix",
"multiplication",
"xy",
"thek",
"nearest",
"neighbors",
"for",
"each",
"of",
"thenqqueries",
"are",
"k",
"selected",
"along",
"each",
"row",
"of",
"d",
"compressed",
"domain",
"search",
"from",
"now",
"on",
"we",
"focus",
"on",
"approximate",
"nearest",
"neighbor",
"search",
"we",
"consider",
"in",
"par",
"ticular",
"the",
"ivfadc",
"indexing",
"structure",
"25",
"the",
"ivfadc",
"index",
"relies",
"on",
"two",
"levels",
"of",
"quantization",
"and",
"the",
"database",
"vectors",
"are",
"encoded"
],
[
"compressed",
"domain",
"search",
"from",
"now",
"on",
"we",
"focus",
"on",
"approximate",
"nearest",
"neighbor",
"search",
"we",
"consider",
"in",
"par",
"ticular",
"the",
"ivfadc",
"indexing",
"structure",
"25",
"the",
"ivfadc",
"index",
"relies",
"on",
"two",
"levels",
"of",
"quantization",
"and",
"the",
"database",
"vectors",
"are",
"encoded",
"the",
"database",
"vector",
"yis",
"approximated",
"as",
"y",
"q",
"y",
"q1",
"y",
"q2",
"y",
"q1",
"y",
"3",
"whereq1",
"rd",
"c",
"1",
"rdandq2",
"rd",
"c",
"2",
"rdare",
"quan",
"tizers",
"i",
"e",
"functions",
"that",
"output",
"an",
"element",
"from",
"a",
"set",
"since",
"the",
"sets",
"are",
"q",
"y",
"is",
"encoded",
"as",
"the",
"index",
"of",
"q1",
"y",
"and",
"that",
"of",
"q2",
"y",
"q1",
"y",
"the",
"level",
"quantizer",
"is",
"a",
"coarse",
"quantizer",
"and",
"the",
"second",
"level",
"quantizer",
"encodes",
"the",
"residual",
"vector",
"after",
"the",
"level",
"the",
"asymmetric",
"distance",
"computation",
"adc",
"search",
"method",
"returns",
"an",
"approximate",
"result",
"ladc",
"k",
"argmini",
"0",
"x",
"q",
"yi",
"2",
"4",
"for",
"ivfadc",
"the",
"search",
"is",
"not",
"exhaustive",
"vectors",
"for",
"which",
"the",
"distance",
"is",
"computed",
"are",
"pre",
"selected",
"depending",
"on",
"the",
"level",
"quantizer",
"q1",
"livf",
"argminc",
"c1",
"x",
"c",
"2",
"5",
"the",
"multi",
"probe",
"parameter",
"the",
"number",
"of",
"coarse",
"level",
"centroids",
"we",
"consider",
"the",
"quantizer",
"operates",
"a",
"nearest",
"neighbor",
"search",
"with",
"exact",
"distances",
"in",
"the",
"set",
"of",
"reproduc",
"tion",
"values",
"then",
"the",
"ivfadc",
"search",
"computes",
"livfadc",
"k",
"argmin",
"i",
"0",
"t",
"q1",
"yi",
"livf",
"x",
"q",
"yi",
"2",
"6",
"hence",
"ivfadc",
"relies",
"on",
"the",
"same",
"distance",
"estimations",
"as",
"the",
"two",
"step",
"quantization",
"of",
"adc",
"but",
"computes",
"them",
"only",
"on",
"a",
"subset",
"of",
"vectors",
"the",
"corresponding",
"data",
"structure",
"the",
"inverted",
"groups",
"the",
"vectors",
"yiinto",
"c1",
"inverted",
"listsi1",
"i",
"c1",
"with",
"homo",
"geneousq1",
"yi",
"therefore",
"the",
"most",
"memory",
"intensive",
"op",
"eration",
"is",
"computing",
"livfadc",
"and",
"boils",
"down",
"to",
"linearly",
"lists",
"the",
"quantizers",
"the",
"quantizers",
"q1andq2have",
"properties",
"q1needs",
"to",
"have",
"a",
"relatively",
"low",
"number",
"of",
"repro",
"duction",
"values",
"so",
"that",
"the",
"number",
"of",
"inverted",
"lists",
"does",
"not",
"explode",
"we",
"typically",
"use",
"c1",
"trained",
"via",
"k",
"means",
"forq2",
"we",
"can",
"to",
"spend",
"more",
"memory",
"for",
"a",
"more",
"ex",
"tensive",
"representation",
"the",
"id",
"of",
"the",
"vector",
"a",
"4",
"or",
"8",
"byte",
"integer",
"is",
"also",
"stored",
"in",
"the",
"inverted",
"lists",
"so",
"it",
"makes",
"no",
"sense",
"to",
"have",
"shorter",
"codes",
"than",
"that",
"i",
"e",
"log2",
"c2",
"4",
"8",
"product",
"quantizer"
],
[
"forq2",
"we",
"can",
"to",
"spend",
"more",
"memory",
"for",
"a",
"more",
"ex",
"tensive",
"representation",
"the",
"id",
"of",
"the",
"vector",
"a",
"4",
"or",
"8",
"byte",
"integer",
"is",
"also",
"stored",
"in",
"the",
"inverted",
"lists",
"so",
"it",
"makes",
"no",
"sense",
"to",
"have",
"shorter",
"codes",
"than",
"that",
"i",
"e",
"log2",
"c2",
"4",
"8",
"product",
"quantizer",
"we",
"use",
"a",
"product",
"quantizer",
"25",
"forq2",
"which",
"provides",
"a",
"large",
"number",
"of",
"reproduction",
"values",
"with",
"out",
"increasing",
"the",
"processing",
"cost",
"it",
"interprets",
"the",
"vector",
"y",
"asbsub",
"vectors",
"y",
"y0",
"yb",
"1",
"wherebis",
"an",
"even",
"divisor",
"of",
"2"
],
[
"the",
"dimension",
"d",
"each",
"sub",
"vector",
"is",
"quantized",
"with",
"its",
"own",
"quantizer",
"yielding",
"the",
"tuple",
"q0",
"y0",
"qb",
"1",
"yb",
"1",
"the",
"sub",
"quantizers",
"typically",
"have",
"256",
"reproduction",
"values",
"to",
"in",
"one",
"byte",
"the",
"quantization",
"value",
"of",
"the",
"product",
"quantizer",
"is",
"thenq2",
"y",
"q0",
"y0",
"256",
"q1",
"y1",
"256b",
"1",
"qb",
"1",
"which",
"from",
"a",
"storage",
"point",
"of",
"view",
"is",
"just",
"the",
"concatena",
"tion",
"of",
"the",
"bytes",
"produced",
"by",
"each",
"sub",
"quantizer",
"thus",
"the",
"product",
"quantizer",
"generates",
"b",
"byte",
"codes",
"with",
"c2",
"256b",
"reproduction",
"values",
"the",
"k",
"means",
"dictionaries",
"of",
"the",
"quan",
"tizers",
"are",
"small",
"and",
"quantization",
"is",
"computationally",
"cheap"
],
[
"this",
"section",
"reviews",
"salient",
"details",
"of",
"nvidia",
"s",
"general",
"purpose",
"gpu",
"architecture",
"and",
"programming",
"model",
"30",
"we",
"then",
"focus",
"on",
"one",
"of",
"the",
"less",
"gpu",
"compliant",
"parts",
"involved",
"in",
"similarity",
"search",
"namely",
"the",
"k",
"selection",
"and",
"discuss",
"the",
"literature",
"and",
"challenges",
"3",
"1",
"architecture",
"gpu",
"lanes",
"and",
"warps",
"the",
"nvidia",
"gpu",
"is",
"a",
"general",
"purpose",
"computer",
"that",
"executes",
"instruction",
"streams",
"using",
"a",
"32",
"wide",
"vector",
"of",
"cuda",
"threads",
"the",
"warp",
"individual",
"threads",
"in",
"the",
"warp",
"are",
"referred",
"to",
"as",
"lanes",
"with",
"a",
"lane",
"idfrom",
"0",
"31",
"despite",
"the",
"thread",
"terminology",
"the",
"best",
"analogy",
"to",
"modern",
"vectorized",
"multicore",
"cpus",
"is",
"that",
"each",
"warp",
"is",
"a",
"separate",
"cpu",
"hardware",
"thread",
"as",
"the",
"warp",
"shares",
"an",
"instruction",
"counter",
"warp",
"lanes",
"taking",
"execu",
"tion",
"paths",
"results",
"in",
"warp",
"divergence",
"reducing",
"performance",
"each",
"lane",
"has",
"up",
"to",
"255",
"32",
"bit",
"registers",
"in",
"a",
"shared",
"register",
"the",
"cpu",
"analogy",
"is",
"that",
"there",
"are",
"up",
"to",
"255",
"vector",
"registers",
"of",
"width",
"32",
"with",
"warp",
"lanes",
"as",
"simd",
"vector",
"lanes",
"collections",
"of",
"warps",
"a",
"user",
"collection",
"of",
"1",
"to",
"32",
"warps",
"comprises",
"a",
"block",
"or",
"a",
"co",
"operative",
"thread",
"ar",
"ray",
"cta",
"each",
"block",
"has",
"a",
"high",
"speed",
"shared",
"memory",
"up",
"to",
"48",
"kib",
"in",
"size",
"individual",
"cuda",
"threads",
"have",
"a",
"block",
"relative",
"id",
"called",
"a",
"thread",
"id",
"which",
"can",
"be",
"used",
"to",
"parti",
"tion",
"and",
"assign",
"work",
"each",
"block",
"is",
"run",
"on",
"a",
"single",
"core",
"of",
"the",
"gpu",
"called",
"a",
"streaming",
"multiprocessor",
"sm",
"each",
"sm",
"has",
"functional",
"units",
"including",
"alus",
"memory",
"load",
"store",
"units",
"and",
"various",
"special",
"instruction",
"units",
"a",
"gpu",
"hides",
"execution",
"latencies",
"by",
"having",
"many",
"operations",
"in",
"on",
"warps",
"across",
"all",
"sms",
"each",
"individual",
"warp",
"lane",
"instruction",
"throughput",
"is",
"low",
"and",
"latency",
"is",
"high",
"but",
"the",
"aggregate",
"arithmetic",
"throughput",
"of",
"all",
"sms",
"together",
"is",
"5",
"10",
"higher",
"than",
"typical",
"cpus",
"grids",
"and",
"kernels",
"blocks",
"are",
"organized",
"in",
"a",
"gridof",
"blocks",
"in",
"a",
"kernel",
"each",
"block",
"is",
"assigned",
"a",
"grid",
"relative",
"id",
"the",
"kernel",
"is",
"the",
"unit",
"of",
"work",
"instruction",
"stream",
"with",
"argu",
"ments",
"scheduled",
"by",
"the",
"host",
"cpu",
"for",
"the",
"gpu",
"to",
"execute",
"after",
"a",
"block",
"runs",
"through",
"to",
"completion",
"new",
"blocks",
"can",
"be",
"scheduled"
],
[
"each",
"block",
"is",
"assigned",
"a",
"grid",
"relative",
"id",
"the",
"kernel",
"is",
"the",
"unit",
"of",
"work",
"instruction",
"stream",
"with",
"argu",
"ments",
"scheduled",
"by",
"the",
"host",
"cpu",
"for",
"the",
"gpu",
"to",
"execute",
"after",
"a",
"block",
"runs",
"through",
"to",
"completion",
"new",
"blocks",
"can",
"be",
"scheduled",
"blocks",
"from",
"kernels",
"can",
"run",
"concur",
"rently",
"ordering",
"between",
"kernels",
"is",
"controllable",
"via",
"ordering",
"primitives",
"such",
"as",
"streams",
"and",
"events",
"resources",
"and",
"occupancy",
"the",
"number",
"of",
"blocks",
"execut",
"ing",
"concurrently",
"depends",
"upon",
"shared",
"memory",
"and",
"register",
"resources",
"used",
"by",
"each",
"block",
"per",
"cuda",
"thread",
"register",
"us",
"age",
"is",
"determined",
"at",
"compilation",
"time",
"while",
"shared",
"memory",
"usage",
"can",
"be",
"chosen",
"at",
"runtime",
"this",
"usage",
"occu",
"pancy",
"on",
"the",
"gpu",
"if",
"a",
"block",
"demands",
"all",
"48",
"kib",
"of",
"shared",
"memory",
"for",
"its",
"private",
"usage",
"or",
"128",
"registers",
"per",
"thread",
"asopposed",
"to",
"32",
"then",
"only",
"1",
"2",
"other",
"blocks",
"can",
"run",
"concur",
"rently",
"on",
"the",
"same",
"sm",
"resulting",
"in",
"low",
"occupancy",
"under",
"high",
"occupancy",
"more",
"blocks",
"will",
"be",
"present",
"across",
"all",
"sms",
"allowing",
"more",
"work",
"to",
"be",
"in",
"at",
"once",
"memory",
"types",
"blocks",
"and",
"kernels",
"communicate",
"through",
"global",
"memory",
"typically",
"4",
"32",
"gb",
"in",
"size",
"with",
"5",
"10",
"higher",
"bandwidth",
"than",
"cpu",
"main",
"memory",
"shared",
"memory",
"is",
"analogous",
"to",
"cpu",
"l1",
"cache",
"in",
"terms",
"of",
"speed",
"gpu",
"register",
"memory",
"is",
"the",
"highest",
"bandwidth",
"memory",
"in",
"order",
"to",
"maintain",
"the",
"high",
"number",
"of",
"instructions",
"in",
"on",
"a",
"gpu",
"a",
"vast",
"register",
"is",
"also",
"required",
"14",
"mb",
"in",
"the",
"latest",
"pascal",
"p100",
"in",
"contrast",
"with",
"a",
"few",
"tens",
"of",
"kb",
"on",
"cpu",
"a",
"ratio",
"of",
"250",
"6",
"25",
"1",
"for",
"register",
"to",
"shared",
"to",
"global",
"memory",
"aggregate",
"cross",
"sectional",
"bandwidth",
"is",
"typical",
"on",
"gpu",
"yielding",
"10",
"100s",
"of",
"tb",
"s",
"for",
"the",
"register",
"10",
"3",
"2",
"gpu",
"register",
"usage",
"structured",
"register",
"data",
"shared",
"and",
"register",
"memory",
"usage",
"involves",
"they",
"lower",
"occupancy",
"but",
"can",
"increase",
"overall",
"performance",
"by",
"retaining",
"a",
"larger",
"work",
"ing",
"set",
"in",
"a",
"faster",
"memory",
"making",
"heavy",
"use",
"of",
"register",
"resident",
"data",
"at",
"the",
"expense",
"of",
"occupancy",
"or",
"instead",
"of",
"shared",
"memory",
"is",
"often",
"43",
"as",
"the",
"gpu",
"register",
"is",
"very",
"large",
"storing",
"structured",
"data",
"not",
"just",
"temporary",
"operands",
"is",
"useful"
],
[
"making",
"heavy",
"use",
"of",
"register",
"resident",
"data",
"at",
"the",
"expense",
"of",
"occupancy",
"or",
"instead",
"of",
"shared",
"memory",
"is",
"often",
"43",
"as",
"the",
"gpu",
"register",
"is",
"very",
"large",
"storing",
"structured",
"data",
"not",
"just",
"temporary",
"operands",
"is",
"useful",
"a",
"single",
"lane",
"can",
"use",
"its",
"scalar",
"registers",
"to",
"solve",
"a",
"local",
"task",
"but",
"with",
"limited",
"parallelism",
"and",
"storage",
"instead",
"lanes",
"in",
"a",
"gpu",
"warp",
"can",
"instead",
"exchange",
"register",
"data",
"using",
"the",
"warp",
"shuf",
"enabling",
"warp",
"wide",
"parallelism",
"and",
"storage",
"lane",
"stride",
"register",
"array",
"a",
"common",
"pattern",
"to",
"achieve",
"this",
"is",
"a",
"lane",
"stride",
"register",
"array",
"that",
"is",
"given",
"elements",
"ai",
"i",
"0",
"each",
"successive",
"value",
"is",
"held",
"in",
"a",
"register",
"by",
"neigh",
"boring",
"lanes",
"the",
"array",
"is",
"stored",
"in",
"32",
"registers",
"per",
"lane",
"multiple",
"of",
"32",
"lane",
"jstores",
"aj",
"a32",
"j",
"a",
"32",
"j",
"while",
"register",
"rholds",
"a32r",
"a32r",
"1",
"a",
"32r",
"31",
"for",
"manipulating",
"the",
"ai",
"the",
"register",
"in",
"which",
"aiis",
"stored",
"i",
"e",
"i",
"32",
"be",
"known",
"at",
"assembly",
"time",
"while",
"the",
"lane",
"i",
"e",
"imod",
"32",
"can",
"be",
"runtime",
"knowledge",
"a",
"wide",
"variety",
"of",
"access",
"patterns",
"shift",
"any",
"to",
"any",
"are",
"provided",
"we",
"use",
"the",
"permutation",
"29",
"extensively",
"3",
"3",
"k",
"selection",
"on",
"cpu",
"versus",
"gpu",
"k",
"selection",
"algorithms",
"often",
"for",
"arbitrarily",
"large",
"k",
"can",
"be",
"translated",
"to",
"a",
"gpu",
"including",
"radix",
"selection",
"and",
"bucket",
"selection",
"1",
"probabilistic",
"selection",
"33",
"quick",
"select",
"14",
"and",
"truncated",
"sorts",
"40",
"their",
"performance",
"is",
"dominated",
"by",
"multiple",
"passes",
"over",
"the",
"input",
"in",
"global",
"mem",
"ory",
"sometimes",
"for",
"similarity",
"search",
"the",
"input",
"distances",
"are",
"computed",
"on",
"the",
"or",
"stored",
"only",
"in",
"small",
"blocks",
"not",
"in",
"their",
"entirety",
"the",
"full",
"explicit",
"array",
"might",
"be",
"too",
"large",
"to",
"into",
"any",
"memory",
"and",
"its",
"size",
"could",
"be",
"unknown",
"at",
"the",
"start",
"of",
"the",
"processing",
"rendering",
"algorithms",
"that",
"require",
"multiple",
"passes",
"impractical",
"they",
"from",
"other",
"issues",
"as",
"well",
"quickselect",
"requires",
"partitioning",
"on",
"a",
"storage",
"of",
"sizeo",
"a",
"data",
"dependent",
"memory",
"movement",
"this",
"can",
"result",
"in",
"excessive",
"memory",
"transactions",
"or",
"requiring",
"parallel",
"sums",
"to",
"determine",
"write",
"with",
"synchronization",
"overhead"
],
[
"quickselect",
"requires",
"partitioning",
"on",
"a",
"storage",
"of",
"sizeo",
"a",
"data",
"dependent",
"memory",
"movement",
"this",
"can",
"result",
"in",
"excessive",
"memory",
"transactions",
"or",
"requiring",
"parallel",
"sums",
"to",
"determine",
"write",
"with",
"synchronization",
"overhead",
"radix",
"selection",
"has",
"no",
"partitioning",
"but",
"multiple",
"passes",
"are",
"still",
"required",
"heap",
"parallelism",
"in",
"similarity",
"search",
"applications",
"one",
"is",
"usually",
"interested",
"only",
"in",
"a",
"small",
"number",
"of",
"results",
"k",
"3"
],
[
"1000",
"or",
"so",
"in",
"this",
"regime",
"selection",
"via",
"max",
"heap",
"is",
"a",
"typi",
"cal",
"choice",
"on",
"the",
"cpu",
"but",
"heaps",
"do",
"not",
"expose",
"much",
"data",
"parallelism",
"due",
"to",
"serial",
"tree",
"update",
"and",
"cannot",
"saturate",
"simd",
"execution",
"units",
"the",
"ad",
"heap",
"31",
"takes",
"better",
"advan",
"tage",
"of",
"parallelism",
"available",
"in",
"heterogeneous",
"systems",
"but",
"still",
"attempts",
"to",
"partition",
"serial",
"and",
"parallel",
"work",
"between",
"appropriate",
"execution",
"units",
"despite",
"the",
"serial",
"nature",
"of",
"heap",
"update",
"for",
"small",
"kthe",
"cpu",
"can",
"maintain",
"all",
"of",
"its",
"state",
"in",
"the",
"l1",
"cache",
"with",
"little",
"and",
"l1",
"cache",
"latency",
"and",
"bandwidth",
"remains",
"a",
"limiting",
"factor",
"other",
"similarity",
"search",
"components",
"like",
"pq",
"code",
"manipulation",
"tend",
"to",
"have",
"greater",
"impact",
"on",
"cpu",
"performance",
"2",
"gpu",
"heaps",
"heaps",
"can",
"be",
"similarly",
"implemented",
"on",
"a",
"gpu",
"7",
"however",
"a",
"straightforward",
"gpu",
"heap",
"implemen",
"tation",
"from",
"high",
"warp",
"divergence",
"and",
"irregular",
"data",
"dependent",
"memory",
"movement",
"since",
"the",
"path",
"taken",
"for",
"each",
"inserted",
"element",
"depends",
"upon",
"other",
"values",
"in",
"the",
"heap",
"gpu",
"parallel",
"priority",
"queues",
"24",
"improve",
"over",
"the",
"serial",
"heap",
"update",
"by",
"allowing",
"multiple",
"concurrent",
"updates",
"but",
"they",
"require",
"a",
"potential",
"number",
"of",
"small",
"sorts",
"for",
"each",
"insert",
"and",
"data",
"dependent",
"memory",
"movement",
"moreover",
"it",
"uses",
"multiple",
"synchronization",
"barriers",
"through",
"kernel",
"launches",
"in",
"streams",
"plus",
"the",
"additional",
"latency",
"of",
"successive",
"kernel",
"launches",
"and",
"coordination",
"with",
"the",
"cpu",
"host",
"other",
"more",
"novel",
"gpu",
"algorithms",
"are",
"available",
"for",
"small",
"k",
"namely",
"the",
"selection",
"algorithm",
"in",
"the",
"fgknn",
"library",
"41",
"this",
"is",
"a",
"complex",
"algorithm",
"that",
"may",
"from",
"too",
"many",
"synchronization",
"points",
"greater",
"kernel",
"launch",
"overhead",
"us",
"age",
"of",
"slower",
"memories",
"excessive",
"use",
"of",
"hierarchy",
"partition",
"ing",
"and",
"however",
"we",
"take",
"inspiration",
"from",
"this",
"particular",
"algorithm",
"through",
"the",
"use",
"of",
"parallel",
"merges",
"as",
"seen",
"in",
"their",
"merge",
"queue",
"structure"
],
[
"for",
"any",
"cpu",
"or",
"gpu",
"algorithm",
"either",
"memory",
"or",
"arith",
"metic",
"throughput",
"should",
"be",
"the",
"limiting",
"factor",
"as",
"per",
"the",
"performance",
"model",
"48",
"for",
"input",
"from",
"global",
"mem",
"ory",
"k",
"selection",
"cannot",
"run",
"faster",
"than",
"the",
"time",
"required",
"to",
"scan",
"the",
"input",
"once",
"at",
"peak",
"memory",
"bandwidth",
"we",
"aim",
"to",
"get",
"as",
"close",
"to",
"this",
"limit",
"as",
"possible",
"thus",
"we",
"wish",
"to",
"per",
"form",
"a",
"single",
"pass",
"over",
"the",
"input",
"data",
"from",
"global",
"memory",
"or",
"produced",
"on",
"the",
"perhaps",
"fused",
"with",
"a",
"kernel",
"that",
"is",
"generating",
"the",
"data",
"we",
"want",
"to",
"keep",
"intermediate",
"state",
"in",
"the",
"fastest",
"memory",
"the",
"register",
"the",
"major",
"disadvantage",
"of",
"register",
"memory",
"is",
"that",
"the",
"indexing",
"into",
"the",
"register",
"must",
"be",
"known",
"at",
"assembly",
"time",
"which",
"is",
"a",
"strong",
"constraint",
"on",
"the",
"algorithm",
"4",
"1",
"in",
"register",
"sorting",
"we",
"use",
"an",
"in",
"register",
"sorting",
"primitive",
"as",
"a",
"building",
"block",
"sorting",
"networks",
"are",
"commonly",
"used",
"on",
"simd",
"architec",
"tures",
"13",
"as",
"they",
"exploit",
"vector",
"parallelism",
"they",
"are",
"eas",
"ily",
"implemented",
"on",
"the",
"gpu",
"and",
"we",
"build",
"sorting",
"networks",
"with",
"lane",
"stride",
"register",
"arrays",
"we",
"use",
"a",
"variant",
"of",
"batcher",
"s",
"bitonic",
"sorting",
"network",
"8",
"which",
"is",
"a",
"set",
"of",
"parallel",
"merges",
"on",
"an",
"array",
"of",
"size",
"2k",
"each",
"merge",
"takes",
"sarrays",
"of",
"length",
"t",
"sandta",
"power",
"of",
"2",
"to",
"s",
"2",
"arrays",
"of",
"length",
"2",
"t",
"using",
"log2",
"t",
"parallel",
"steps"
],
[
"we",
"use",
"a",
"variant",
"of",
"batcher",
"s",
"bitonic",
"sorting",
"network",
"8",
"which",
"is",
"a",
"set",
"of",
"parallel",
"merges",
"on",
"an",
"array",
"of",
"size",
"2k",
"each",
"merge",
"takes",
"sarrays",
"of",
"length",
"t",
"sandta",
"power",
"of",
"2",
"to",
"s",
"2",
"arrays",
"of",
"length",
"2",
"t",
"using",
"log2",
"t",
"parallel",
"steps",
"a",
"bitonic",
"sort",
"applies",
"this",
"merge",
"recursively",
"to",
"sort",
"an",
"array",
"of",
"length",
"of",
"length",
"1",
"to",
"2",
"arrays",
"of",
"length",
"2",
"to",
"4",
"arrays",
"of",
"length",
"4",
"successively",
"to",
"1",
"sorted",
"array",
"of",
"length",
"leading",
"to1",
"2",
"log2",
"2",
"log2",
"parallel",
"merge",
"steps",
"algorithm",
"1",
"odd",
"size",
"merging",
"network",
"function",
"merge",
"odd",
"li",
"i",
"0",
"ri",
"i",
"0",
"parallel",
"for",
"i",
"0",
"min",
"do",
"inverted",
"1st",
"stage",
"inputs",
"are",
"already",
"sorted",
"compare",
"swap",
"i",
"1",
"ri",
"end",
"for",
"parallel",
"do",
"a",
"power",
"of",
"2",
"these",
"are",
"equivalent",
"merge",
"odd",
"continue",
"li",
"i",
"0",
"left",
"merge",
"odd",
"continue",
"ri",
"i",
"0",
"right",
"end",
"do",
"end",
"function",
"function",
"merge",
"odd",
"continue",
"xi",
"i",
"0",
"p",
"1then",
"h",
"2",
"1",
"largest",
"power",
"of",
"2",
"parallel",
"for",
"i",
"0",
"hdo",
"implemented",
"with",
"warp",
"compare",
"swap",
"xi",
"xi",
"h",
"end",
"for",
"parallel",
"do",
"ifp",
"leftthen",
"left",
"side",
"recursion",
"merge",
"odd",
"continue",
"xi",
"i",
"0",
"h",
"left",
"merge",
"odd",
"continue",
"xi",
"i",
"h",
"right",
"else",
"right",
"side",
"recursion",
"merge",
"odd",
"continue",
"xi",
"i",
"0",
"h",
"left",
"merge",
"odd",
"continue",
"xi",
"i",
"h",
"right",
"end",
"if",
"end",
"do",
"end",
"if",
"end",
"function",
"odd",
"size",
"merging",
"and",
"sorting",
"networks",
"if",
"some",
"input",
"data",
"is",
"already",
"sorted",
"we",
"can",
"modify",
"the",
"network",
"to",
"avoid",
"merging",
"steps",
"we",
"may",
"also",
"not",
"have",
"a",
"full",
"power",
"of",
"2",
"set",
"of",
"data",
"in",
"which",
"case",
"we",
"can",
"shortcut",
"to",
"deal",
"with",
"the",
"smaller",
"size",
"algorithm",
"1",
"is",
"an",
"odd",
"sized",
"merging",
"network",
"that",
"merges",
"already",
"sorted",
"leftandright",
"arrays",
"each",
"of",
"arbitrary",
"length",
"while",
"the",
"bitonic",
"network",
"merges",
"bitonic",
"sequences",
"we",
"start",
"with",
"monotonic",
"sequences",
"sequences",
"sorted",
"monotonically",
"a",
"bitonic",
"merge",
"is",
"made",
"monotonic",
"by",
"reversing",
"the",
"comparator",
"stage"
],
[
"while",
"the",
"bitonic",
"network",
"merges",
"bitonic",
"sequences",
"we",
"start",
"with",
"monotonic",
"sequences",
"sequences",
"sorted",
"monotonically",
"a",
"bitonic",
"merge",
"is",
"made",
"monotonic",
"by",
"reversing",
"the",
"comparator",
"stage",
"the",
"odd",
"size",
"algorithm",
"is",
"derived",
"by",
"considering",
"arrays",
"to",
"be",
"padded",
"to",
"the",
"next",
"highest",
"power",
"of",
"2",
"size",
"with",
"dummy",
"1",
"3",
"4",
"8",
"9",
"0",
"3",
"7",
"1",
"3",
"4",
"3",
"0",
"9",
"8",
"7",
"0",
"3",
"4",
"3",
"1",
"7",
"8",
"9",
"0",
"3",
"1",
"3",
"4",
"7",
"8",
"9",
"0",
"1",
"3",
"3",
"4",
"7",
"8",
"9step",
"1",
"step",
"2",
"step",
"3",
"step",
"4",
"figure",
"1",
"odd",
"size",
"network",
"merging",
"arrays",
"of",
"sizes",
"5",
"and",
"3",
"bullets",
"indicate",
"parallel",
"compare",
"swap",
"dashed",
"lines",
"are",
"elided",
"elements",
"or",
"comparisons",
"4"
],
[
"input",
"insertionthread",
"queuemerging",
"networkwarp",
"queue",
"lane",
"0",
"lane",
"1",
"lane",
"31coalesced",
"read",
"figure",
"2",
"overview",
"of",
"warpselect",
"the",
"input",
"val",
"ues",
"stream",
"in",
"on",
"the",
"left",
"and",
"the",
"warp",
"queue",
"on",
"the",
"right",
"holds",
"the",
"output",
"result",
"elements",
"that",
"are",
"never",
"swapped",
"the",
"merge",
"is",
"monotonic",
"and",
"are",
"already",
"properly",
"positioned",
"any",
"comparisons",
"with",
"dummy",
"elements",
"are",
"elided",
"a",
"left",
"array",
"is",
"considered",
"to",
"be",
"padded",
"with",
"dummy",
"elements",
"at",
"the",
"start",
"a",
"right",
"ar",
"ray",
"has",
"them",
"at",
"the",
"end",
"a",
"merge",
"of",
"two",
"sorted",
"arrays",
"of",
"a",
"sorted",
"array",
"of",
"log2",
"max",
"1",
"parallel",
"steps",
"figure",
"1",
"shows",
"algo",
"rithm",
"1",
"s",
"merging",
"network",
"for",
"arrays",
"of",
"size",
"5",
"and",
"3",
"with",
"4",
"parallel",
"steps",
"thecompare",
"swap",
"is",
"implemented",
"using",
"warp",
"on",
"a",
"lane",
"stride",
"register",
"array",
"swaps",
"with",
"a",
"stride",
"a",
"multiple",
"of",
"32",
"occur",
"directly",
"within",
"a",
"lane",
"as",
"the",
"lane",
"holds",
"both",
"elements",
"locally",
"swaps",
"of",
"stride",
"16",
"or",
"a",
"non",
"multiple",
"of",
"32",
"occur",
"with",
"warp",
"in",
"practice",
"used",
"array",
"lengths",
"are",
"multiples",
"of",
"32",
"as",
"they",
"are",
"held",
"in",
"lane",
"stride",
"arrays",
"algorithm",
"2",
"odd",
"size",
"sorting",
"network",
"function",
"sort",
"odd",
"xi",
"i",
"0",
"1then",
"parallel",
"do",
"sort",
"odd",
"xi",
"i",
"0",
"2",
"sort",
"odd",
"xi",
"i",
"2",
"end",
"do",
"merge",
"odd",
"xi",
"i",
"0",
"2",
"xi",
"i",
"2",
"end",
"if",
"end",
"function",
"algorithm",
"2",
"extends",
"the",
"merge",
"to",
"a",
"full",
"sort",
"assuming",
"no",
"structure",
"present",
"in",
"the",
"input",
"data",
"1",
"2",
"log2",
"2",
"log2",
"parallel",
"steps",
"are",
"required",
"for",
"sorting",
"data",
"of",
"length",
"4",
"2",
"warpselect",
"ourk",
"selection",
"implementation",
"warpselect",
"maintains",
"state",
"entirely",
"in",
"registers",
"requires",
"only",
"a",
"single",
"pass",
"over",
"data",
"and",
"avoids",
"cross",
"warp",
"synchronization",
"it",
"uses",
"merge",
"odd",
"andsort",
"odd",
"as",
"primitives",
"since",
"the",
"register",
"pro",
"vides",
"much",
"more",
"storage",
"than",
"shared",
"memory",
"it",
"supports",
"k",
"1024"
],
[
"it",
"uses",
"merge",
"odd",
"andsort",
"odd",
"as",
"primitives",
"since",
"the",
"register",
"pro",
"vides",
"much",
"more",
"storage",
"than",
"shared",
"memory",
"it",
"supports",
"k",
"1024",
"each",
"warp",
"is",
"dedicated",
"to",
"k",
"selection",
"to",
"a",
"single",
"one",
"of",
"thenarrays",
"ai",
"ifnis",
"large",
"enough",
"a",
"single",
"warp",
"per",
"each",
"ai",
"will",
"result",
"in",
"full",
"gpu",
"occupancy",
"large",
"warp",
"is",
"handled",
"by",
"recursive",
"decomposition",
"if",
"known",
"in",
"advance",
"overview",
"our",
"approach",
"algorithm",
"3",
"and",
"figure",
"2",
"oper",
"ates",
"on",
"values",
"with",
"associated",
"indices",
"carried",
"along",
"omit",
"ted",
"from",
"the",
"description",
"for",
"simplicity",
"it",
"selects",
"the",
"kleast",
"values",
"that",
"come",
"from",
"global",
"memory",
"or",
"from",
"intermediate",
"value",
"registers",
"if",
"fused",
"into",
"another",
"kernel",
"providing",
"the",
"val",
"ues",
"let",
"ai",
"i",
"0",
"the",
"sequence",
"provided",
"for",
"selection",
"the",
"elements",
"on",
"the",
"left",
"of",
"figure",
"2",
"are",
"processed",
"in",
"groups",
"of",
"32",
"the",
"warp",
"size",
"lane",
"jis",
"responsible",
"for",
"pro",
"cessing",
"aj",
"a32",
"j",
"thus",
"if",
"the",
"elements",
"come",
"from",
"global",
"memory",
"the",
"reads",
"are",
"contiguous",
"and",
"coalesced",
"into",
"a",
"min",
"imal",
"number",
"of",
"memory",
"transactions",
"data",
"structures",
"each",
"lanejmaintains",
"a",
"small",
"queue",
"oftelements",
"in",
"registers",
"called",
"the",
"thread",
"queues",
"tj",
"i",
"i",
"0",
"t",
"ordered",
"from",
"largest",
"to",
"smallest",
"tj",
"i",
"tj",
"i",
"1",
"the",
"choice",
"of",
"tis",
"made",
"relative",
"to",
"k",
"see",
"section",
"4",
"3",
"the",
"thread",
"queue",
"is",
"a",
"level",
"for",
"new",
"values",
"coming",
"in",
"if",
"a",
"new",
"a32i",
"j",
"is",
"greater",
"than",
"the",
"largest",
"key",
"currently",
"in",
"the",
"queue",
"tj",
"0",
"it",
"is",
"guaranteed",
"that",
"it",
"won",
"t",
"be",
"in",
"the",
"ksmallest",
"results",
"the",
"warp",
"shares",
"a",
"lane",
"stride",
"register",
"array",
"of",
"ksmallest",
"seen",
"elements",
"wi",
"i",
"0",
"k",
"called",
"the",
"warp",
"queue",
"it",
"is",
"ordered",
"from",
"smallest",
"to",
"largest",
"wi",
"wi",
"1",
"if",
"the",
"requested",
"kis",
"not",
"a",
"multiple",
"of",
"32",
"we",
"round",
"it",
"up",
"this",
"is",
"a",
"second",
"level",
"data",
"structure",
"that",
"will",
"be",
"used",
"to",
"maintain",
"all",
"of",
"the",
"k",
"smallest",
"warp",
"wide",
"seen",
"values",
"the",
"thread",
"and",
"warp",
"queues",
"are",
"initialized",
"to",
"maximum",
"sentinel",
"values",
"e",
"g",
"update"
],
[
"this",
"is",
"a",
"second",
"level",
"data",
"structure",
"that",
"will",
"be",
"used",
"to",
"maintain",
"all",
"of",
"the",
"k",
"smallest",
"warp",
"wide",
"seen",
"values",
"the",
"thread",
"and",
"warp",
"queues",
"are",
"initialized",
"to",
"maximum",
"sentinel",
"values",
"e",
"g",
"update",
"the",
"three",
"invariants",
"maintained",
"are",
"all",
"per",
"lane",
"tj",
"0are",
"not",
"in",
"the",
"min",
"k",
"all",
"per",
"lane",
"tj",
"0are",
"greater",
"than",
"all",
"warp",
"queue",
"keys",
"wi",
"allaiseen",
"so",
"far",
"in",
"the",
"min",
"kare",
"contained",
"in",
"either",
"some",
"lane",
"s",
"thread",
"queue",
"tj",
"i",
"i",
"0",
"t",
"j",
"0",
"32",
"or",
"in",
"the",
"warp",
"queue",
"lanejreceives",
"a",
"new",
"a32i",
"jand",
"attempts",
"to",
"insert",
"it",
"into",
"its",
"thread",
"queue",
"if",
"a32i",
"j",
"tj",
"0",
"then",
"the",
"new",
"pair",
"is",
"by",
"not",
"in",
"the",
"kminimum",
"and",
"can",
"be",
"rejected",
"otherwise",
"it",
"is",
"inserted",
"into",
"its",
"proper",
"sorted",
"position",
"in",
"the",
"thread",
"queue",
"thus",
"ejecting",
"the",
"old",
"tj"
],
[
"complete",
"doing",
"this",
"with",
"their",
"new",
"received",
"pair",
"and",
"their",
"thread",
"queue",
"but",
"it",
"is",
"now",
"possible",
"that",
"the",
"second",
"invariant",
"have",
"been",
"violated",
"using",
"the",
"warp",
"ballot",
"instruction",
"we",
"determine",
"if",
"any",
"lane",
"has",
"violated",
"the",
"second",
"invariant",
"if",
"not",
"we",
"are",
"free",
"to",
"continue",
"processing",
"new",
"elements",
"restoring",
"the",
"invariants",
"if",
"any",
"lane",
"has",
"its",
"invariant",
"violated",
"then",
"the",
"warp",
"uses",
"odd",
"merge",
"to",
"merge",
"and",
"sort",
"the",
"thread",
"and",
"warp",
"queues",
"together",
"the",
"new",
"warp",
"queue",
"algorithm",
"3",
"warpselect",
"pseudocode",
"for",
"lane",
"j",
"function",
"warpselect",
"a",
"ifa",
"tj",
"0then",
"insertainto",
"our",
"tj",
"i",
"i",
"0",
"t",
"end",
"if",
"ifwarp",
"ballot",
"tj",
"0",
"w",
"k",
"1",
"then",
"reinterpret",
"thread",
"queues",
"as",
"lane",
"stride",
"array",
"i",
"0",
"32",
"t",
"cast",
"tj",
"i",
"i",
"0",
"t",
"j",
"0",
"32",
"concatenate",
"and",
"sort",
"thread",
"queues",
"sort",
"odd",
"i",
"0",
"32",
"t",
"merge",
"odd",
"wi",
"i",
"0",
"k",
"i",
"0",
"32",
"t",
"reinterpret",
"lane",
"stride",
"array",
"as",
"thread",
"queues",
"tj",
"i",
"i",
"0",
"t",
"j",
"0",
"32",
"cast",
"i",
"0",
"32",
"t",
"reverse",
"array",
"ti",
"i",
"0",
"t",
"back",
"in",
"thread",
"queue",
"order",
"invariant",
"restored",
"end",
"if",
"end",
"function",
"5"
],
[
"will",
"be",
"the",
"min",
"kelements",
"across",
"the",
"merged",
"sorted",
"queues",
"and",
"the",
"new",
"thread",
"queues",
"will",
"be",
"the",
"remainder",
"from",
"min",
"k",
"1",
"to",
"min",
"k",
"32t",
"1",
"this",
"restores",
"the",
"invariants",
"and",
"we",
"are",
"free",
"to",
"continue",
"processing",
"subsequent",
"elements",
"since",
"the",
"thread",
"and",
"warp",
"queues",
"are",
"already",
"sorted",
"we",
"merge",
"the",
"sorted",
"warp",
"queue",
"of",
"length",
"kwith",
"32",
"sorted",
"arrays",
"of",
"length",
"t",
"supporting",
"odd",
"sized",
"merges",
"is",
"important",
"because",
"batcher",
"s",
"formulation",
"would",
"require",
"that",
"32",
"t",
"k",
"and",
"is",
"a",
"power",
"of",
"2",
"thus",
"if",
"k",
"1024",
"tmust",
"be",
"32",
"we",
"found",
"that",
"the",
"optimal",
"tis",
"way",
"smaller",
"see",
"below",
"using",
"odd",
"merge",
"to",
"merge",
"the",
"32",
"already",
"sorted",
"thread",
"queues",
"would",
"require",
"a",
"struct",
"of",
"arrays",
"toarray",
"of",
"structs",
"transposition",
"in",
"registers",
"across",
"the",
"warp",
"since",
"the",
"tsucces",
"sive",
"sorted",
"values",
"are",
"held",
"in",
"registers",
"in",
"the",
"same",
"lane",
"rather",
"than",
"a",
"lane",
"stride",
"array",
"this",
"is",
"possible",
"12",
"but",
"would",
"use",
"a",
"comparable",
"number",
"of",
"warp",
"so",
"we",
"just",
"reinterpret",
"the",
"thread",
"queue",
"registers",
"as",
"an",
"unsorted",
"lane",
"stride",
"array",
"and",
"sort",
"from",
"scratch",
"speedup",
"is",
"realizable",
"by",
"using",
"odd",
"merge",
"for",
"the",
"merge",
"of",
"the",
"ag",
"gregate",
"sorted",
"thread",
"queues",
"with",
"the",
"warp",
"queue",
"handling",
"the",
"remainder",
"if",
"there",
"are",
"remainder",
"elements",
"not",
"a",
"multiple",
"of",
"32",
"those",
"are",
"inserted",
"into",
"the",
"thread",
"queues",
"for",
"the",
"lanes",
"that",
"have",
"them",
"after",
"which",
"we",
"proceed",
"to",
"the",
"output",
"stage",
"output",
"a",
"sort",
"and",
"merge",
"is",
"made",
"of",
"the",
"thread",
"and",
"warp",
"queues",
"after",
"which",
"the",
"warp",
"queue",
"holds",
"all",
"min",
"k",
"values",
"4",
"3",
"complexity",
"and",
"parameter",
"selection",
"for",
"each",
"incoming",
"group",
"of",
"32",
"elements",
"warpselect",
"can",
"perform",
"1",
"2",
"or",
"3",
"constant",
"time",
"operations",
"all",
"happen",
"ing",
"in",
"warp",
"wide",
"parallel",
"time",
"1",
"read",
"32",
"elements",
"compare",
"to",
"all",
"thread",
"queue",
"heads",
"tj",
"0",
"costc1",
"happensn1times",
"2",
"if",
"j",
"0",
"31",
"a32n",
"j",
"tj",
"0",
"perform",
"insertion",
"sort",
"on",
"those",
"thread",
"queues",
"cost",
"c2",
"o",
"t",
"hap",
"pensn2times",
"3",
"if",
"j",
"tj",
"0",
"w",
"k",
"1",
"sort",
"and",
"merge",
"queues",
"cost",
"c3",
"o",
"tlog",
"32t",
"2",
"klog",
"max",
"k",
"32t",
"happens",
"n3times"
],
[
"if",
"j",
"0",
"31",
"a32n",
"j",
"tj",
"0",
"perform",
"insertion",
"sort",
"on",
"those",
"thread",
"queues",
"cost",
"c2",
"o",
"t",
"hap",
"pensn2times",
"3",
"if",
"j",
"tj",
"0",
"w",
"k",
"1",
"sort",
"and",
"merge",
"queues",
"cost",
"c3",
"o",
"tlog",
"32t",
"2",
"klog",
"max",
"k",
"32t",
"happens",
"n3times",
"thus",
"the",
"total",
"cost",
"is",
"n1c1",
"n2c2",
"n3c3",
"n1",
"32",
"and",
"on",
"random",
"data",
"drawn",
"independently",
"n2",
"o",
"klog",
"andn3",
"o",
"klog",
"t",
"see",
"the",
"appendix",
"for",
"a",
"full",
"deriva",
"tion",
"hence",
"the",
"trade",
"is",
"to",
"balance",
"a",
"cost",
"in",
"n2c2and",
"one",
"inn3c3",
"the",
"practical",
"choice",
"for",
"made",
"by",
"experiment",
"on",
"a",
"variety",
"of",
"k",
"nn",
"data",
"for",
"k",
"32",
"we",
"uset",
"2",
"k",
"128",
"usest",
"3",
"k",
"256",
"usest",
"4",
"and",
"k",
"1024",
"usest",
"8",
"all",
"irrespective",
"of"
],
[
"this",
"section",
"explains",
"how",
"ivfadc",
"one",
"of",
"the",
"indexing",
"methods",
"originally",
"built",
"upon",
"product",
"quantization",
"25",
"is",
"implemented",
"details",
"on",
"distance",
"computations",
"and",
"articulation",
"with",
"k",
"selection",
"are",
"the",
"key",
"to",
"understand",
"ing",
"why",
"this",
"method",
"can",
"outperform",
"more",
"recent",
"gpu",
"compliant",
"approximate",
"nearest",
"neighbor",
"strategies",
"47",
"5",
"1",
"exact",
"search",
"we",
"come",
"back",
"to",
"the",
"exhaustive",
"search",
"method",
"often",
"referred",
"to",
"as",
"exact",
"brute",
"force",
"it",
"is",
"interesting",
"on",
"itsown",
"for",
"exact",
"nearest",
"neighbor",
"search",
"in",
"small",
"datasets",
"it",
"is",
"also",
"a",
"component",
"of",
"many",
"indexes",
"in",
"the",
"literature",
"in",
"our",
"case",
"we",
"use",
"it",
"for",
"the",
"ivfadc",
"coarse",
"quantizer",
"q1",
"as",
"stated",
"in",
"section",
"2",
"the",
"distance",
"computation",
"boils",
"down",
"to",
"a",
"matrix",
"multiplication",
"we",
"use",
"optimized",
"gemm",
"routines",
"in",
"the",
"cublas",
"library",
"to",
"calculate",
"the",
"2",
"xj",
"yi",
"term",
"for",
"l2",
"distance",
"resulting",
"in",
"a",
"partial",
"distance",
"matrix",
"d",
"to",
"complete",
"the",
"distance",
"calculation",
"we",
"use",
"a",
"fused",
"k",
"selection",
"kernel",
"that",
"adds",
"the",
"yi",
"2term",
"to",
"each",
"entry",
"of",
"the",
"distance",
"matrix",
"and",
"immediately",
"submits",
"the",
"value",
"to",
"k",
"selection",
"in",
"registers",
"the",
"xj",
"2term",
"need",
"not",
"be",
"taken",
"into",
"account",
"before",
"k",
"selection",
"kernel",
"fusion",
"thus",
"allows",
"for",
"only",
"2",
"passes",
"gemm",
"write",
"k",
"select",
"read",
"over",
"d",
"com",
"pared",
"to",
"other",
"implementations",
"that",
"may",
"require",
"3",
"or",
"more",
"row",
"wisek",
"selection",
"is",
"likely",
"not",
"fusable",
"with",
"a",
"well",
"tuned",
"gemm",
"kernel",
"or",
"would",
"result",
"in",
"lower",
"overall",
"asd",
"does",
"not",
"in",
"gpu",
"memory",
"for",
"realistic",
"problem",
"sizes",
"the",
"problem",
"is",
"tiled",
"over",
"the",
"batch",
"of",
"queries",
"with",
"tq",
"nqqueries",
"being",
"run",
"in",
"a",
"single",
"tile",
"each",
"of",
"the",
"nq",
"tq",
"tiles",
"are",
"independent",
"problems",
"but",
"we",
"run",
"two",
"in",
"parallel",
"on",
"streams",
"to",
"better",
"occupy",
"the",
"gpu",
"so",
"the",
"tive",
"memory",
"requirement",
"of",
"diso",
"the",
"computation",
"can",
"similarly",
"be",
"tiled",
"over",
"for",
"very",
"large",
"input",
"coming",
"from",
"the",
"cpu",
"we",
"support",
"with",
"pinned",
"memory",
"to",
"overlap",
"cpu",
"to",
"gpu",
"copy",
"with",
"gpu",
"compute",
"5",
"2",
"ivfadc",
"indexing",
"pq",
"lookup",
"tables",
"at",
"its",
"core",
"the",
"ivfadc",
"requires",
"com",
"puting",
"the",
"distance",
"from",
"a",
"vector",
"to",
"a",
"set",
"of",
"product",
"quanti",
"zation",
"reproduction",
"values"
],
[
"5",
"2",
"ivfadc",
"indexing",
"pq",
"lookup",
"tables",
"at",
"its",
"core",
"the",
"ivfadc",
"requires",
"com",
"puting",
"the",
"distance",
"from",
"a",
"vector",
"to",
"a",
"set",
"of",
"product",
"quanti",
"zation",
"reproduction",
"values",
"by",
"developing",
"equation",
"6",
"for",
"a",
"database",
"vector",
"y",
"we",
"obtain",
"x",
"q",
"y",
"2",
"2",
"x",
"q1",
"y",
"q2",
"y",
"q1",
"y",
"2",
"2",
"7",
"if",
"we",
"decompose",
"the",
"residual",
"vectors",
"left",
"after",
"q1as",
"y",
"q1",
"y",
"y1",
"yb",
"and",
"8",
"x",
"q1",
"y",
"x1",
"xb",
"9",
"then",
"the",
"distance",
"is",
"rewritten",
"as",
"x",
"q",
"y",
"2",
"2",
"x1",
"q1",
"y1",
"2",
"2",
"xb",
"qb",
"yb",
"2",
"2",
"10",
"each",
"quantizer",
"q1",
"qbhas",
"256",
"reproduction",
"values",
"so",
"whenxandq1",
"y",
"are",
"known",
"all",
"distances",
"can",
"be",
"precom",
"puted",
"and",
"stored",
"in",
"tables",
"t1",
"t",
"beach",
"of",
"size",
"256",
"25",
"computing",
"the",
"sum",
"10",
"consists",
"of",
"blook",
"ups",
"and",
"addi",
"tions",
"comparing",
"the",
"cost",
"to",
"compute",
"ndistances",
"explicit",
"computation",
"n",
"dmutiply",
"adds",
"with",
"lookup",
"tables",
"256",
"dmultiply",
"adds",
"and",
"n",
"b",
"lookup",
"adds",
"this",
"is",
"the",
"key",
"to",
"the",
"of",
"the",
"product",
"quantizer",
"in",
"our",
"gpu",
"implementation",
"bis",
"any",
"multiple",
"of",
"4",
"up",
"to"
],
[
"vector",
"within",
"lists",
"ivfadc",
"lookup",
"tables",
"when",
"scanning",
"over",
"the",
"ele",
"ments",
"of",
"the",
"inverted",
"list",
"il",
"where",
"by",
"q1",
"y",
"is",
"constant",
"the",
"look",
"up",
"table",
"method",
"can",
"be",
"applied",
"as",
"the",
"queryxandq1",
"y",
"are",
"known",
"6"
],
[
"moreover",
"the",
"computation",
"of",
"the",
"tables",
"t1",
"t",
"bis",
"fur",
"ther",
"optimized",
"5",
"the",
"expression",
"of",
"x",
"q",
"y",
"2",
"2in",
"equation",
"7",
"can",
"be",
"decomposed",
"as",
"q2",
"2",
"2",
"2",
"q1",
"y",
"q2",
"term",
"1",
"x",
"q1",
"y",
"2",
"2",
"term",
"2",
"2",
"x",
"q2",
"term",
"3",
"11",
"the",
"objective",
"is",
"to",
"minimize",
"inner",
"loop",
"computations",
"the",
"computations",
"we",
"can",
"do",
"in",
"advance",
"and",
"store",
"in",
"lookup",
"tables",
"are",
"as",
"follows",
"term",
"1",
"is",
"independent",
"of",
"the",
"query",
"it",
"can",
"be",
"precom",
"puted",
"from",
"the",
"quantizers",
"and",
"stored",
"in",
"a",
"table",
"tof",
"size",
"c1",
"256",
"b",
"term",
"2",
"is",
"the",
"distance",
"to",
"q1",
"s",
"reproduction",
"value",
"it",
"is",
"thus",
"a",
"by",
"product",
"of",
"the",
"level",
"quantizer",
"q1",
"term",
"3",
"can",
"be",
"computed",
"independently",
"of",
"the",
"inverted",
"list",
"its",
"computation",
"costs",
"d",
"256",
"multiply",
"adds",
"this",
"decomposition",
"is",
"used",
"to",
"produce",
"the",
"lookup",
"tables",
"t1",
"t",
"bused",
"during",
"the",
"scan",
"of",
"the",
"inverted",
"list",
"for",
"a",
"single",
"query",
"computing",
"the",
"btables",
"from",
"scratch",
"costs",
"d",
"256",
"multiply",
"adds",
"while",
"this",
"decomposition",
"costs",
"256",
"dmultiply",
"adds",
"and",
"b",
"256",
"additions",
"on",
"the",
"gpu",
"the",
"memory",
"usage",
"of",
"tcan",
"be",
"prohibitive",
"so",
"we",
"enable",
"the",
"decomposition",
"only",
"when",
"memory",
"is",
"a",
"not",
"a",
"concern",
"5",
"3",
"gpu",
"implementation",
"algorithm",
"4",
"summarizes",
"the",
"process",
"as",
"one",
"would",
"im",
"plement",
"it",
"on",
"a",
"cpu",
"the",
"inverted",
"lists",
"are",
"stored",
"as",
"two",
"separate",
"arrays",
"for",
"pq",
"codes",
"and",
"associated",
"ids",
"ids",
"are",
"resolved",
"only",
"if",
"k",
"selection",
"determines",
"k",
"nearest",
"member",
"ship",
"this",
"lookup",
"yields",
"a",
"few",
"sparse",
"memory",
"reads",
"in",
"a",
"large",
"array",
"thus",
"the",
"ids",
"can",
"optionally",
"be",
"stored",
"on",
"cpu",
"for",
"tiny",
"performance",
"cost",
"list",
"scanning",
"a",
"kernel",
"is",
"responsible",
"for",
"scanning",
"the",
"closest",
"inverted",
"lists",
"for",
"each",
"query",
"and",
"calculating",
"the",
"per",
"vector",
"pair",
"distances",
"using",
"the",
"lookup",
"tables",
"ti",
"thetiare",
"stored",
"in",
"shared",
"memory",
"up",
"to",
"nq",
"max",
"i",
"ii",
"blookups",
"are",
"required",
"for",
"a",
"query",
"set",
"trillions",
"of",
"accesses",
"in",
"practice",
"and",
"are",
"random",
"access",
"this",
"limits",
"bto",
"at",
"most",
"48",
"32",
"bit",
"point",
"or",
"96",
"16",
"bit",
"point",
"with",
"current",
"architectures",
"in",
"case",
"we",
"do",
"not",
"use",
"the",
"decomposition",
"of",
"equation",
"11",
"the",
"tiare",
"calculated",
"by",
"a",
"separate",
"kernel",
"before",
"scanning",
"multi",
"pass",
"kernels"
],
[
"this",
"limits",
"bto",
"at",
"most",
"48",
"32",
"bit",
"point",
"or",
"96",
"16",
"bit",
"point",
"with",
"current",
"architectures",
"in",
"case",
"we",
"do",
"not",
"use",
"the",
"decomposition",
"of",
"equation",
"11",
"the",
"tiare",
"calculated",
"by",
"a",
"separate",
"kernel",
"before",
"scanning",
"multi",
"pass",
"kernels",
"eachnq",
"of",
"query",
"against",
"inverted",
"list",
"can",
"be",
"processed",
"independently",
"at",
"one",
"ex",
"treme",
"a",
"block",
"is",
"dedicated",
"to",
"each",
"of",
"these",
"resulting",
"in",
"up",
"tonq",
"max",
"i",
"ii",
"partial",
"results",
"being",
"written",
"back",
"to",
"global",
"memory",
"which",
"is",
"then",
"k",
"selected",
"to",
"nq",
"re",
"sults",
"this",
"yields",
"high",
"parallelism",
"but",
"can",
"exceed",
"available",
"gpu",
"global",
"memory",
"as",
"with",
"exact",
"search",
"we",
"choose",
"a",
"tile",
"sizetq",
"nqto",
"reduce",
"memory",
"consumption",
"bounding",
"its",
"complexity",
"byo",
"i",
"ii",
"with",
"multi",
"streaming",
"a",
"single",
"warp",
"could",
"be",
"dedicated",
"to",
"k",
"selection",
"of",
"each",
"tqset",
"of",
"lists",
"which",
"could",
"result",
"in",
"low",
"parallelism",
"we",
"introduce",
"a",
"two",
"pass",
"k",
"selection",
"reducing",
"tq",
"max",
"i",
"ii",
"totq",
"f",
"kpartial",
"results",
"for",
"some",
"subdivision",
"factor",
"f",
"this",
"is",
"reduced",
"again",
"via",
"k",
"selection",
"to",
"the",
"tq",
"kresults",
"fused",
"kernel",
"as",
"with",
"exact",
"search",
"we",
"experimented",
"with",
"a",
"kernel",
"that",
"dedicates",
"a",
"single",
"block",
"to",
"scanning",
"all",
"a",
"single",
"query",
"with",
"k",
"selection",
"fused",
"with",
"distance",
"com",
"putation",
"this",
"is",
"possible",
"as",
"warpselect",
"does",
"not",
"for",
"the",
"shared",
"memory",
"resource",
"which",
"is",
"severely",
"limited",
"this",
"reduces",
"global",
"memory",
"write",
"back",
"since",
"almost",
"all",
"interme",
"diate",
"results",
"can",
"be",
"eliminated",
"however",
"unlike",
"k",
"selection",
"overhead",
"for",
"exact",
"computation",
"a",
"portion",
"of",
"the",
"runtime",
"is",
"the",
"gather",
"from",
"the",
"tiin",
"shared",
"memory",
"and",
"lin",
"ear",
"scanning",
"of",
"the",
"iifrom",
"global",
"memory",
"the",
"write",
"back",
"is",
"not",
"a",
"dominant",
"contributor",
"timing",
"for",
"the",
"fused",
"kernel",
"is",
"improved",
"by",
"at",
"most",
"15",
"and",
"for",
"some",
"problem",
"sizes",
"would",
"be",
"subject",
"to",
"lower",
"parallelism",
"and",
"worse",
"performance",
"with",
"out",
"subsequent",
"decomposition",
"therefore",
"and",
"for",
"reasons",
"of",
"implementation",
"simplicity",
"we",
"do",
"not",
"use",
"this",
"layout"
],
[
"timing",
"for",
"the",
"fused",
"kernel",
"is",
"improved",
"by",
"at",
"most",
"15",
"and",
"for",
"some",
"problem",
"sizes",
"would",
"be",
"subject",
"to",
"lower",
"parallelism",
"and",
"worse",
"performance",
"with",
"out",
"subsequent",
"decomposition",
"therefore",
"and",
"for",
"reasons",
"of",
"implementation",
"simplicity",
"we",
"do",
"not",
"use",
"this",
"layout",
"algorithm",
"4",
"ivfpq",
"batch",
"search",
"routine",
"function",
"ivfpq",
"search",
"x1",
"x",
"nq",
"i1",
"i",
"c1",
"fori",
"0",
"nqdo",
"batch",
"quantization",
"of",
"section",
"5",
"1",
"li",
"ivf",
"argminc",
"c1",
"x",
"c",
"2",
"end",
"for",
"fori",
"0",
"nqdo",
"l",
"distance",
"table",
"compute",
"term",
"3",
"see",
"section",
"5",
"2",
"forlinli",
"ivfdo",
"compute",
"distance",
"tables",
"t1",
"t",
"b",
"forjinildo",
"distance",
"estimation",
"equation",
"10",
"d",
"xi",
"q",
"yj",
"2",
"2",
"append",
"d",
"l",
"j",
"tol",
"end",
"for",
"end",
"for",
"ri",
"k",
"select",
"smallest",
"distances",
"dfroml",
"end",
"for",
"return",
"r",
"end",
"function",
"5",
"4",
"multi",
"gpu",
"parallelism",
"modern",
"servers",
"can",
"support",
"several",
"gpus",
"we",
"employ",
"this",
"capability",
"for",
"both",
"compute",
"power",
"and",
"memory",
"replication",
"if",
"an",
"index",
"instance",
"in",
"the",
"memory",
"of",
"a",
"single",
"gpu",
"it",
"can",
"be",
"replicated",
"across",
"gpus",
"to",
"querynqvectors",
"each",
"replica",
"handles",
"a",
"fraction",
"nq",
"rof",
"the",
"queries",
"joining",
"the",
"results",
"back",
"together",
"on",
"a",
"single",
"gpu",
"or",
"in",
"cpu",
"memory",
"replication",
"has",
"near",
"linear",
"speedup",
"except",
"for",
"a",
"potential",
"loss",
"in",
"for",
"small",
"nq",
"sharding",
"if",
"an",
"index",
"instance",
"does",
"not",
"in",
"the",
"memory",
"of",
"a",
"single",
"gpu",
"an",
"index",
"can",
"be",
"sharded",
"across",
"ent",
"gpus",
"for",
"adding",
"each",
"shard",
"receives",
"sof",
"the",
"vectors",
"and",
"for",
"query",
"each",
"shard",
"handles",
"the",
"full",
"query",
"setnq",
"joining",
"the",
"partial",
"results",
"an",
"additional",
"round",
"of",
"k",
"selection",
"is",
"still",
"required",
"on",
"a",
"single",
"gpu",
"or",
"in",
"cpu",
"mem",
"ory",
"for",
"a",
"given",
"index",
"size",
"sharding",
"will",
"yield",
"a",
"speedup",
"sharding",
"has",
"a",
"query",
"of",
"sversus",
"replication",
"with",
"a",
"query",
"of",
"nq",
"but",
"is",
"usually",
"less",
"than",
"pure",
"replication",
"due",
"to",
"overhead",
"and",
"cost",
"of",
"subse",
"quentk",
"selection",
"replication",
"and",
"sharding",
"can",
"be",
"used",
"together",
"sshards",
"each",
"withrreplicas",
"fors",
"r",
"gpus",
"in",
"total",
"sharding",
"or",
"replication",
"are",
"both",
"fairly",
"trivial",
"and",
"the",
"same",
"principle",
"can",
"be",
"used",
"to",
"distribute",
"an",
"index",
"across",
"multiple",
"machines",
"7"
],
[
"figure",
"3",
"runtimes",
"for",
"k",
"selection",
"meth",
"ods",
"as",
"a",
"function",
"of",
"array",
"length",
"simultaneous",
"arrays",
"processed",
"are",
"nq",
"10000",
"k",
"100",
"for",
"full",
"lines",
"k",
"1000",
"for",
"dashed",
"lines"
],
[
"this",
"section",
"compares",
"our",
"gpu",
"k",
"selection",
"and",
"nearest",
"neighbor",
"approach",
"to",
"existing",
"libraries",
"unless",
"stated",
"other",
"wise",
"experiments",
"are",
"carried",
"out",
"on",
"a",
"2",
"2",
"8ghz",
"intel",
"xeon",
"e5",
"2680v2",
"with",
"4",
"maxwell",
"titan",
"x",
"gpus",
"on",
"cuda",
"8",
"0",
"6",
"1",
"k",
"selection",
"performance",
"we",
"compare",
"against",
"two",
"other",
"gpu",
"small",
"k",
"selection",
"im",
"plementations",
"the",
"row",
"based",
"merge",
"queue",
"with",
"search",
"and",
"hierarchical",
"partition",
"extracted",
"from",
"the",
"fgknn",
"library",
"of",
"tang",
"et",
"al",
"41",
"and",
"truncated",
"bitonic",
"sort",
"tbis",
"from",
"sismanis",
"et",
"al",
"40",
"both",
"were",
"extracted",
"from",
"their",
"re",
"spective",
"exact",
"search",
"libraries",
"we",
"evaluate",
"k",
"selection",
"for",
"k",
"100",
"and",
"1000",
"of",
"each",
"row",
"from",
"a",
"row",
"major",
"matrix",
"nq",
"random",
"32",
"bit",
"point",
"values",
"on",
"a",
"single",
"titan",
"x",
"the",
"batch",
"size",
"nqis",
"at",
"10000",
"and",
"the",
"array",
"lengths",
"from",
"1000",
"to",
"128000",
"inputs",
"and",
"outputs",
"to",
"the",
"problem",
"remain",
"resident",
"in",
"gpu",
"memory",
"with",
"the",
"output",
"being",
"of",
"size",
"nq",
"k",
"with",
"corre",
"sponding",
"indices",
"thus",
"the",
"input",
"problem",
"sizes",
"range",
"from",
"40",
"mb",
"1000",
"to",
"5",
"12",
"gb",
"128k",
"tbis",
"requires",
"large",
"auxiliary",
"storage",
"and",
"is",
"limited",
"to",
"48000",
"in",
"our",
"tests",
"figure",
"3",
"shows",
"our",
"relative",
"performance",
"against",
"tbis",
"and",
"fgknn",
"it",
"also",
"includes",
"the",
"peak",
"possible",
"performance",
"given",
"by",
"the",
"memory",
"bandwidth",
"limit",
"of",
"the",
"titan",
"x",
"the",
"rela",
"tive",
"performance",
"of",
"warpselect",
"over",
"fgknn",
"increases",
"for",
"largerk",
"even",
"tbis",
"starts",
"to",
"outperform",
"fgknn",
"for",
"larger",
"atk",
"1000",
"we",
"look",
"especially",
"at",
"the",
"largest",
"128000",
"warpselect",
"is",
"1",
"62",
"faster",
"atk",
"100",
"2",
"01",
"atk",
"1000",
"performance",
"against",
"peak",
"possible",
"drops",
"for",
"all",
"imple",
"mentations",
"at",
"larger",
"k",
"warpselect",
"operates",
"at",
"55",
"of",
"peak",
"atk",
"100",
"but",
"only",
"16",
"of",
"peak",
"at",
"k",
"1000",
"this",
"is",
"due",
"to",
"additional",
"overhead",
"assocated",
"with",
"bigger",
"thread",
"queues",
"and",
"merge",
"sort",
"networks",
"for",
"large",
"k",
"from",
"fgknn"
],
[
"this",
"is",
"due",
"to",
"additional",
"overhead",
"assocated",
"with",
"bigger",
"thread",
"queues",
"and",
"merge",
"sort",
"networks",
"for",
"large",
"k",
"from",
"fgknn",
"warpselect",
"is",
"by",
"fgknn",
"but",
"has",
"several",
"improvements",
"all",
"state",
"is",
"maintained",
"in",
"registers",
"no",
"shared",
"memory",
"no",
"inter",
"warp",
"synchroniza",
"tion",
"or",
"is",
"used",
"no",
"hierarchical",
"partition",
"the",
"k",
"selection",
"can",
"be",
"fused",
"into",
"other",
"kernels",
"and",
"it",
"uses",
"odd",
"size",
"networks",
"for",
"merging",
"and",
"sorting",
"centroids",
"method",
"gpus",
"256",
"4096",
"bidmach",
"11",
"1",
"320",
"s",
"735",
"s",
"ours",
"1",
"140",
"s",
"316",
"s",
"ours",
"4",
"84",
"s",
"100",
"s",
"table",
"1",
"mnist8m",
"k",
"means",
"performance",
"6",
"2",
"k",
"means",
"clustering",
"the",
"exact",
"search",
"method",
"with",
"k",
"1",
"can",
"be",
"used",
"by",
"a",
"k",
"means",
"clustering",
"method",
"in",
"the",
"assignment",
"stage",
"to",
"assign",
"nqtraining",
"vectors",
"to",
"c1",
"centroids",
"despite",
"the",
"fact",
"that",
"it",
"does",
"not",
"use",
"the",
"ivfadc",
"and",
"k",
"1",
"selection",
"is",
"trivial",
"a",
"parallel",
"reduction",
"is",
"used",
"for",
"the",
"k",
"1",
"case",
"not",
"warpse",
"lect",
"k",
"means",
"is",
"a",
"good",
"benchmark",
"for",
"the",
"clustering",
"used",
"to",
"train",
"the",
"quantizer",
"q1",
"we",
"apply",
"the",
"algorithm",
"on",
"mnist8m",
"images",
"the",
"8",
"1m",
"images",
"are",
"graylevel",
"digits",
"in",
"28x28",
"pixels",
"linearized",
"to",
"vec",
"tors",
"of",
"784",
"d",
"we",
"compare",
"this",
"k",
"means",
"implementation",
"to",
"the",
"gpuk",
"means",
"of",
"bidmach",
"11",
"which",
"was",
"shown",
"to",
"be",
"more",
"than",
"several",
"distributed",
"k",
"means",
"implemen",
"tations",
"that",
"require",
"dozens",
"of",
"machines3",
"both",
"algorithms",
"were",
"run",
"for",
"20",
"iterations",
"table",
"1",
"shows",
"that",
"our",
"imple",
"mentation",
"is",
"more",
"than",
"2",
"faster",
"although",
"both",
"are",
"built",
"upon",
"cublas",
"our",
"implementation",
"receives",
"some",
"from",
"thek",
"selection",
"fusion",
"into",
"l2",
"distance",
"computation",
"for",
"multi",
"gpu",
"execution",
"via",
"replicas",
"the",
"speedup",
"is",
"close",
"to",
"linear",
"for",
"large",
"enough",
"problems",
"3",
"16",
"for",
"4",
"gpus",
"with",
"4096",
"centroids",
"note",
"that",
"this",
"benchmark",
"is",
"somewhat",
"un",
"realistic",
"as",
"one",
"would",
"typically",
"sub",
"sample",
"the",
"dataset",
"ran",
"domly",
"when",
"so",
"few",
"centroids",
"are",
"requested",
"large",
"scale",
"we",
"can",
"also",
"compare",
"to",
"3",
"an",
"approximate",
"cpu",
"method",
"that",
"clusters",
"108128",
"d",
"vectors",
"to",
"85k",
"cen",
"troids",
"their",
"clustering",
"method",
"runs",
"in",
"46",
"minutes",
"but",
"re",
"quires",
"56",
"minutes",
"at",
"least",
"of",
"pre",
"processing",
"to",
"encode",
"the",
"vectors"
],
[
"large",
"scale",
"we",
"can",
"also",
"compare",
"to",
"3",
"an",
"approximate",
"cpu",
"method",
"that",
"clusters",
"108128",
"d",
"vectors",
"to",
"85k",
"cen",
"troids",
"their",
"clustering",
"method",
"runs",
"in",
"46",
"minutes",
"but",
"re",
"quires",
"56",
"minutes",
"at",
"least",
"of",
"pre",
"processing",
"to",
"encode",
"the",
"vectors",
"our",
"method",
"performs",
"exact",
"k",
"means",
"on",
"4",
"gpus",
"in",
"52",
"minutes",
"without",
"any",
"pre",
"processing",
"6",
"3",
"exact",
"nearest",
"neighbor",
"search",
"we",
"consider",
"a",
"classical",
"dataset",
"used",
"to",
"evaluate",
"nearest",
"neighbor",
"search",
"sift1m",
"25",
"its",
"characteristic",
"sizes",
"are",
"106",
"d",
"128",
"nq",
"104",
"computing",
"the",
"partial",
"distance",
"matrixd",
"costsnq",
"d",
"1",
"28",
"which",
"runs",
"in",
"less",
"than",
"one",
"second",
"on",
"current",
"gpus",
"figure",
"4",
"shows",
"the",
"cost",
"of",
"the",
"distance",
"computations",
"against",
"the",
"cost",
"of",
"our",
"tiling",
"of",
"the",
"gemm",
"for",
"the",
"2",
"xj",
"yi",
"term",
"of",
"equation",
"2",
"and",
"the",
"peak",
"possible",
"k",
"selection",
"performance",
"on",
"the",
"distance",
"matrix",
"of",
"size",
"nq",
"which",
"additionally",
"accounts",
"for",
"reading",
"the",
"tiled",
"result",
"matrix",
"d",
"at",
"peak",
"memory",
"bandwidth",
"in",
"addition",
"to",
"our",
"method",
"from",
"section",
"5",
"we",
"include",
"times",
"from",
"the",
"two",
"gpu",
"libraries",
"evaluated",
"for",
"k",
"selection",
"performance",
"in",
"section",
"6",
"1",
"we",
"make",
"several",
"observations",
"fork",
"selection",
"the",
"naive",
"algorithm",
"that",
"sorts",
"the",
"full",
"result",
"array",
"for",
"each",
"query",
"using",
"thrust",
"is",
"more",
"than",
"10",
"slower",
"than",
"the",
"comparison",
"methods",
"l2",
"distance",
"and",
"k",
"selection",
"cost",
"is",
"dominant",
"for",
"all",
"but",
"our",
"method",
"which",
"has",
"85",
"of",
"the",
"peak",
"possible",
"performance",
"assuming",
"gemm",
"usage",
"and",
"our",
"tiling",
"3bidmach",
"numbers",
"from",
"https",
"github",
"com",
"biddata",
"bidmach",
"wiki",
"benchmarks",
"kmeans",
"8"
],
[
"figure",
"4",
"exact",
"search",
"k",
"nn",
"time",
"for",
"the",
"sift1m",
"dataset",
"with",
"varying",
"kon",
"1",
"titan",
"x",
"gpu",
"of",
"the",
"partial",
"distance",
"matrix",
"d",
"on",
"top",
"of",
"gemm",
"is",
"close",
"to",
"optimal",
"the",
"cublas",
"gemm",
"itself",
"has",
"low",
"for",
"small",
"reduction",
"sizes",
"d",
"128",
"our",
"fused",
"l2",
"k",
"selection",
"kernel",
"is",
"important",
"our",
"same",
"exact",
"algorithm",
"without",
"fusion",
"requiring",
"an",
"ad",
"ditional",
"pass",
"through",
"d",
"is",
"at",
"least",
"25",
"slower",
"selection",
"is",
"even",
"more",
"important",
"in",
"situations",
"where",
"approximate",
"methods",
"are",
"used",
"to",
"compute",
"distances",
"because",
"the",
"relative",
"cost",
"of",
"k",
"selection",
"with",
"respect",
"to",
"dis",
"tance",
"computation",
"increases",
"6",
"4",
"billion",
"scale",
"approximate",
"search",
"there",
"are",
"few",
"studies",
"on",
"gpu",
"based",
"approximate",
"nearest",
"neighbor",
"search",
"on",
"large",
"datasets",
"106",
"we",
"report",
"a",
"few",
"comparison",
"points",
"here",
"on",
"index",
"search",
"using",
"standard",
"datasets",
"and",
"evaluation",
"protocol",
"in",
"this",
"sift1m",
"for",
"the",
"sake",
"of",
"completeness",
"we",
"compare",
"our",
"gpu",
"search",
"speed",
"on",
"sift1m",
"with",
"the",
"implementation",
"of",
"wieschollek",
"et",
"al",
"47",
"they",
"obtain",
"a",
"nearest",
"neighbor",
"re",
"call",
"at",
"1",
"fraction",
"of",
"queries",
"where",
"the",
"true",
"nearest",
"neighbor",
"is",
"in",
"the",
"top",
"1",
"result",
"of",
"r",
"1",
"0",
"51",
"and",
"r",
"100",
"0",
"86",
"in",
"0",
"02",
"ms",
"per",
"query",
"on",
"a",
"titan",
"x",
"for",
"the",
"same",
"time",
"budget",
"our",
"implementation",
"obtains",
"r",
"1",
"0",
"80",
"and",
"r",
"100",
"0",
"95",
"sift1b",
"we",
"compare",
"again",
"with",
"wieschollek",
"et",
"al",
"on",
"the",
"sift1b",
"dataset",
"26",
"of",
"1",
"billion",
"sift",
"image",
"features",
"at",
"nq"
],
[
"memory",
"usage",
"for",
"similar",
"accuracy",
"more",
"accurate",
"methods",
"may",
"involve",
"greater",
"search",
"time",
"or",
"memory",
"usage",
"on",
"a",
"single",
"gpu",
"with",
"m",
"8",
"bytes",
"per",
"vector",
"r",
"10",
"0",
"376",
"in",
"17",
"per",
"query",
"vector",
"versus",
"their",
"reported",
"r",
"10",
"0",
"35",
"in",
"per",
"query",
"vector",
"thus",
"our",
"implementation",
"is",
"more",
"accurate",
"at",
"a",
"speed",
"8",
"5",
"faster",
"deep1b",
"we",
"also",
"experimented",
"on",
"the",
"deep1b",
"dataset",
"6",
"1",
"billion",
"cnn",
"representations",
"for",
"images",
"at",
"nq",
"104",
"the",
"paper",
"that",
"introduces",
"the",
"dataset",
"reports",
"cpu",
"results",
"1",
"thread",
"r",
"1",
"0",
"45",
"in",
"20",
"ms",
"search",
"time",
"per",
"vector",
"we",
"use",
"a",
"pq",
"encoding",
"of",
"m",
"20",
"with",
"d",
"80",
"via",
"opq",
"17",
"and",
"c1",
"218",
"which",
"uses",
"a",
"comparable",
"dataset",
"storage",
"as",
"the",
"original",
"paper",
"20",
"gb",
"this",
"requires",
"multiple",
"gpus",
"as",
"it",
"is",
"too",
"large",
"for",
"a",
"single",
"gpu",
"s",
"global",
"memory",
"so",
"we",
"con",
"sider",
"4",
"gpus",
"with",
"s",
"2",
"r",
"2",
"we",
"obtain",
"a",
"r",
"1",
"0",
"4517",
"in",
"0",
"0133",
"ms",
"per",
"vector",
"while",
"the",
"hardware",
"platforms",
"are",
"figure",
"5",
"speed",
"accuracy",
"trade",
"of",
"brute",
"force",
"10",
"nn",
"graph",
"construction",
"for",
"the",
"yfcc100m",
"and",
"deep1b",
"datasets",
"it",
"shows",
"that",
"making",
"searches",
"on",
"gpus",
"is",
"a",
"game",
"changer",
"in",
"terms",
"of",
"speed",
"achievable",
"on",
"a",
"single",
"machine",
"6",
"5",
"the",
"k",
"nn",
"graph",
"an",
"example",
"usage",
"of",
"our",
"similarity",
"search",
"method",
"is",
"to",
"construct",
"a",
"k",
"nearest",
"neighbor",
"graph",
"of",
"a",
"dataset",
"via",
"brute",
"force",
"all",
"vectors",
"queried",
"against",
"the",
"entire",
"index",
"experimental",
"setup",
"we",
"evaluate",
"the",
"trade",
"between",
"speed",
"precision",
"and",
"memory",
"on",
"two",
"datasets",
"95",
"million",
"images",
"from",
"the",
"yfcc100m",
"dataset",
"42",
"and",
"deep1b",
"for",
"yfcc100m",
"we",
"compute",
"cnn",
"descriptors",
"as",
"the",
"one",
"before",
"last",
"layer",
"of",
"a",
"resnet",
"23",
"reduced",
"to",
"d",
"128",
"with",
"pca"
],
[
"we",
"evaluate",
"the",
"trade",
"between",
"speed",
"precision",
"and",
"memory",
"on",
"two",
"datasets",
"95",
"million",
"images",
"from",
"the",
"yfcc100m",
"dataset",
"42",
"and",
"deep1b",
"for",
"yfcc100m",
"we",
"compute",
"cnn",
"descriptors",
"as",
"the",
"one",
"before",
"last",
"layer",
"of",
"a",
"resnet",
"23",
"reduced",
"to",
"d",
"128",
"with",
"pca",
"the",
"evaluation",
"measures",
"the",
"trade",
"between",
"speed",
"how",
"much",
"time",
"it",
"takes",
"to",
"build",
"the",
"ivfadc",
"index",
"from",
"scratch",
"and",
"construct",
"the",
"whole",
"k",
"nn",
"graph",
"k",
"10",
"by",
"searching",
"nearest",
"neighbors",
"for",
"all",
"vectors",
"in",
"the",
"dataset",
"thus",
"this",
"is",
"an",
"end",
"to",
"end",
"test",
"that",
"includes",
"indexing",
"as",
"well",
"as",
"search",
"time",
"quality",
"we",
"sample",
"10",
"000",
"images",
"for",
"which",
"we",
"com",
"pute",
"the",
"exact",
"nearest",
"neighbors",
"our",
"accuracy",
"mea",
"sure",
"is",
"the",
"fraction",
"of",
"10",
"found",
"nearest",
"neighbors",
"that",
"are",
"within",
"the",
"ground",
"truth",
"10",
"nearest",
"neighbors",
"foryfcc100m",
"we",
"use",
"a",
"coarse",
"quantizer",
"216centroids",
"and",
"consider",
"m",
"16",
"32",
"and",
"64",
"byte",
"pq",
"encodings",
"for",
"each",
"vector",
"for",
"deep1b",
"we",
"pre",
"process",
"the",
"vectors",
"to",
"d",
"120",
"via",
"opq",
"use",
"c1",
"218and",
"consider",
"m",
"20",
"40",
"for",
"a",
"given",
"encoding",
"we",
"vary",
"1",
"to",
"256",
"to",
"obtain",
"trade",
"between",
"and",
"quality",
"as",
"seen",
"in",
"figure",
"5",
"9"
],
[
"figure",
"6",
"path",
"in",
"the",
"k",
"nn",
"graph",
"of",
"95",
"million",
"images",
"from",
"yfcc100m",
"the",
"and",
"the",
"last",
"image",
"are",
"given",
"the",
"algorithm",
"computes",
"the",
"smoothest",
"path",
"between",
"them",
"discussion",
"foryfcc100m",
"we",
"useds",
"1",
"r",
"4",
"an",
"accuracy",
"of",
"more",
"than",
"0",
"8",
"is",
"obtained",
"in",
"35",
"minutes",
"for",
"deep1b",
"a",
"lower",
"quality",
"graph",
"can",
"be",
"built",
"in",
"6",
"hours",
"with",
"higher",
"quality",
"in",
"about",
"half",
"a",
"day",
"we",
"also",
"experi",
"mented",
"with",
"more",
"gpus",
"by",
"doubling",
"the",
"replica",
"set",
"us",
"ing",
"8",
"maxwell",
"m40s",
"the",
"m40",
"is",
"roughly",
"equivalent",
"in",
"per",
"formance",
"to",
"the",
"titan",
"x",
"performance",
"is",
"improved",
"sub",
"linearly",
"1",
"6",
"form",
"20",
"1",
"7",
"form",
"40",
"for",
"comparison",
"the",
"largest",
"k",
"nn",
"graph",
"construction",
"we",
"are",
"aware",
"of",
"used",
"a",
"dataset",
"comprising",
"36",
"5",
"million",
"384",
"d",
"vectors",
"which",
"took",
"a",
"cluster",
"of",
"128",
"cpu",
"servers",
"108",
"7",
"hours",
"of",
"compute",
"45",
"using",
"nn",
"descent",
"15",
"note",
"that",
"nn",
"descent",
"could",
"also",
"build",
"or",
"the",
"k",
"nn",
"graph",
"for",
"the",
"datasets",
"we",
"consider",
"but",
"it",
"has",
"a",
"large",
"memory",
"over",
"head",
"over",
"the",
"graph",
"storage",
"which",
"is",
"already",
"80",
"gb",
"for",
"deep1b",
"moreover",
"it",
"requires",
"random",
"access",
"across",
"all",
"vec",
"tors",
"384",
"gb",
"for",
"deep1b",
"the",
"largest",
"gpu",
"k",
"nn",
"graph",
"construction",
"we",
"found",
"is",
"a",
"brute",
"force",
"construction",
"using",
"exact",
"search",
"with",
"gemm",
"of",
"a",
"dataset",
"of",
"20",
"million",
"15",
"000",
"d",
"vectors",
"which",
"took",
"a",
"cluster",
"of",
"32",
"tesla",
"c2050",
"gpus",
"10",
"days",
"14",
"assuming",
"computa",
"tion",
"scales",
"with",
"gemm",
"cost",
"for",
"the",
"distance",
"matrix",
"this",
"approach",
"for",
"deep1b",
"would",
"take",
"an",
"impractical",
"200",
"days",
"of",
"computation",
"time",
"on",
"their",
"cluster",
"6",
"6",
"using",
"the",
"k",
"nn",
"graph",
"when",
"ak",
"nn",
"graph",
"has",
"been",
"constructed",
"for",
"an",
"image",
"dataset",
"we",
"can",
"paths",
"in",
"the",
"graph",
"between",
"any",
"two",
"images",
"provided",
"there",
"is",
"a",
"single",
"connected",
"component",
"this",
"is",
"the",
"case",
"for",
"example",
"we",
"can",
"search",
"the",
"shortest",
"path",
"between",
"two",
"images",
"of",
"by",
"propagating",
"neighbors",
"from",
"a",
"starting",
"image",
"to",
"a",
"destination",
"image",
"denoting",
"by",
"sanddthe",
"source",
"and",
"destination",
"images",
"and",
"dijthe",
"distance",
"between",
"nodes",
"we",
"search",
"the",
"path",
"p",
"p1",
"p",
"n",
"withp1",
"sandpn",
"dsuch",
"that",
"min",
"pmax",
"i",
"1",
"ndpipi",
"1",
"12",
"i",
"e",
"we",
"want",
"to",
"favor",
"smooth",
"transitions",
"an",
"example",
"re",
"sult",
"is",
"shown",
"in",
"figure",
"6",
"from",
"yfcc100m4"
],
[
"an",
"example",
"re",
"sult",
"is",
"shown",
"in",
"figure",
"6",
"from",
"yfcc100m4",
"it",
"was",
"ob",
"tained",
"after",
"20",
"seconds",
"of",
"propagation",
"in",
"a",
"k",
"nn",
"graph",
"with",
"k",
"15",
"neighbors",
"since",
"there",
"are",
"many",
"images",
"in",
"the",
"dataset",
"the",
"transitions",
"are",
"smooth",
"4the",
"mapping",
"from",
"vectors",
"to",
"images",
"is",
"not",
"available",
"for",
"deep1b7",
"conclusion",
"the",
"arithmetic",
"throughput",
"and",
"memory",
"bandwidth",
"of",
"gpus",
"are",
"well",
"into",
"the",
"and",
"hundreds",
"of",
"gigabytes",
"per",
"second",
"however",
"implementing",
"algorithms",
"that",
"ap",
"proach",
"these",
"performance",
"levels",
"is",
"complex",
"and",
"counter",
"intuitive",
"in",
"this",
"paper",
"we",
"presented",
"the",
"algorithmic",
"struc",
"ture",
"of",
"similarity",
"search",
"methods",
"that",
"achieves",
"near",
"optimal",
"performance",
"on",
"gpus",
"this",
"work",
"enables",
"applications",
"that",
"needed",
"complex",
"ap",
"proximate",
"algorithms",
"before",
"for",
"example",
"the",
"approaches",
"presented",
"here",
"make",
"it",
"possible",
"to",
"do",
"exact",
"k",
"means",
"cluster",
"ing",
"or",
"to",
"compute",
"the",
"k",
"nn",
"graph",
"with",
"simple",
"brute",
"force",
"approaches",
"in",
"less",
"time",
"than",
"a",
"cpu",
"or",
"a",
"cluster",
"of",
"them",
"would",
"take",
"to",
"do",
"this",
"approximately",
"gpu",
"hardware",
"is",
"now",
"very",
"common",
"on",
"work",
"stations",
"due",
"to",
"their",
"popularity",
"for",
"machine",
"learning",
"algo",
"rithms",
"we",
"believe",
"that",
"our",
"work",
"further",
"demonstrates",
"their",
"interest",
"for",
"database",
"applications",
"along",
"with",
"this",
"work",
"we",
"are",
"publishing",
"a",
"carefully",
"engineered",
"implementation",
"of",
"this",
"paper",
"s",
"algorithms",
"so",
"that",
"these",
"gpus",
"can",
"now",
"also",
"be",
"used",
"for",
"similarity",
"search"
],
[
"1",
"t",
"alabi",
"j",
"d",
"blanchard",
"b",
"gordon",
"and",
"r",
"steinbach",
"fast",
"k",
"selection",
"algorithms",
"for",
"graphics",
"processing",
"units",
"acm",
"journal",
"of",
"experimental",
"algorithmics",
"17",
"4",
"2",
"4",
"1",
"4",
"2",
"4",
"29",
"october",
"2012",
"2",
"f",
"andr",
"e",
"a",
"m",
"kermarrec",
"and",
"n",
"l",
"scouarnec",
"cache",
"locality",
"is",
"not",
"enough",
"high",
"performance",
"nearest",
"neighbor",
"search",
"with",
"product",
"quantization",
"fast",
"scan",
"in",
"proc",
"international",
"conference",
"on",
"very",
"large",
"databases",
"pages",
"288",
"299",
"2015",
"3",
"y",
"avrithis",
"y",
"kalantidis",
"e",
"anagnostopoulos",
"and",
"i",
"z",
"emiris",
"web",
"scale",
"image",
"clustering",
"revisited",
"in",
"proc",
"international",
"conference",
"on",
"computer",
"vision",
"pages",
"1502",
"1510",
"2015",
"4",
"a",
"babenko",
"and",
"v",
"lempitsky",
"the",
"inverted",
"multi",
"index",
"inproc",
"ieee",
"conference",
"on",
"computer",
"vision",
"and",
"pattern",
"recognition",
"pages",
"3069",
"3076",
"june",
"2012",
"5",
"a",
"babenko",
"and",
"v",
"lempitsky",
"improving",
"bilayer",
"product",
"quantization",
"for",
"billion",
"scale",
"approximate",
"nearest",
"neighbors",
"in",
"high",
"dimensions",
"arxiv",
"preprint",
"arxiv",
"1404",
"1831",
"2014",
"6",
"a",
"babenko",
"and",
"v",
"lempitsky",
"indexing",
"of",
"billion",
"scale",
"datasets",
"of",
"deep",
"descriptors",
"in",
"proc",
"ieee",
"conference",
"on",
"computer",
"vision",
"and",
"pattern",
"recognition",
"pages",
"2055",
"2063",
"june",
"2016",
"7",
"r",
"barrientos",
"j",
"g",
"omez",
"c",
"tenllado",
"m",
"prieto",
"and",
"m",
"marin",
"knn",
"query",
"processing",
"in",
"metric",
"spaces",
"using",
"gpus",
"in",
"international",
"european",
"conference",
"on",
"parallel",
"and",
"distributed",
"computing",
"volume",
"6852",
"of",
"lecture",
"notes",
"10"
],
[
"in",
"computer",
"science",
"pages",
"380",
"392",
"bordeaux",
"france",
"september",
"2011",
"springer",
"8",
"k",
"e",
"batcher",
"sorting",
"networks",
"and",
"their",
"applications",
"in",
"proc",
"spring",
"joint",
"computer",
"conference",
"afips",
"68",
"spring",
"pages",
"307",
"314",
"new",
"york",
"ny",
"usa",
"1968",
"acm",
"9",
"p",
"boncz",
"w",
"lehner",
"and",
"t",
"neumann",
"special",
"issue",
"modern",
"hardware",
"the",
"vldb",
"journal",
"25",
"5",
"623",
"624",
"2016",
"10",
"j",
"canny",
"d",
"l",
"w",
"hall",
"and",
"d",
"klein",
"a",
"multi",
"constituency",
"parser",
"using",
"gpus",
"in",
"proc",
"empirical",
"methods",
"on",
"natural",
"language",
"processing",
"pages",
"1898",
"1907",
"acl",
"2013",
"11",
"j",
"canny",
"and",
"h",
"zhao",
"bidmach",
"large",
"scale",
"learning",
"with",
"zero",
"memory",
"allocation",
"in",
"biglearn",
"workshop",
"nips",
"2013",
"12",
"b",
"catanzaro",
"a",
"keller",
"and",
"m",
"garland",
"a",
"decomposition",
"for",
"in",
"place",
"matrix",
"transposition",
"in",
"proc",
"acm",
"symposium",
"on",
"principles",
"and",
"practice",
"of",
"parallel",
"programming",
"ppopp",
"14",
"pages",
"193",
"206",
"2014",
"13",
"j",
"chhugani",
"a",
"d",
"nguyen",
"v",
"w",
"lee",
"w",
"macy",
"m",
"hagog",
"y",
"k",
"chen",
"a",
"baransi",
"s",
"kumar",
"and",
"p",
"dubey",
"implementation",
"of",
"sorting",
"on",
"multi",
"core",
"simd",
"cpu",
"architecture",
"proc",
"vldb",
"endow",
"1",
"2",
"1313",
"1324",
"august",
"2008",
"14",
"a",
"dashti",
"computation",
"of",
"k",
"nearest",
"neighbor",
"graphs",
"for",
"large",
"high",
"dimensional",
"data",
"sets",
"on",
"gpu",
"clusters",
"master",
"s",
"thesis",
"university",
"of",
"wisconsin",
"milwaukee",
"august",
"2013",
"15",
"w",
"dong",
"m",
"charikar",
"and",
"k",
"li",
"k",
"nearest",
"neighbor",
"graph",
"construction",
"for",
"generic",
"similarity",
"measures",
"inwww",
"proceeding",
"of",
"the",
"international",
"conference",
"on",
"world",
"wide",
"web",
"pages",
"577",
"586",
"march",
"2011",
"16",
"m",
"douze",
"h",
"j",
"egou",
"and",
"f",
"perronnin",
"polysemous",
"codes",
"inproc",
"european",
"conference",
"on",
"computer",
"vision",
"pages",
"785",
"801",
"springer",
"october",
"2016",
"17",
"t",
"ge",
"k",
"he",
"q",
"ke",
"and",
"j",
"sun",
"optimized",
"product",
"quantization",
"ieee",
"trans",
"pami",
"36",
"4",
"744",
"755",
"2014",
"18",
"y",
"gong",
"and",
"s",
"lazebnik",
"iterative",
"quantization",
"a",
"procrustean",
"approach",
"to",
"learning",
"binary",
"codes",
"in",
"proc",
"ieee",
"conference",
"on",
"computer",
"vision",
"and",
"pattern",
"recognition",
"pages",
"817",
"824",
"june",
"2011",
"19",
"y",
"gong",
"l",
"wang",
"r",
"guo",
"and",
"s",
"lazebnik",
"multi",
"scale",
"orderless",
"pooling",
"of",
"deep",
"convolutional",
"activation",
"features",
"inproc",
"european",
"conference",
"on",
"computer",
"vision",
"pages",
"392",
"407",
"2014",
"20",
"a",
"gordo",
"j",
"almazan",
"j",
"revaud",
"and",
"d",
"larlus",
"deep",
"image",
"retrieval",
"learning",
"global",
"representations",
"for",
"image",
"search",
"in",
"proc"
],
[
"lazebnik",
"multi",
"scale",
"orderless",
"pooling",
"of",
"deep",
"convolutional",
"activation",
"features",
"inproc",
"european",
"conference",
"on",
"computer",
"vision",
"pages",
"392",
"407",
"2014",
"20",
"a",
"gordo",
"j",
"almazan",
"j",
"revaud",
"and",
"d",
"larlus",
"deep",
"image",
"retrieval",
"learning",
"global",
"representations",
"for",
"image",
"search",
"in",
"proc",
"european",
"conference",
"on",
"computer",
"vision",
"pages",
"241",
"257",
"2016",
"21",
"s",
"han",
"h",
"mao",
"and",
"w",
"j",
"dally",
"deep",
"compression",
"compressing",
"deep",
"neural",
"networks",
"with",
"pruning",
"trained",
"quantization",
"and",
"coding",
"arxiv",
"preprint",
"arxiv",
"1510",
"00149",
"2015",
"22",
"k",
"he",
"f",
"wen",
"and",
"j",
"sun",
"k",
"means",
"hashing",
"an",
"preserving",
"quantization",
"method",
"for",
"learning",
"binary",
"compact",
"codes",
"in",
"proc",
"ieee",
"conference",
"on",
"computer",
"vision",
"and",
"pattern",
"recognition",
"pages",
"2938",
"2945",
"june",
"2013",
"23",
"k",
"he",
"x",
"zhang",
"s",
"ren",
"and",
"j",
"sun",
"deep",
"residual",
"learning",
"for",
"image",
"recognition",
"in",
"proc",
"ieee",
"conference",
"on",
"computer",
"vision",
"and",
"pattern",
"recognition",
"pages",
"770",
"778",
"june",
"2016",
"24",
"x",
"he",
"d",
"agarwal",
"and",
"s",
"k",
"prasad",
"design",
"and",
"implementation",
"of",
"a",
"parallel",
"priority",
"queue",
"on",
"many",
"core",
"architectures",
"ieee",
"international",
"conference",
"on",
"high",
"performance",
"computing",
"pages",
"1",
"10",
"2012",
"25",
"h",
"j",
"egou",
"m",
"douze",
"and",
"c",
"schmid",
"product",
"quantization",
"for",
"nearest",
"neighbor",
"search",
"ieee",
"trans",
"pami",
"33",
"1",
"117",
"128",
"january",
"2011",
"26",
"h",
"j",
"egou",
"r",
"tavenard",
"m",
"douze",
"and",
"l",
"amsaleg",
"searching",
"in",
"one",
"billion",
"vectors",
"re",
"rank",
"with",
"source",
"coding",
"in",
"international",
"conference",
"on",
"acoustics",
"speech",
"and",
"signal",
"processing",
"pages",
"861",
"864",
"may",
"2011",
"27",
"y",
"kalantidis",
"and",
"y",
"avrithis",
"locally",
"optimized",
"product",
"quantization",
"for",
"approximate",
"nearest",
"neighbor",
"search",
"in",
"proc",
"ieee",
"conference",
"on",
"computer",
"vision",
"and",
"pattern",
"recognition",
"pages",
"2329",
"2336",
"june",
"2014",
"28",
"a",
"krizhevsky",
"i",
"sutskever",
"and",
"g",
"e",
"hinton",
"imagenet",
"with",
"deep",
"convolutional",
"neural",
"networks",
"in",
"advances",
"in",
"neural",
"information",
"processing",
"systems",
"pages",
"1097",
"1105",
"2012",
"29",
"f",
"t",
"leighton",
"introduction",
"to",
"parallel",
"algorithms",
"and",
"architectures",
"array",
"trees",
"hypercubes",
"morgan",
"kaufmann",
"publishers",
"inc",
"san",
"francisco",
"ca",
"usa",
"1992",
"30",
"e",
"lindholm",
"j",
"nickolls",
"s",
"oberman",
"and",
"j",
"montrym",
"nvidia",
"tesla",
"a",
"graphics",
"and",
"computing",
"architecture",
"ieee",
"micro",
"28",
"2",
"39",
"55",
"march",
"2008",
"31",
"w",
"liu",
"and",
"b",
"vinter"
],
[
"morgan",
"kaufmann",
"publishers",
"inc",
"san",
"francisco",
"ca",
"usa",
"1992",
"30",
"e",
"lindholm",
"j",
"nickolls",
"s",
"oberman",
"and",
"j",
"montrym",
"nvidia",
"tesla",
"a",
"graphics",
"and",
"computing",
"architecture",
"ieee",
"micro",
"28",
"2",
"39",
"55",
"march",
"2008",
"31",
"w",
"liu",
"and",
"b",
"vinter",
"ad",
"heap",
"an",
"heap",
"data",
"structure",
"for",
"asymmetric",
"multicore",
"processors",
"in",
"proc",
"of",
"workshop",
"on",
"general",
"purpose",
"processing",
"using",
"gpus",
"pages",
"54",
"54",
"54",
"63",
"acm",
"2014",
"32",
"t",
"mikolov",
"i",
"sutskever",
"k",
"chen",
"g",
"s",
"corrado",
"and",
"j",
"dean",
"distributed",
"representations",
"of",
"words",
"and",
"phrases",
"and",
"their",
"compositionality",
"in",
"advances",
"in",
"neural",
"information",
"processing",
"systems",
"pages",
"3111",
"3119",
"2013",
"33",
"l",
"monroe",
"j",
"wendelberger",
"and",
"s",
"michalak",
"randomized",
"selection",
"on",
"the",
"gpu",
"in",
"proc",
"acm",
"symposium",
"on",
"high",
"performance",
"graphics",
"pages",
"89",
"98",
"2011",
"34",
"m",
"norouzi",
"and",
"d",
"fleet",
"cartesian",
"k",
"means",
"in",
"proc",
"ieee",
"conference",
"on",
"computer",
"vision",
"and",
"pattern",
"recognition",
"pages",
"3017",
"3024",
"june",
"2013",
"35",
"m",
"norouzi",
"a",
"punjani",
"and",
"d",
"j",
"fleet",
"fast",
"search",
"in",
"hamming",
"space",
"with",
"multi",
"index",
"hashing",
"in",
"proc",
"ieee",
"conference",
"on",
"computer",
"vision",
"and",
"pattern",
"recognition",
"pages",
"3108",
"3115",
"2012",
"36",
"j",
"pan",
"and",
"d",
"manocha",
"fast",
"gpu",
"based",
"locality",
"sensitive",
"hashing",
"for",
"k",
"nearest",
"neighbor",
"computation",
"in",
"proc",
"acm",
"international",
"conference",
"on",
"advances",
"in",
"geographic",
"information",
"systems",
"pages",
"211",
"220",
"2011",
"37",
"l",
"paulev",
"e",
"h",
"j",
"egou",
"and",
"l",
"amsaleg",
"locality",
"sensitive",
"hashing",
"a",
"comparison",
"of",
"hash",
"function",
"types",
"and",
"querying",
"mechanisms",
"pattern",
"recognition",
"letters",
"31",
"11",
"1348",
"1358",
"august",
"2010",
"38",
"o",
"shamir",
"fundamental",
"limits",
"of",
"online",
"and",
"distributed",
"algorithms",
"for",
"statistical",
"learning",
"and",
"estimation",
"in",
"advances",
"in",
"neural",
"information",
"processing",
"systems",
"pages",
"163",
"171",
"2014",
"39",
"a",
"sharif",
"razavian",
"h",
"azizpour",
"j",
"sullivan",
"and",
"s",
"carlsson",
"cnn",
"features",
"the",
"shelf",
"an",
"astounding",
"baseline",
"for",
"recognition",
"in",
"cvpr",
"workshops",
"pages",
"512",
"519",
"2014",
"40",
"n",
"sismanis",
"n",
"pitsianis",
"and",
"x",
"sun",
"parallel",
"search",
"of",
"k",
"nearest",
"neighbors",
"with",
"synchronous",
"operations",
"in",
"ieee",
"high",
"performance",
"extreme",
"computing",
"conference",
"pages",
"1",
"6",
"2012",
"41",
"x",
"tang",
"z",
"huang",
"d",
"m",
"eyers",
"s",
"mills",
"and",
"m",
"guo",
"selection",
"algorithm",
"for",
"fast",
"k",
"nn",
"search",
"on",
"gpus"
],
[
"sun",
"parallel",
"search",
"of",
"k",
"nearest",
"neighbors",
"with",
"synchronous",
"operations",
"in",
"ieee",
"high",
"performance",
"extreme",
"computing",
"conference",
"pages",
"1",
"6",
"2012",
"41",
"x",
"tang",
"z",
"huang",
"d",
"m",
"eyers",
"s",
"mills",
"and",
"m",
"guo",
"selection",
"algorithm",
"for",
"fast",
"k",
"nn",
"search",
"on",
"gpus",
"inieee",
"international",
"parallel",
"distributed",
"processing",
"symposium",
"pages",
"397",
"406",
"2015",
"42",
"b",
"thomee",
"d",
"a",
"shamma",
"g",
"friedland",
"b",
"elizalde",
"k",
"ni",
"d",
"poland",
"d",
"borth",
"and",
"l",
"j",
"li",
"yfcc100m",
"the",
"new",
"data",
"in",
"multimedia",
"research",
"communications",
"of",
"the",
"acm",
"59",
"2",
"64",
"73",
"january",
"2016",
"43",
"v",
"volkov",
"and",
"j",
"w",
"demmel",
"benchmarking",
"gpus",
"to",
"tune",
"dense",
"linear",
"algebra",
"in",
"proc",
"acm",
"ieee",
"conference",
"on",
"supercomputing",
"pages",
"31",
"1",
"31",
"11",
"2008",
"44",
"a",
"wakatani",
"and",
"a",
"murakami",
"gpgpu",
"implementation",
"of",
"nearest",
"neighbor",
"search",
"with",
"product",
"quantization",
"in",
"ieee",
"international",
"symposium",
"on",
"parallel",
"and",
"distributed",
"processing",
"with",
"applications",
"pages",
"248",
"253",
"2014",
"45",
"t",
"warashina",
"k",
"aoyama",
"h",
"sawada",
"and",
"t",
"hattori",
"k",
"nearest",
"neighbor",
"graph",
"construction",
"using",
"mapreduce",
"for",
"large",
"scale",
"data",
"sets",
"ieice",
"transactions",
"11"
],
[
"97",
"d",
"12",
"3142",
"3154",
"2014",
"46",
"r",
"weber",
"h",
"j",
"schek",
"and",
"s",
"blott",
"a",
"quantitative",
"analysis",
"and",
"performance",
"study",
"for",
"similarity",
"search",
"methods",
"in",
"high",
"dimensional",
"spaces",
"in",
"proc",
"international",
"conference",
"on",
"very",
"large",
"databases",
"pages",
"194",
"205",
"1998",
"47",
"p",
"wieschollek",
"o",
"wang",
"a",
"sorkine",
"hornung",
"and",
"h",
"p",
"a",
"lensch",
"large",
"scale",
"approximate",
"nearest",
"neighbor",
"search",
"on",
"the",
"gpu",
"in",
"proc",
"ieee",
"conference",
"on",
"computer",
"vision",
"and",
"pattern",
"recognition",
"pages",
"2027",
"2035",
"june",
"2016",
"48",
"s",
"williams",
"a",
"waterman",
"and",
"d",
"patterson",
"an",
"insightful",
"visual",
"performance",
"model",
"for",
"multicore",
"architectures",
"communications",
"of",
"the",
"acm",
"52",
"4",
"65",
"76",
"april",
"2009",
"appendix",
"complexity",
"analysis",
"of",
"warpselect",
"we",
"derive",
"the",
"average",
"number",
"of",
"times",
"updates",
"are",
"triggered",
"inwarpselect",
"for",
"use",
"in",
"section",
"4",
"3",
"let",
"the",
"input",
"to",
"k",
"selection",
"be",
"a",
"sequence",
"a1",
"a2",
"a",
"1",
"based",
"indexing",
"a",
"randomly",
"chosen",
"permutation",
"of",
"a",
"set",
"of",
"distinct",
"elements",
"elements",
"are",
"read",
"sequentially",
"in",
"c",
"groups",
"of",
"size",
"w",
"the",
"warp",
"in",
"our",
"case",
"w",
"32",
"assume",
"is",
"a",
"multiple",
"of",
"w",
"soc",
"w",
"recall",
"that",
"tis",
"the",
"thread",
"queue",
"length",
"we",
"call",
"elements",
"prior",
"to",
"or",
"at",
"position",
"n",
"in",
"the",
"min",
"kseen",
"so",
"far",
"the",
"successive",
"min",
"k",
"atn",
"the",
"likelihood",
"that",
"anis",
"in",
"the",
"successive",
"min",
"katnis",
"n",
"k",
"1",
"ifn",
"k",
"k",
"n",
"ifn",
"k",
"13",
"as",
"eachan",
"n",
"k",
"has",
"ak",
"nchance",
"as",
"all",
"permutations",
"are",
"equally",
"likely",
"and",
"all",
"elements",
"in",
"the",
"kqualify",
"counting",
"the",
"insertion",
"sorts",
"in",
"a",
"given",
"lane",
"an",
"inser",
"tion",
"sort",
"is",
"triggered",
"if",
"the",
"incoming",
"value",
"is",
"in",
"the",
"successive",
"min",
"k",
"tvalues",
"but",
"the",
"lane",
"has",
"seen",
"only",
"wc0",
"c",
"c0",
"values",
"where",
"c0is",
"the",
"previous",
"won",
"warp",
"ballot",
"the",
"prob",
"ability",
"of",
"this",
"happening",
"is",
"wc0",
"c",
"c0",
"k",
"t",
"k",
"t",
"wcforc",
"k",
"14",
"the",
"approximation",
"considers",
"that",
"the",
"thread",
"queue",
"has",
"seen",
"allthewcvalues",
"not",
"just",
"those",
"assigned",
"to",
"its",
"lane",
"the",
"probability",
"of",
"anylane",
"triggering",
"an",
"insertion",
"sort",
"is",
"then",
"1",
"1",
"k",
"t",
"wc",
"w",
"k",
"t",
"c",
"15",
"here",
"the",
"approximation",
"is",
"a",
"order",
"taylor",
"expansion",
"summing",
"up",
"the",
"probabilities",
"over",
"cgives",
"an",
"expected",
"num",
"ber",
"of",
"insertions",
"of",
"n2",
"k",
"t",
"log",
"c",
"o",
"klog",
"w",
"counting",
"full",
"sorts"
],
[
"15",
"here",
"the",
"approximation",
"is",
"a",
"order",
"taylor",
"expansion",
"summing",
"up",
"the",
"probabilities",
"over",
"cgives",
"an",
"expected",
"num",
"ber",
"of",
"insertions",
"of",
"n2",
"k",
"t",
"log",
"c",
"o",
"klog",
"w",
"counting",
"full",
"sorts",
"we",
"seekn3",
"k",
"t",
"w",
"the",
"ex",
"pected",
"number",
"of",
"full",
"sorts",
"required",
"for",
"warpselect",
"single",
"lane",
"for",
"now",
"we",
"assume",
"w",
"1",
"soc",
"let",
"m",
"k",
"be",
"the",
"probability",
"that",
"in",
"an",
"sequence",
"a1",
"a",
"exactlymof",
"the",
"elements",
"as",
"encountered",
"by",
"a",
"sequential",
"scanner",
"w",
"1",
"are",
"in",
"the",
"successive",
"min",
"k",
"givenm",
"there",
"are",
"m",
"places",
"where",
"these",
"successive",
"min",
"kelements",
"can",
"occur",
"it",
"is",
"given",
"by",
"a",
"recurrence",
"relation",
"m",
"k",
"1",
"0",
"andm",
"0",
"0",
"0",
"andm",
"0",
"0",
"0",
"andm",
"0",
"1",
"m",
"1",
"k",
"k",
"1",
"m",
"k",
"1",
"k",
"otherwise",
"16",
"the",
"last",
"case",
"is",
"the",
"probability",
"of",
"there",
"is",
"a",
"1",
"se",
"quence",
"with",
"m",
"1",
"successive",
"min",
"kelements",
"preceding",
"us",
"and",
"the",
"current",
"element",
"is",
"in",
"the",
"successive",
"min",
"k",
"or",
"the",
"current",
"element",
"is",
"not",
"in",
"the",
"successive",
"min",
"k",
"mones",
"are",
"before",
"us",
"we",
"can",
"then",
"develop",
"a",
"recurrence",
"relationship",
"for",
"k",
"t",
"1",
"note",
"that",
"b",
"k",
"t",
"min",
"bt",
"max",
"0",
"t",
"1",
"m",
"m",
"k",
"17",
"forbwhere",
"0",
"bt",
"the",
"fraction",
"of",
"all",
"sequences",
"of",
"will",
"force",
"bsorts",
"of",
"data",
"by",
"winning",
"the",
"thread",
"queue",
"ballot",
"as",
"there",
"have",
"to",
"be",
"btto",
"bt",
"max",
"0",
"t",
"1",
"elements",
"in",
"the",
"successive",
"min",
"kfor",
"these",
"sorts",
"to",
"happen",
"as",
"the",
"min",
"kelements",
"will",
"the",
"thread",
"queues",
"there",
"are",
"at",
"most",
"t",
"won",
"ballots",
"that",
"can",
"occur",
"as",
"it",
"takes",
"t",
"separate",
"sequential",
"current",
"min",
"kseen",
"elements",
"to",
"win",
"the",
"ballot",
"k",
"t",
"1",
"is",
"thus",
"the",
"expectation",
"of",
"this",
"over",
"all",
"possibleb",
"k",
"t",
"1",
"t",
"b",
"1b",
"b",
"k",
"t",
"18",
"this",
"can",
"be",
"computed",
"by",
"dynamic",
"programming",
"analyti",
"cally",
"note",
"that",
"for",
"t",
"1",
"k",
"1",
"1",
"1",
"1",
"is",
"the",
"harmonic",
"1",
"1",
"2",
"1",
"3",
"1",
"which",
"converges",
"to",
"ln",
"the",
"euler",
"mascheroni",
"constant",
"fort",
"1",
"k",
"1",
"k",
"k",
"1",
"1",
"k",
"k",
"hk",
"oro",
"klog",
"as",
"the",
"kelements",
"are",
"in",
"the",
"successive",
"min",
"k",
"and",
"the",
"expectation",
"for",
"the",
"rest",
"isk",
"k",
"1",
"k",
"k",
"2",
"k"
],
[
"fort",
"1",
"k",
"1",
"k",
"k",
"1",
"1",
"k",
"k",
"hk",
"oro",
"klog",
"as",
"the",
"kelements",
"are",
"in",
"the",
"successive",
"min",
"k",
"and",
"the",
"expectation",
"for",
"the",
"rest",
"isk",
"k",
"1",
"k",
"k",
"2",
"k",
"fort",
"1",
"k",
"1",
"k",
"note",
"that",
"there",
"are",
"some",
"number",
"d",
"k",
"d",
"successive",
"min",
"kdeterminations",
"dmade",
"for",
"each",
"possible",
"a1",
"a",
"the",
"number",
"of",
"won",
"ballots",
"for",
"each",
"case",
"is",
"by",
"d",
"t",
"as",
"the",
"thread",
"queue",
"must",
"upttimes",
"thus",
"k",
"t",
"1",
"o",
"klog",
"t",
"multiple",
"lanes",
"thew",
"1",
"case",
"is",
"complicated",
"by",
"the",
"fact",
"that",
"there",
"are",
"joint",
"probabilities",
"to",
"consider",
"if",
"more",
"than",
"one",
"of",
"the",
"wworkers",
"triggers",
"a",
"sort",
"for",
"a",
"given",
"group",
"only",
"one",
"sort",
"takes",
"place",
"however",
"the",
"likelihood",
"can",
"be",
"bounded",
"let",
"k",
"t",
"w",
"be",
"the",
"expected",
"won",
"ballots",
"as",
"suming",
"no",
"mutual",
"interference",
"between",
"the",
"wworkers",
"for",
"winning",
"ballots",
"i",
"e",
"we",
"win",
"bballots",
"if",
"there",
"are",
"b",
"w",
"workers",
"that",
"independently",
"win",
"a",
"ballot",
"at",
"a",
"single",
"step",
"but",
"with",
"the",
"shared",
"min",
"kset",
"after",
"each",
"sort",
"from",
"the",
"joint",
"sequence",
"assume",
"that",
"k",
"w",
"then",
"k",
"1",
"w",
"w",
"k",
"w",
"w",
"k",
"w",
"i",
"1k",
"w",
"k",
"w",
"i",
"w",
"k",
"1",
"1",
"o",
"wklog",
"w",
"19",
"where",
"the",
"likelihood",
"of",
"the",
"wworkers",
"seeing",
"a",
"successive",
"min",
"kelement",
"has",
"an",
"upper",
"bound",
"of",
"that",
"of",
"the",
"worker",
"at",
"each",
"step",
"as",
"before",
"the",
"number",
"of",
"won",
"ballots",
"is",
"scaled",
"byt",
"k",
"t",
"w",
"o",
"wklog",
"w",
"t",
"mutual",
"interfer",
"ence",
"can",
"only",
"reduce",
"the",
"number",
"of",
"ballots",
"so",
"we",
"obtain",
"the",
"same",
"upper",
"bound",
"for",
"k",
"t",
"w",
"12"
],
[
"dense",
"passage",
"retrieval",
"for",
"open",
"domain",
"question",
"answering",
"vladimir",
"karpukhin",
"barlas",
"o",
"guz",
"sewon",
"min",
"patrick",
"lewis",
"ledell",
"wu",
"sergey",
"edunov",
"danqi",
"chen",
"wen",
"tau",
"yih",
"facebook",
"ai",
"university",
"of",
"washington",
"princeton",
"university",
"vladk",
"barlaso",
"plewis",
"ledell",
"edunov",
"scottyih",
"fb",
"com",
"sewon",
"cs",
"washington",
"edu",
"danqic",
"cs",
"princeton",
"edu",
"abstract",
"open",
"domain",
"question",
"answering",
"relies",
"on",
"ef",
"passage",
"retrieval",
"to",
"select",
"candidate",
"contexts",
"where",
"traditional",
"sparse",
"vector",
"space",
"models",
"such",
"as",
"tf",
"idf",
"or",
"bm25",
"are",
"the",
"de",
"facto",
"method",
"in",
"this",
"work",
"we",
"show",
"that",
"retrieval",
"can",
"be",
"practically",
"implemented",
"us",
"ingdense",
"representations",
"alone",
"where",
"em",
"beddings",
"are",
"learned",
"from",
"a",
"small",
"number",
"of",
"questions",
"and",
"passages",
"by",
"a",
"simple",
"dual",
"encoder",
"framework",
"when",
"evaluated",
"on",
"a",
"wide",
"range",
"of",
"open",
"domain",
"qa",
"datasets",
"our",
"dense",
"retriever",
"outperforms",
"a",
"strong",
"lucene",
"bm25",
"system",
"greatly",
"by",
"9",
"19",
"absolute",
"in",
"terms",
"of",
"top",
"20",
"passage",
"retrieval",
"accuracy",
"and",
"helps",
"our",
"end",
"to",
"end",
"qa",
"system",
"establish",
"new",
"state",
"of",
"the",
"art",
"on",
"multiple",
"open",
"domain",
"qa",
"benchmarks",
"1",
"1",
"introduction",
"open",
"domain",
"question",
"answering",
"qa",
"v",
"oorhees",
"1999",
"is",
"a",
"task",
"that",
"answers",
"factoid",
"questions",
"us",
"ing",
"a",
"large",
"collection",
"of",
"documents",
"while",
"early",
"qa",
"systems",
"are",
"often",
"complicated",
"and",
"consist",
"of",
"multiple",
"components",
"ferrucci",
"2012",
"moldovan",
"et",
"al",
"2003",
"inter",
"alia",
"the",
"advances",
"of",
"reading",
"comprehension",
"models",
"suggest",
"a",
"much",
"two",
"stage",
"framework",
"1",
"a",
"context",
"retriever",
"selects",
"a",
"small",
"subset",
"of",
"passages",
"where",
"some",
"of",
"them",
"contain",
"the",
"answer",
"to",
"the",
"question",
"and",
"then",
"2",
"a",
"machine",
"reader",
"can",
"thoroughly",
"exam",
"ine",
"the",
"retrieved",
"contexts",
"and",
"identify",
"the",
"correct",
"answer",
"chen",
"et",
"al",
"2017",
"although",
"reducing",
"open",
"domain",
"qa",
"to",
"machine",
"reading",
"is",
"a",
"very",
"rea",
"sonable",
"strategy",
"a",
"huge",
"performance",
"degradation",
"is",
"often",
"observed",
"in",
"practice2",
"indicating",
"the",
"needs",
"of",
"improving",
"retrieval",
"equal",
"contribution",
"1the",
"code",
"and",
"trained",
"models",
"have",
"been",
"released",
"at",
"https",
"github",
"com",
"facebookresearch",
"dpr"
],
[
"equal",
"contribution",
"1the",
"code",
"and",
"trained",
"models",
"have",
"been",
"released",
"at",
"https",
"github",
"com",
"facebookresearch",
"dpr",
"2for",
"instance",
"the",
"exact",
"match",
"score",
"on",
"squad",
"v1",
"1",
"drops",
"from",
"above",
"80",
"to",
"less",
"than",
"40",
"yang",
"et",
"al",
"2019a",
"retrieval",
"in",
"open",
"domain",
"qa",
"is",
"usually",
"imple",
"mented",
"using",
"tf",
"idf",
"or",
"bm25",
"robertson",
"and",
"zaragoza",
"2009",
"which",
"matches",
"keywords",
"ciently",
"with",
"an",
"inverted",
"index",
"and",
"can",
"be",
"seen",
"as",
"representing",
"the",
"question",
"and",
"context",
"in",
"high",
"dimensional",
"sparse",
"vectors",
"with",
"weighting",
"con",
"versely",
"the",
"dense",
"latent",
"semantic",
"encoding",
"is",
"com",
"plementary",
"to",
"sparse",
"representations",
"by",
"design",
"for",
"example",
"synonyms",
"or",
"paraphrases",
"that",
"consist",
"of",
"completely",
"different",
"tokens",
"may",
"still",
"be",
"mapped",
"to",
"vectors",
"close",
"to",
"each",
"other",
"consider",
"the",
"question",
"who",
"is",
"the",
"bad",
"guy",
"in",
"lord",
"of",
"the",
"rings",
"which",
"can",
"be",
"answered",
"from",
"the",
"context",
"sala",
"baker",
"is",
"best",
"known",
"for",
"portraying",
"the",
"villain",
"sauron",
"in",
"the",
"lord",
"of",
"the",
"rings",
"trilogy",
"a",
"term",
"based",
"system",
"would",
"have",
"retrieving",
"such",
"a",
"context",
"while",
"a",
"dense",
"retrieval",
"system",
"would",
"be",
"able",
"to",
"better",
"match",
"bad",
"guy",
"with",
"villain",
"and",
"fetch",
"the",
"cor",
"rect",
"context",
"dense",
"encodings",
"are",
"also",
"learnable",
"by",
"adjusting",
"the",
"embedding",
"functions",
"which",
"pro",
"vides",
"additional",
"to",
"have",
"a",
"task",
"representation",
"with",
"special",
"in",
"memory",
"data",
"struc",
"tures",
"and",
"indexing",
"schemes",
"retrieval",
"can",
"be",
"done",
"using",
"maximum",
"inner",
"product",
"search",
"mips",
"algorithms",
"e",
"g",
"shrivastava",
"and",
"li",
"2014",
"guo",
"et",
"al",
"2016",
"however",
"it",
"is",
"generally",
"believed",
"that",
"learn",
"ing",
"a",
"good",
"dense",
"vector",
"representation",
"needs",
"a",
"large",
"number",
"of",
"labeled",
"pairs",
"of",
"question",
"and",
"con",
"texts",
"dense",
"retrieval",
"methods",
"have",
"thus",
"never",
"be",
"shown",
"to",
"outperform",
"tf",
"idf",
"bm25",
"for",
"open",
"domain",
"qa",
"before",
"orqa",
"lee",
"et",
"al",
"2019",
"which",
"proposes",
"a",
"sophisticated",
"inverse",
"cloze",
"task",
"ict",
"objective",
"predicting",
"the",
"blocks",
"that",
"contain",
"the",
"masked",
"sentence",
"for",
"additional",
"pretraining",
"the",
"question",
"encoder",
"and",
"the",
"reader",
"model",
"are",
"then",
"tuned",
"using",
"pairs",
"of",
"questions",
"and",
"answers",
"jointly"
],
[
"the",
"question",
"encoder",
"and",
"the",
"reader",
"model",
"are",
"then",
"tuned",
"using",
"pairs",
"of",
"questions",
"and",
"answers",
"jointly",
"although",
"orqa",
"successfully",
"demonstrates",
"that",
"dense",
"retrieval",
"can",
"outperform",
"bm25",
"setting",
"new",
"state",
"of",
"the",
"art",
"results",
"on",
"multiple",
"open",
"domainarxiv",
"2004",
"04906v3",
"cs",
"cl",
"30",
"sep",
"2020"
],
[
"qa",
"datasets",
"it",
"also",
"suffers",
"from",
"two",
"weaknesses",
"first",
"ict",
"pretraining",
"is",
"computationally",
"intensive",
"and",
"it",
"is",
"not",
"completely",
"clear",
"that",
"regular",
"sentences",
"are",
"good",
"surrogates",
"of",
"questions",
"in",
"the",
"objective",
"function",
"second",
"because",
"the",
"context",
"encoder",
"is",
"not",
"tuned",
"using",
"pairs",
"of",
"questions",
"and",
"answers",
"the",
"corresponding",
"representations",
"could",
"be",
"subop",
"timal",
"in",
"this",
"paper",
"we",
"address",
"the",
"question",
"can",
"we",
"train",
"a",
"better",
"dense",
"embedding",
"model",
"using",
"only",
"pairs",
"of",
"questions",
"and",
"passages",
"or",
"answers",
"with",
"outadditional",
"pretraining",
"by",
"leveraging",
"the",
"now",
"standard",
"bert",
"pretrained",
"model",
"devlin",
"et",
"al",
"2019",
"and",
"a",
"dual",
"encoder",
"architecture",
"bromley",
"et",
"al",
"1994",
"we",
"focus",
"on",
"developing",
"the",
"right",
"training",
"scheme",
"using",
"a",
"relatively",
"small",
"number",
"of",
"question",
"and",
"passage",
"pairs",
"through",
"a",
"series",
"of",
"careful",
"ablation",
"studies",
"our",
"solution",
"is",
"surprisingly",
"simple",
"the",
"embedding",
"is",
"optimized",
"for",
"maximizing",
"inner",
"products",
"of",
"the",
"question",
"and",
"relevant",
"passage",
"vectors",
"with",
"an",
"objective",
"compar",
"ing",
"all",
"pairs",
"of",
"questions",
"and",
"passages",
"in",
"a",
"batch",
"ourdense",
"passage",
"retriever",
"dpr",
"is",
"exception",
"ally",
"strong",
"it",
"not",
"only",
"outperforms",
"bm25",
"by",
"a",
"large",
"margin",
"65",
"2",
"vs",
"42",
"9",
"in",
"top",
"5",
"accuracy",
"but",
"also",
"results",
"in",
"a",
"substantial",
"improvement",
"on",
"the",
"end",
"to",
"end",
"qa",
"accuracy",
"compared",
"to",
"orqa",
"41",
"5",
"vs",
"33",
"3",
"in",
"the",
"open",
"natural",
"questions",
"setting",
"lee",
"et",
"al",
"2019",
"kwiatkowski",
"et",
"al",
"2019",
"our",
"contributions",
"are",
"twofold",
"first",
"we",
"demon",
"strate",
"that",
"with",
"the",
"proper",
"training",
"setup",
"sim",
"ply",
"tuning",
"the",
"question",
"and",
"passage",
"encoders",
"on",
"existing",
"question",
"passage",
"pairs",
"is",
"to",
"greatly",
"outperform",
"bm25",
"our",
"empirical",
"results",
"also",
"suggest",
"that",
"additional",
"pretraining",
"may",
"not",
"be",
"needed",
"second",
"we",
"verify",
"that",
"in",
"the",
"context",
"of",
"open",
"domain",
"question",
"answering",
"a",
"higher",
"retrieval",
"precision",
"indeed",
"translates",
"to",
"a",
"higher",
"end",
"to",
"end",
"qa",
"accuracy",
"by",
"applying",
"a",
"modern",
"reader",
"model",
"to",
"the",
"top",
"retrieved",
"passages",
"we",
"achieve",
"compara",
"ble",
"or",
"better",
"results",
"on",
"multiple",
"qa",
"datasets",
"in",
"the",
"open",
"retrieval",
"setting",
"compared",
"to",
"several",
"much",
"complicated",
"systems"
],
[
"by",
"applying",
"a",
"modern",
"reader",
"model",
"to",
"the",
"top",
"retrieved",
"passages",
"we",
"achieve",
"compara",
"ble",
"or",
"better",
"results",
"on",
"multiple",
"qa",
"datasets",
"in",
"the",
"open",
"retrieval",
"setting",
"compared",
"to",
"several",
"much",
"complicated",
"systems",
"2",
"background",
"the",
"problem",
"of",
"open",
"domain",
"qa",
"studied",
"in",
"this",
"paper",
"can",
"be",
"described",
"as",
"follows",
"given",
"a",
"factoid",
"question",
"such",
"as",
"who",
"voiced",
"meg",
"on",
"family",
"guy",
"or",
"where",
"was",
"the",
"8th",
"dalai",
"lama",
"born",
"a",
"system",
"is",
"required",
"to",
"answer",
"it",
"using",
"a",
"large",
"corpus",
"of",
"topics",
"more",
"we",
"assumethe",
"extractive",
"qa",
"setting",
"in",
"which",
"the",
"answer",
"is",
"restricted",
"to",
"a",
"span",
"appearing",
"in",
"one",
"or",
"more",
"pas",
"sages",
"in",
"the",
"corpus",
"assume",
"that",
"our",
"collection",
"containsddocuments",
"d1",
"d2",
"dd",
"we",
"split",
"each",
"of",
"the",
"documents",
"into",
"text",
"passages",
"of",
"equal",
"lengths",
"as",
"the",
"basic",
"retrieval",
"units3and",
"getm",
"total",
"passages",
"in",
"our",
"corpus",
"c",
"p1",
"p2",
"p",
"m",
"where",
"each",
"passage",
"pican",
"be",
"viewed",
"as",
"a",
"sequence",
"of",
"tokensw",
"i",
"1",
"w",
"i",
"2",
"w",
"i",
"pi",
"given",
"a",
"question",
"q",
"the",
"task",
"is",
"to",
"a",
"span",
"w",
"i",
"s",
"w",
"i",
"s",
"1",
"w",
"i",
"efrom",
"one",
"of",
"the",
"passages",
"pithat",
"can",
"answer",
"the",
"question",
"notice",
"that",
"to",
"cover",
"a",
"wide",
"variety",
"of",
"domains",
"the",
"corpus",
"size",
"can",
"easily",
"range",
"from",
"millions",
"of",
"docu",
"ments",
"e",
"g",
"wikipedia",
"to",
"billions",
"e",
"g",
"the",
"web",
"as",
"a",
"result",
"any",
"open",
"domain",
"qa",
"system",
"needs",
"to",
"include",
"an",
"retriever",
"component",
"that",
"can",
"se",
"lect",
"a",
"small",
"set",
"of",
"relevant",
"texts",
"before",
"applying",
"the",
"reader",
"to",
"extract",
"the",
"answer",
"chen",
"et",
"al",
"2017",
"4",
"formally",
"speaking",
"a",
"retriever",
"r",
"q",
"c",
"cf",
"is",
"a",
"function",
"that",
"takes",
"as",
"input",
"a",
"question",
"qand",
"a",
"corpuscand",
"returns",
"a",
"much",
"smaller",
"set",
"of",
"textscf",
"c",
"where",
"cf",
"k",
"c",
"for",
"a",
"k",
"aretriever",
"can",
"be",
"evaluated",
"in",
"isolation",
"on",
"top",
"k",
"retrieval",
"accuracy",
"which",
"is",
"the",
"fraction",
"of",
"ques",
"tions",
"for",
"whichcfcontains",
"a",
"span",
"that",
"answers",
"the",
"question",
"3",
"dense",
"passage",
"retriever",
"dpr",
"we",
"focus",
"our",
"research",
"in",
"this",
"work",
"on",
"improv",
"ing",
"the",
"retrieval",
"component",
"in",
"open",
"domain",
"qa"
],
[
"3",
"dense",
"passage",
"retriever",
"dpr",
"we",
"focus",
"our",
"research",
"in",
"this",
"work",
"on",
"improv",
"ing",
"the",
"retrieval",
"component",
"in",
"open",
"domain",
"qa",
"given",
"a",
"collection",
"of",
"mtext",
"passages",
"the",
"goal",
"of",
"our",
"dense",
"passage",
"retriever",
"dpr",
"is",
"to",
"index",
"all",
"the",
"passages",
"in",
"a",
"low",
"dimensional",
"and",
"continuous",
"space",
"such",
"that",
"it",
"can",
"retrieve",
"the",
"top",
"kpassages",
"relevant",
"to",
"the",
"input",
"question",
"for",
"the",
"reader",
"at",
"run",
"time",
"note",
"that",
"mcan",
"be",
"very",
"large",
"e",
"g",
"21",
"million",
"passages",
"in",
"our",
"experiments",
"de",
"scribed",
"in",
"section",
"4",
"1",
"and",
"kis",
"usually",
"small",
"such",
"as20",
"100",
"3",
"1",
"overview",
"our",
"dense",
"passage",
"retriever",
"dpr",
"uses",
"a",
"dense",
"encoderep",
"which",
"maps",
"any",
"text",
"passage",
"to",
"a",
"d",
"dimensional",
"real",
"valued",
"vectors",
"and",
"builds",
"an",
"index",
"for",
"all",
"thempassages",
"that",
"we",
"will",
"use",
"for",
"retrieval",
"3the",
"ideal",
"size",
"and",
"boundary",
"of",
"a",
"text",
"passage",
"are",
"func",
"tions",
"of",
"both",
"the",
"retriever",
"and",
"reader",
"we",
"also",
"experimented",
"with",
"natural",
"paragraphs",
"in",
"our",
"preliminary",
"trials",
"and",
"found",
"that",
"using",
"length",
"passages",
"performs",
"better",
"in",
"both",
"retrieval",
"and",
"qa",
"accuracy",
"as",
"observed",
"by",
"wang",
"et",
"al",
"2019",
"4exceptions",
"include",
"seo",
"et",
"al",
"2019",
"and",
"roberts",
"et",
"al",
"2020",
"which",
"retrieves",
"andgenerates",
"the",
"answers",
"respectively"
],
[
"at",
"run",
"time",
"dpr",
"applies",
"a",
"different",
"encoder",
"eq",
"that",
"maps",
"the",
"input",
"question",
"to",
"a",
"d",
"dimensional",
"vector",
"and",
"retrieves",
"kpassages",
"of",
"which",
"vectors",
"are",
"the",
"closest",
"to",
"the",
"question",
"vector",
"we",
"the",
"similarity",
"between",
"the",
"question",
"and",
"the",
"passage",
"using",
"the",
"dot",
"product",
"of",
"their",
"vectors",
"sim",
"q",
"p",
"eq",
"q",
"ep",
"p",
"1",
"although",
"more",
"expressive",
"model",
"forms",
"for",
"measur",
"ing",
"the",
"similarity",
"between",
"a",
"question",
"and",
"a",
"passage",
"do",
"exist",
"such",
"as",
"networks",
"consisting",
"of",
"multiple",
"layers",
"of",
"cross",
"attentions",
"the",
"similarity",
"function",
"needs",
"to",
"be",
"decomposable",
"so",
"that",
"the",
"represen",
"tations",
"of",
"the",
"collection",
"of",
"passages",
"can",
"be",
"pre",
"computed",
"most",
"decomposable",
"similarity",
"functions",
"are",
"some",
"transformations",
"of",
"euclidean",
"distance",
"l2",
"for",
"instance",
"cosine",
"is",
"equivalent",
"to",
"inner",
"product",
"for",
"unit",
"vectors",
"and",
"the",
"mahalanobis",
"dis",
"tance",
"is",
"equivalent",
"to",
"l2",
"distance",
"in",
"a",
"transformed",
"space",
"inner",
"product",
"search",
"has",
"been",
"widely",
"used",
"and",
"studied",
"as",
"well",
"as",
"its",
"connection",
"to",
"cosine",
"similarity",
"and",
"l2",
"distance",
"mussmann",
"and",
"ermon",
"2016",
"ram",
"and",
"gray",
"2012",
"as",
"our",
"ablation",
"study",
"other",
"similarity",
"functions",
"perform",
"compara",
"bly",
"section",
"5",
"2",
"appendix",
"b",
"we",
"thus",
"choose",
"the",
"simpler",
"inner",
"product",
"function",
"and",
"improve",
"the",
"dense",
"passage",
"retriever",
"by",
"learning",
"better",
"encoders",
"encoders",
"although",
"in",
"principle",
"the",
"question",
"and",
"passage",
"encoders",
"can",
"be",
"implemented",
"by",
"any",
"neu",
"ral",
"networks",
"in",
"this",
"work",
"we",
"use",
"two",
"independent",
"bert",
"devlin",
"et",
"al",
"2019",
"networks",
"base",
"un",
"cased",
"and",
"take",
"the",
"representation",
"at",
"the",
"cls",
"token",
"as",
"the",
"output",
"so",
"d",
"768",
"inference",
"during",
"inference",
"time",
"we",
"apply",
"the",
"passage",
"encoder",
"epto",
"all",
"the",
"passages",
"and",
"index",
"them",
"using",
"faiss",
"johnson",
"et",
"al",
"2017",
"faiss",
"is",
"an",
"extremely",
"open",
"source",
"li",
"brary",
"for",
"similarity",
"search",
"and",
"clustering",
"of",
"dense",
"vectors",
"which",
"can",
"easily",
"be",
"applied",
"to",
"billions",
"of",
"vectors",
"given",
"a",
"question",
"qat",
"run",
"time",
"we",
"derive",
"its",
"embedding",
"vq",
"eq",
"q",
"and",
"retrieve",
"the",
"top",
"k",
"passages",
"with",
"embeddings",
"closest",
"to",
"vq",
"3",
"2",
"training",
"training",
"the",
"encoders",
"so",
"that",
"the",
"dot",
"product",
"sim",
"ilarity",
"eq"
],
[
"given",
"a",
"question",
"qat",
"run",
"time",
"we",
"derive",
"its",
"embedding",
"vq",
"eq",
"q",
"and",
"retrieve",
"the",
"top",
"k",
"passages",
"with",
"embeddings",
"closest",
"to",
"vq",
"3",
"2",
"training",
"training",
"the",
"encoders",
"so",
"that",
"the",
"dot",
"product",
"sim",
"ilarity",
"eq",
"1",
"becomes",
"a",
"good",
"ranking",
"function",
"for",
"retrieval",
"is",
"essentially",
"a",
"metric",
"learning",
"prob",
"lem",
"kulis",
"2013",
"the",
"goal",
"is",
"to",
"create",
"a",
"vector",
"space",
"such",
"that",
"relevant",
"pairs",
"of",
"questions",
"and",
"pas",
"sages",
"will",
"have",
"smaller",
"distance",
"i",
"e",
"higher",
"simi",
"larity",
"than",
"the",
"irrelevant",
"ones",
"by",
"learning",
"a",
"better",
"embedding",
"function",
"letd",
"qi",
"p",
"i",
"p",
"i",
"1",
"p",
"i",
"n",
"m",
"i",
"1be",
"the",
"training",
"data",
"that",
"consists",
"of",
"minstances",
"each",
"instance",
"contains",
"one",
"question",
"qiand",
"one",
"relevant",
"positive",
"passage",
"p",
"i",
"along",
"with",
"nirrelevant",
"neg",
"ative",
"passages",
"p",
"i",
"j",
"we",
"optimize",
"the",
"loss",
"function",
"as",
"the",
"negative",
"log",
"likelihood",
"of",
"the",
"positive",
"pas",
"sage",
"l",
"qi",
"p",
"i",
"p",
"i",
"1",
"p",
"i",
"n",
"2",
"logesim",
"qi",
"p",
"i",
"esim",
"qi",
"p",
"i",
"n",
"j",
"1esim",
"qi",
"p",
"i",
"j",
"positive",
"and",
"negative",
"passages",
"for",
"retrieval",
"problems",
"it",
"is",
"often",
"the",
"case",
"that",
"positive",
"examples",
"are",
"available",
"explicitly",
"while",
"negative",
"examples",
"need",
"to",
"be",
"selected",
"from",
"an",
"extremely",
"large",
"pool",
"for",
"instance",
"passages",
"relevant",
"to",
"a",
"question",
"may",
"be",
"given",
"in",
"a",
"qa",
"dataset",
"or",
"can",
"be",
"found",
"using",
"the",
"answer",
"all",
"other",
"passages",
"in",
"the",
"collection",
"while",
"not",
"explicitly",
"can",
"be",
"viewed",
"as",
"irrelevant",
"by",
"default",
"in",
"practice",
"how",
"to",
"select",
"negative",
"ex",
"amples",
"is",
"often",
"overlooked",
"but",
"could",
"be",
"decisive",
"for",
"learning",
"a",
"high",
"quality",
"encoder",
"we",
"consider",
"three",
"different",
"types",
"of",
"negatives",
"1",
"random",
"any",
"random",
"passage",
"from",
"the",
"corpus",
"2",
"bm25",
"top",
"passages",
"returned",
"by",
"bm25",
"which",
"don",
"t",
"contain",
"the",
"answer",
"but",
"match",
"most",
"question",
"tokens",
"3",
"gold",
"positive",
"passages",
"paired",
"with",
"other",
"questions",
"which",
"appear",
"in",
"the",
"training",
"set",
"we",
"will",
"discuss",
"the",
"impact",
"of",
"different",
"types",
"of",
"negative",
"passages",
"and",
"training",
"schemes",
"in",
"section",
"5",
"2",
"our",
"best",
"model",
"uses",
"gold",
"passages",
"from",
"the",
"same",
"mini",
"batch",
"and",
"one",
"bm25",
"negative",
"passage"
],
[
"we",
"will",
"discuss",
"the",
"impact",
"of",
"different",
"types",
"of",
"negative",
"passages",
"and",
"training",
"schemes",
"in",
"section",
"5",
"2",
"our",
"best",
"model",
"uses",
"gold",
"passages",
"from",
"the",
"same",
"mini",
"batch",
"and",
"one",
"bm25",
"negative",
"passage",
"in",
"particular",
"re",
"using",
"gold",
"passages",
"from",
"the",
"same",
"batch",
"as",
"negatives",
"can",
"make",
"the",
"computation",
"while",
"achiev",
"ing",
"great",
"performance",
"we",
"discuss",
"this",
"approach",
"below",
"in",
"batch",
"negatives",
"assume",
"that",
"we",
"have",
"b",
"questions",
"in",
"a",
"mini",
"batch",
"and",
"each",
"one",
"is",
"asso",
"ciated",
"with",
"a",
"relevant",
"passage",
"let",
"qandpbe",
"the",
"b",
"d",
"matrix",
"of",
"question",
"and",
"passage",
"embeddings",
"in",
"a",
"batch",
"of",
"size",
"b",
"s",
"qptis",
"a",
"b",
"b",
"ma",
"trix",
"of",
"similarity",
"scores",
"where",
"each",
"row",
"of",
"which",
"corresponds",
"to",
"a",
"question",
"paired",
"with",
"bpassages",
"in",
"this",
"way",
"we",
"reuse",
"computation",
"and",
"effectively",
"train",
"onb2",
"qi",
"pj",
"question",
"passage",
"pairs",
"in",
"each",
"batch",
"any",
"qi",
"pj",
"pair",
"is",
"a",
"positive",
"example",
"when",
"i",
"j",
"and",
"negative",
"otherwise",
"this",
"creates",
"btrain",
"ing",
"instances",
"in",
"each",
"batch",
"where",
"there",
"are",
"b",
"1"
],
[
"negative",
"passages",
"for",
"each",
"question",
"the",
"trick",
"of",
"in",
"batch",
"negatives",
"has",
"been",
"used",
"in",
"the",
"full",
"batch",
"setting",
"yih",
"et",
"al",
"2011",
"and",
"more",
"recently",
"for",
"mini",
"batch",
"henderson",
"et",
"al",
"2017",
"gillick",
"et",
"al",
"2019",
"it",
"has",
"been",
"shown",
"to",
"be",
"an",
"effective",
"strategy",
"for",
"learning",
"a",
"dual",
"encoder",
"model",
"that",
"boosts",
"the",
"number",
"of",
"training",
"examples",
"4",
"experimental",
"setup",
"in",
"this",
"section",
"we",
"describe",
"the",
"data",
"we",
"used",
"for",
"experiments",
"and",
"the",
"basic",
"setup",
"4",
"1",
"wikipedia",
"data",
"pre",
"processing",
"following",
"lee",
"et",
"al",
"2019",
"we",
"use",
"the",
"english",
"wikipedia",
"dump",
"from",
"dec",
"20",
"2018",
"as",
"the",
"source",
"documents",
"for",
"answering",
"questions",
"we",
"apply",
"the",
"pre",
"processing",
"code",
"released",
"in",
"drqa",
"chen",
"et",
"al",
"2017",
"to",
"extract",
"the",
"clean",
"text",
"portion",
"of",
"articles",
"from",
"the",
"wikipedia",
"dump",
"this",
"step",
"re",
"moves",
"semi",
"structured",
"data",
"such",
"as",
"tables",
"info",
"boxes",
"lists",
"as",
"well",
"as",
"the",
"disambiguation",
"pages",
"we",
"then",
"split",
"each",
"article",
"into",
"multiple",
"disjoint",
"text",
"blocks",
"of",
"100",
"words",
"as",
"passages",
"serving",
"as",
"our",
"basic",
"retrieval",
"units",
"following",
"wang",
"et",
"al",
"2019",
"which",
"results",
"in",
"21",
"015",
"324",
"passages",
"in",
"the",
"end",
"5",
"each",
"passage",
"is",
"also",
"prepended",
"with",
"the",
"title",
"of",
"the",
"wikipedia",
"article",
"where",
"the",
"passage",
"is",
"from",
"along",
"with",
"an",
"sep",
"token",
"4",
"2",
"question",
"answering",
"datasets",
"we",
"use",
"the",
"same",
"qa",
"datasets",
"and",
"train",
"ing",
"dev",
"testing",
"splitting",
"method",
"as",
"in",
"previous",
"work",
"lee",
"et",
"al",
"2019",
"below",
"we",
"describe",
"each",
"dataset",
"and",
"refer",
"readers",
"to",
"their",
"paper",
"for",
"the",
"details",
"of",
"data",
"preparation",
"natural",
"questions",
"nq",
"kwiatkowski",
"et",
"al",
"2019",
"was",
"designed",
"for",
"end",
"to",
"end",
"question",
"an",
"swering",
"the",
"questions",
"were",
"mined",
"from",
"real",
"google",
"search",
"queries",
"and",
"the",
"answers",
"were",
"spans",
"in",
"wikipedia",
"articles",
"by",
"annotators",
"triviaqa",
"joshi",
"et",
"al",
"2017",
"contains",
"a",
"set",
"of",
"trivia",
"questions",
"with",
"answers",
"that",
"were",
"originally",
"scraped",
"from",
"the",
"web",
"webquestions",
"wq",
"berant",
"et",
"al",
"2013",
"consists",
"of",
"questions",
"selected",
"using",
"google",
"suggest",
"api",
"where",
"the",
"answers",
"are",
"entities",
"in",
"freebase",
"curatedtrec",
"trec",
"baudi",
"and",
"y",
"2015",
"sources",
"questions",
"from",
"trec",
"qa",
"tracks",
"5however",
"wang",
"et",
"al"
],
[
"webquestions",
"wq",
"berant",
"et",
"al",
"2013",
"consists",
"of",
"questions",
"selected",
"using",
"google",
"suggest",
"api",
"where",
"the",
"answers",
"are",
"entities",
"in",
"freebase",
"curatedtrec",
"trec",
"baudi",
"and",
"y",
"2015",
"sources",
"questions",
"from",
"trec",
"qa",
"tracks",
"5however",
"wang",
"et",
"al",
"2019",
"also",
"propose",
"splitting",
"docu",
"ments",
"into",
"overlapping",
"passages",
"which",
"we",
"do",
"not",
"advan",
"tageous",
"compared",
"to",
"the",
"non",
"overlapping",
"version",
"dataset",
"train",
"dev",
"test",
"natural",
"questions",
"79",
"168",
"58",
"880",
"8",
"757",
"3",
"610",
"triviaqa",
"78",
"785",
"60",
"413",
"8",
"837",
"11",
"313",
"webquestions",
"3",
"417",
"2",
"474",
"361",
"2",
"032",
"curatedtrec",
"1",
"353",
"1",
"125",
"133",
"694",
"squad",
"78",
"713",
"70",
"096",
"8",
"886",
"10",
"570",
"table",
"1",
"number",
"of",
"questions",
"in",
"each",
"qa",
"dataset",
"the",
"two",
"columns",
"of",
"train",
"denote",
"the",
"original",
"training",
"ex",
"amples",
"in",
"the",
"dataset",
"and",
"the",
"actual",
"questions",
"used",
"for",
"training",
"dpr",
"after",
"see",
"text",
"for",
"more",
"details",
"as",
"well",
"as",
"various",
"web",
"sources",
"and",
"is",
"intended",
"for",
"open",
"domain",
"qa",
"from",
"unstructured",
"corpora",
"squad",
"v1",
"1",
"rajpurkar",
"et",
"al",
"2016",
"is",
"a",
"popu",
"lar",
"benchmark",
"dataset",
"for",
"reading",
"comprehension",
"annotators",
"were",
"presented",
"with",
"a",
"wikipedia",
"para",
"graph",
"and",
"asked",
"to",
"write",
"questions",
"that",
"could",
"be",
"answered",
"from",
"the",
"given",
"text",
"although",
"squad",
"has",
"been",
"used",
"previously",
"for",
"open",
"domain",
"qa",
"re",
"search",
"it",
"is",
"not",
"ideal",
"because",
"many",
"questions",
"lack",
"context",
"in",
"absence",
"of",
"the",
"provided",
"paragraph",
"we",
"still",
"include",
"it",
"in",
"our",
"experiments",
"for",
"providing",
"a",
"fair",
"comparison",
"to",
"previous",
"work",
"and",
"we",
"will",
"discuss",
"more",
"in",
"section",
"5",
"1",
"selection",
"of",
"positive",
"passages",
"because",
"only",
"pairs",
"of",
"questions",
"and",
"answers",
"are",
"provided",
"in",
"trec",
"webquestions",
"and",
"triviaqa6",
"we",
"use",
"the",
"highest",
"ranked",
"passage",
"from",
"bm25",
"that",
"contains",
"the",
"answer",
"as",
"the",
"positive",
"passage",
"if",
"none",
"of",
"the",
"top",
"100",
"retrieved",
"passages",
"has",
"the",
"answer",
"the",
"ques",
"tion",
"will",
"be",
"discarded",
"for",
"squad",
"and",
"natural",
"questions",
"since",
"the",
"original",
"passages",
"have",
"been",
"split",
"and",
"processed",
"differently",
"than",
"our",
"pool",
"of",
"candidate",
"passages",
"we",
"match",
"and",
"replace",
"each",
"gold",
"passage",
"with",
"the",
"corresponding",
"passage",
"in",
"the",
"candidate",
"pool",
"7we",
"discard",
"the",
"questions",
"when",
"the",
"matching",
"is",
"failed",
"due",
"to",
"different",
"wikipedia",
"versions",
"or",
"pre",
"processing"
],
[
"table",
"1",
"shows",
"the",
"num",
"ber",
"of",
"questions",
"in",
"training",
"dev",
"test",
"sets",
"for",
"all",
"the",
"datasets",
"and",
"the",
"actual",
"questions",
"used",
"for",
"training",
"the",
"retriever",
"5",
"experiments",
"passage",
"retrieval",
"in",
"this",
"section",
"we",
"evaluate",
"the",
"retrieval",
"perfor",
"mance",
"of",
"our",
"dense",
"passage",
"retriever",
"dpr",
"along",
"with",
"analysis",
"on",
"how",
"its",
"output",
"differs",
"from",
"6we",
"use",
"the",
"triviaqa",
"version",
"and",
"discard",
"the",
"noisy",
"evidence",
"documents",
"mined",
"from",
"bing",
"7the",
"improvement",
"of",
"using",
"gold",
"contexts",
"over",
"passages",
"that",
"contain",
"answers",
"is",
"small",
"see",
"section",
"5",
"2",
"and",
"ap",
"pendix",
"a"
],
[
"training",
"retriever",
"top",
"20",
"top",
"100",
"nq",
"triviaqa",
"wq",
"trec",
"squad",
"nq",
"triviaqa",
"wq",
"trec",
"squad",
"none",
"bm25",
"59",
"1",
"66",
"9",
"55",
"0",
"70",
"9",
"68",
"8",
"73",
"7",
"76",
"7",
"71",
"1",
"84",
"1",
"80",
"0",
"singledpr",
"78",
"4",
"79",
"4",
"73",
"2",
"79",
"8",
"63",
"2",
"85",
"4",
"85",
"0",
"81",
"4",
"89",
"1",
"77",
"2",
"bm25",
"dpr",
"76",
"6",
"79",
"8",
"71",
"0",
"85",
"2",
"71",
"5",
"83",
"8",
"84",
"5",
"80",
"5",
"92",
"7",
"81",
"3",
"multidpr",
"79",
"4",
"78",
"8",
"75",
"0",
"89",
"1",
"51",
"6",
"86",
"0",
"84",
"7",
"82",
"9",
"93",
"9",
"67",
"6",
"bm25",
"dpr",
"78",
"0",
"79",
"9",
"74",
"7",
"88",
"5",
"66",
"2",
"83",
"9",
"84",
"4",
"82",
"3",
"94",
"1",
"78",
"6",
"table",
"2",
"top",
"20",
"top",
"100",
"retrieval",
"accuracy",
"on",
"test",
"sets",
"measured",
"as",
"the",
"percentage",
"of",
"top",
"20",
"100",
"retrieved",
"passages",
"that",
"contain",
"the",
"answer",
"single",
"andmulti",
"denote",
"that",
"our",
"dense",
"passage",
"retriever",
"dpr",
"was",
"trained",
"using",
"individial",
"or",
"combined",
"training",
"datasets",
"all",
"the",
"datasets",
"excluding",
"squad",
"see",
"text",
"for",
"more",
"details",
"traditional",
"retrieval",
"methods",
"the",
"effects",
"of",
"different",
"training",
"schemes",
"and",
"the",
"run",
"time",
"the",
"dpr",
"model",
"used",
"in",
"our",
"main",
"experiments",
"is",
"trained",
"using",
"the",
"in",
"batch",
"negative",
"setting",
"sec",
"tion",
"3",
"2",
"with",
"a",
"batch",
"size",
"of",
"128and",
"one",
"additional",
"bm25",
"negative",
"passage",
"per",
"question",
"we",
"trained",
"the",
"question",
"and",
"passage",
"encoders",
"for",
"up",
"to",
"40",
"epochs",
"for",
"large",
"datasets",
"nq",
"triviaqa",
"squad",
"and100epochs",
"for",
"small",
"datasets",
"trec",
"wq",
"with",
"a",
"learning",
"rate",
"of",
"10",
"5using",
"adam",
"linear",
"scheduling",
"with",
"warm",
"up",
"and",
"dropout",
"rate",
"0",
"1",
"while",
"it",
"is",
"good",
"to",
"have",
"the",
"to",
"adapt",
"the",
"retriever",
"to",
"each",
"dataset",
"it",
"would",
"also",
"be",
"de",
"sirable",
"to",
"obtain",
"a",
"single",
"retriever",
"that",
"works",
"well",
"across",
"the",
"board",
"to",
"this",
"end",
"we",
"train",
"a",
"multi",
"dataset",
"encoder",
"by",
"combining",
"training",
"data",
"from",
"all",
"datasets",
"excluding",
"squad",
"8in",
"addition",
"to",
"dpr",
"we",
"also",
"present",
"the",
"results",
"of",
"bm25",
"the",
"traditional",
"retrieval",
"method9and",
"bm25",
"dpr",
"using",
"a",
"linear",
"combination",
"of",
"their",
"scores",
"as",
"the",
"new",
"ranking",
"function",
"we",
"obtain",
"two",
"initial",
"sets",
"of",
"top",
"2000",
"passages",
"based",
"on",
"bm25",
"and",
"dpr",
"respectively",
"and",
"rerank",
"the",
"union",
"of",
"them",
"using",
"bm25",
"q",
"p",
"sim",
"q",
"p",
"as",
"the",
"ranking",
"function",
"we",
"1",
"1based",
"on",
"the",
"retrieval",
"accuracy",
"in",
"the",
"development",
"set"
],
[
"we",
"obtain",
"two",
"initial",
"sets",
"of",
"top",
"2000",
"passages",
"based",
"on",
"bm25",
"and",
"dpr",
"respectively",
"and",
"rerank",
"the",
"union",
"of",
"them",
"using",
"bm25",
"q",
"p",
"sim",
"q",
"p",
"as",
"the",
"ranking",
"function",
"we",
"1",
"1based",
"on",
"the",
"retrieval",
"accuracy",
"in",
"the",
"development",
"set",
"5",
"1",
"main",
"results",
"table",
"2",
"compares",
"different",
"passage",
"retrieval",
"sys",
"tems",
"on",
"qa",
"datasets",
"using",
"the",
"top",
"kaccuracy",
"k",
"20",
"100",
"with",
"the",
"exception",
"of",
"squad",
"dpr",
"performs",
"consistently",
"better",
"than",
"bm25",
"on",
"all",
"datasets",
"the",
"gap",
"is",
"especially",
"large",
"when",
"kis",
"small",
"e",
"g",
"78",
"4",
"vs",
"59",
"1",
"for",
"top",
"20",
"accuracy",
"on",
"natural",
"questions",
"when",
"training",
"with",
"mul",
"8squad",
"is",
"limited",
"to",
"a",
"small",
"set",
"of",
"wikipedia",
"documents",
"and",
"thus",
"introduces",
"unwanted",
"bias",
"we",
"will",
"discuss",
"this",
"issue",
"more",
"in",
"section",
"5",
"1",
"9lucene",
"implementation",
"bm25",
"parameters",
"b",
"0",
"4",
"doc",
"ument",
"length",
"normalization",
"and",
"k1",
"0",
"9",
"term",
"frequency",
"scaling",
"are",
"tuned",
"using",
"development",
"sets",
"20",
"40",
"60",
"80",
"100",
"k",
"of",
"retrieved",
"passages405060708090top",
"k",
"accuracy",
"bm25"
],
[
"bers",
"of",
"training",
"examples",
"used",
"in",
"our",
"dense",
"passage",
"re",
"triever",
"vs",
"bm25",
"the",
"results",
"are",
"measured",
"on",
"the",
"de",
"velopment",
"set",
"of",
"natural",
"questions",
"our",
"dpr",
"trained",
"using",
"1",
"000",
"examples",
"already",
"outperforms",
"bm25",
"tiple",
"datasets",
"trec",
"the",
"smallest",
"dataset",
"of",
"the",
"greatly",
"from",
"more",
"training",
"examples",
"in",
"contrast",
"natural",
"questions",
"and",
"webquestions",
"improve",
"modestly",
"and",
"triviaqa",
"degrades",
"slightly",
"results",
"can",
"be",
"improved",
"further",
"in",
"some",
"cases",
"by",
"combining",
"dpr",
"with",
"bm25",
"in",
"both",
"single",
"and",
"multi",
"dataset",
"settings",
"we",
"conjecture",
"that",
"the",
"lower",
"performance",
"on",
"squad",
"is",
"due",
"to",
"two",
"reasons",
"first",
"the",
"annota",
"tors",
"wrote",
"questions",
"after",
"seeing",
"the",
"passage",
"as",
"a",
"result",
"there",
"is",
"a",
"high",
"lexical",
"overlap",
"between",
"passages",
"and",
"questions",
"which",
"gives",
"bm25",
"a",
"clear",
"advantage",
"second",
"the",
"data",
"was",
"collected",
"from",
"only",
"500",
"wikipedia",
"articles",
"and",
"thus",
"the",
"distribu",
"tion",
"of",
"training",
"examples",
"is",
"extremely",
"biased",
"as",
"argued",
"previously",
"by",
"lee",
"et",
"al",
"2019",
"5",
"2",
"ablation",
"study",
"on",
"model",
"training",
"to",
"understand",
"further",
"how",
"different",
"model",
"training",
"options",
"affect",
"the",
"results",
"we",
"conduct",
"several",
"addi",
"tional",
"experiments",
"and",
"discuss",
"our",
"below"
],
[
"sample",
"we",
"explore",
"how",
"many",
"train",
"ing",
"examples",
"are",
"needed",
"to",
"achieve",
"good",
"passage",
"retrieval",
"performance",
"figure",
"1",
"illustrates",
"the",
"top",
"k",
"retrieval",
"accuracy",
"with",
"respect",
"to",
"different",
"num",
"bers",
"of",
"training",
"examples",
"measured",
"on",
"the",
"devel",
"opment",
"set",
"of",
"natural",
"questions",
"as",
"is",
"shown",
"a",
"dense",
"passage",
"retriever",
"trained",
"using",
"only",
"1",
"000",
"ex",
"amples",
"already",
"outperforms",
"bm25",
"this",
"suggests",
"that",
"with",
"a",
"general",
"pretrained",
"language",
"model",
"it",
"is",
"possible",
"to",
"train",
"a",
"high",
"quality",
"dense",
"retriever",
"with",
"a",
"small",
"number",
"of",
"question",
"passage",
"pairs",
"adding",
"more",
"training",
"examples",
"from",
"1k",
"to",
"59k",
"further",
"improves",
"the",
"retrieval",
"accuracy",
"consistently",
"in",
"batch",
"negative",
"training",
"we",
"test",
"different",
"training",
"schemes",
"on",
"the",
"development",
"set",
"of",
"natural",
"questions",
"and",
"summarize",
"the",
"results",
"in",
"table",
"3",
"the",
"top",
"block",
"is",
"the",
"standard",
"1",
"of",
"ntraining",
"set",
"ting",
"where",
"each",
"question",
"in",
"the",
"batch",
"is",
"paired",
"with",
"a",
"positive",
"passage",
"and",
"its",
"own",
"set",
"of",
"nneg",
"ative",
"passages",
"eq",
"2",
"we",
"that",
"the",
"choice",
"of",
"negatives",
"random",
"bm25",
"or",
"gold",
"passages",
"positive",
"passages",
"from",
"other",
"questions",
"does",
"not",
"impact",
"the",
"top",
"kaccuracy",
"much",
"in",
"this",
"setting",
"whenk",
"20",
"the",
"middle",
"bock",
"is",
"the",
"in",
"batch",
"negative",
"training",
"section",
"3",
"2",
"setting",
"we",
"that",
"using",
"a",
"similar",
"7",
"gold",
"negative",
"passages",
"in",
"batch",
"negative",
"training",
"improves",
"the",
"results",
"substantially",
"the",
"key",
"difference",
"between",
"the",
"two",
"is",
"whether",
"the",
"gold",
"negative",
"passages",
"come",
"from",
"the",
"same",
"batch",
"or",
"from",
"the",
"whole",
"training",
"set",
"effectively",
"in",
"batch",
"negative",
"training",
"is",
"an",
"easy",
"and",
"memory",
"way",
"to",
"reuse",
"the",
"negative",
"examples",
"already",
"in",
"the",
"batch",
"rather",
"than",
"creating",
"new",
"ones",
"it",
"produces",
"more",
"pairs",
"and",
"thus",
"increases",
"the",
"number",
"of",
"train",
"ing",
"examples",
"which",
"might",
"contribute",
"to",
"the",
"good",
"model",
"performance",
"as",
"a",
"result",
"accuracy",
"consis",
"tently",
"improves",
"as",
"the",
"batch",
"size",
"grows",
"finally",
"we",
"explore",
"in",
"batch",
"negative",
"training",
"with",
"additional",
"hard",
"negative",
"passages",
"that",
"have",
"high",
"bm25",
"scores",
"given",
"the",
"question",
"but",
"do",
"not",
"contain",
"the",
"answer",
"string",
"the",
"bottom",
"block"
],
[
"as",
"a",
"result",
"accuracy",
"consis",
"tently",
"improves",
"as",
"the",
"batch",
"size",
"grows",
"finally",
"we",
"explore",
"in",
"batch",
"negative",
"training",
"with",
"additional",
"hard",
"negative",
"passages",
"that",
"have",
"high",
"bm25",
"scores",
"given",
"the",
"question",
"but",
"do",
"not",
"contain",
"the",
"answer",
"string",
"the",
"bottom",
"block",
"these",
"additional",
"passages",
"are",
"used",
"as",
"negative",
"passages",
"for",
"all",
"questions",
"in",
"the",
"same",
"batch",
"we",
"that",
"adding",
"a",
"single",
"bm25",
"negative",
"passage",
"improves",
"the",
"result",
"substantially",
"while",
"adding",
"two",
"does",
"not",
"help",
"further",
"impact",
"of",
"gold",
"passages",
"we",
"use",
"passages",
"that",
"match",
"the",
"gold",
"contexts",
"in",
"the",
"original",
"datasets",
"when",
"available",
"as",
"positive",
"examples",
"section",
"4",
"2",
"type",
"n",
"ib",
"top",
"5",
"top",
"20",
"top",
"100",
"random",
"7",
"47",
"0",
"64",
"3",
"77",
"8",
"bm25",
"7",
"50",
"0",
"63",
"3",
"74",
"8",
"gold",
"7",
"42",
"6",
"63",
"1",
"78",
"3",
"gold",
"7",
"51",
"1",
"69",
"1",
"80",
"8",
"gold",
"31",
"52",
"1",
"70",
"8",
"82",
"1",
"gold",
"127",
"55",
"8",
"73",
"0",
"83",
"1",
"g",
"bm25",
"1",
"31",
"32",
"65",
"0",
"77",
"3",
"84",
"4",
"g",
"bm25",
"2",
"31",
"64",
"64",
"5",
"76",
"4",
"84",
"0",
"g",
"bm25",
"1",
"127",
"128",
"65",
"8",
"78",
"0",
"84",
"9",
"table",
"3",
"comparison",
"of",
"different",
"training",
"schemes",
"measured",
"as",
"top",
"kretrieval",
"accuracy",
"on",
"natural",
"ques",
"tions",
"development",
"set",
"n",
"number",
"of",
"negative",
"examples",
"ib",
"in",
"batch",
"training",
"g",
"bm25",
"1",
"and",
"g",
"bm25",
"2",
"denote",
"in",
"batch",
"training",
"with",
"1",
"or",
"2",
"ad",
"ditional",
"bm25",
"negatives",
"which",
"serve",
"as",
"negative",
"pas",
"sages",
"for",
"all",
"questions",
"in",
"the",
"batch",
"our",
"experiments",
"on",
"natural",
"questions",
"show",
"that",
"switching",
"to",
"distantly",
"supervised",
"passages",
"using",
"the",
"highest",
"ranked",
"bm25",
"passage",
"that",
"contains",
"the",
"answer",
"has",
"only",
"a",
"small",
"impact",
"1",
"point",
"lower",
"top",
"kaccuracy",
"for",
"retrieval",
"appendix",
"a",
"contains",
"more",
"details",
"similarity",
"and",
"loss",
"besides",
"dot",
"product",
"cosine",
"and",
"euclidean",
"l2",
"distance",
"are",
"also",
"commonly",
"used",
"as",
"decomposable",
"similarity",
"functions",
"we",
"test",
"these",
"alternatives",
"and",
"that",
"l2",
"performs",
"compara",
"ble",
"to",
"dot",
"product",
"and",
"both",
"of",
"them",
"are",
"superior",
"to",
"cosine",
"similarly",
"in",
"addition",
"to",
"negative",
"log",
"likelihood",
"a",
"popular",
"option",
"for",
"ranking",
"is",
"triplet",
"loss",
"which",
"compares",
"a",
"positive",
"passage",
"and",
"a",
"nega",
"tive",
"one",
"directly",
"with",
"respect",
"to",
"a",
"question",
"burges",
"et",
"al",
"2005",
"our",
"experiments",
"show",
"that",
"using",
"triplet",
"loss",
"does",
"not",
"affect",
"the",
"results",
"much"
],
[
"our",
"experiments",
"show",
"that",
"using",
"triplet",
"loss",
"does",
"not",
"affect",
"the",
"results",
"much",
"more",
"details",
"can",
"be",
"found",
"in",
"appendix",
"b",
"cross",
"dataset",
"generalization",
"one",
"interesting",
"question",
"regarding",
"dpr",
"s",
"discriminative",
"training",
"is",
"how",
"much",
"performance",
"degradation",
"it",
"may",
"suf",
"fer",
"from",
"a",
"non",
"iid",
"setting",
"in",
"other",
"words",
"can",
"it",
"still",
"generalize",
"well",
"when",
"directly",
"applied",
"to",
"a",
"different",
"dataset",
"without",
"additional",
"tuning",
"to",
"test",
"the",
"cross",
"dataset",
"generalization",
"we",
"train",
"dpr",
"on",
"natural",
"questions",
"only",
"and",
"test",
"it",
"directly",
"on",
"the",
"smaller",
"webquestions",
"and",
"curatedtrec",
"datasets",
"we",
"that",
"dpr",
"generalizes",
"well",
"with",
"3",
"5",
"points",
"loss",
"from",
"the",
"best",
"performing",
"tuned",
"model",
"in",
"top",
"20",
"retrieval",
"accuracy",
"69",
"9",
"86",
"3",
"vs",
"75",
"0",
"89",
"1",
"for",
"webquestions",
"and",
"trec",
"respec",
"tively",
"while",
"still",
"greatly",
"outperforming",
"the",
"bm25",
"baseline",
"55",
"0",
"70",
"9"
],
[
"5",
"3",
"qualitative",
"analysis",
"although",
"dpr",
"performs",
"better",
"than",
"bm25",
"in",
"gen",
"eral",
"passages",
"retrieved",
"by",
"these",
"two",
"methods",
"dif",
"fer",
"qualitatively",
"term",
"matching",
"methods",
"like",
"bm25",
"are",
"sensitive",
"to",
"highly",
"selective",
"keywords",
"and",
"phrases",
"while",
"dpr",
"captures",
"lexical",
"variations",
"or",
"semantic",
"relationships",
"better",
"see",
"appendix",
"c",
"for",
"examples",
"and",
"more",
"discussion",
"5",
"4",
"run",
"time",
"the",
"main",
"reason",
"that",
"we",
"require",
"a",
"retrieval",
"compo",
"nent",
"for",
"open",
"domain",
"qa",
"is",
"to",
"reduce",
"the",
"number",
"of",
"candidate",
"passages",
"that",
"the",
"reader",
"needs",
"to",
"con",
"sider",
"which",
"is",
"crucial",
"for",
"answering",
"user",
"s",
"ques",
"tions",
"in",
"real",
"time",
"we",
"the",
"passage",
"retrieval",
"speed",
"on",
"a",
"server",
"with",
"intel",
"xeon",
"cpu",
"e5",
"2698",
"v4",
"2",
"20ghz",
"and",
"512gb",
"memory",
"with",
"the",
"help",
"of",
"faiss",
"in",
"memory",
"index",
"for",
"real",
"valued",
"vectors10",
"dpr",
"can",
"be",
"made",
"incredibly",
"processing",
"995",
"0",
"questions",
"per",
"second",
"returning",
"top",
"100",
"pas",
"sages",
"per",
"question",
"in",
"contrast",
"bm25",
"lucene",
"im",
"plemented",
"in",
"java",
"using",
"index",
"processes",
"23",
"7",
"questions",
"per",
"second",
"per",
"cpu",
"thread",
"on",
"the",
"other",
"hand",
"the",
"time",
"required",
"for",
"building",
"an",
"index",
"for",
"dense",
"vectors",
"is",
"much",
"longer",
"com",
"puting",
"dense",
"embeddings",
"on",
"21",
"million",
"passages",
"is",
"resource",
"intensive",
"but",
"can",
"be",
"easily",
"parallelized",
"taking",
"roughly",
"8",
"8",
"hours",
"on",
"8",
"gpus",
"however",
"building",
"the",
"faiss",
"index",
"on",
"21",
"million",
"vectors",
"on",
"a",
"single",
"server",
"takes",
"8",
"5",
"hours",
"in",
"comparison",
"building",
"an",
"inverted",
"index",
"using",
"lucene",
"is",
"much",
"cheaper",
"and",
"takes",
"only",
"about",
"30",
"minutes",
"in",
"total",
"6",
"experiments",
"question",
"answering",
"in",
"this",
"section",
"we",
"experiment",
"with",
"how",
"different",
"passage",
"retrievers",
"affect",
"the",
"qa",
"accuracy",
"6",
"1",
"end",
"to",
"end",
"qa",
"system",
"we",
"implement",
"an",
"end",
"to",
"end",
"question",
"answering",
"system",
"in",
"which",
"we",
"can",
"plug",
"different",
"retriever",
"systems",
"directly",
"besides",
"the",
"retriever",
"our",
"qa",
"sys",
"tem",
"consists",
"of",
"a",
"neural",
"reader",
"that",
"outputs",
"the",
"answer",
"to",
"the",
"question",
"given",
"the",
"top",
"kretrieved",
"passages",
"up",
"to",
"100in",
"our",
"experiments",
"the",
"reader",
"assigns",
"a",
"passage",
"selection",
"score",
"to",
"each",
"passage",
"in",
"addition",
"it",
"extracts",
"an",
"answer",
"span",
"from",
"each",
"passage",
"and",
"assigns",
"a",
"span",
"score"
],
[
"given",
"the",
"top",
"kretrieved",
"passages",
"up",
"to",
"100in",
"our",
"experiments",
"the",
"reader",
"assigns",
"a",
"passage",
"selection",
"score",
"to",
"each",
"passage",
"in",
"addition",
"it",
"extracts",
"an",
"answer",
"span",
"from",
"each",
"passage",
"and",
"assigns",
"a",
"span",
"score",
"the",
"best",
"span",
"from",
"the",
"passage",
"with",
"the",
"highest",
"passage",
"selection",
"10faiss",
"we",
"used",
"hnsw",
"index",
"type",
"on",
"cpu",
"neighbors",
"to",
"store",
"per",
"node",
"512",
"construction",
"time",
"search",
"depth",
"200",
"search",
"depth",
"128",
"score",
"is",
"chosen",
"as",
"the",
"answer",
"the",
"passage",
"selection",
"model",
"serves",
"as",
"a",
"reranker",
"through",
"cross",
"attention",
"between",
"the",
"question",
"and",
"the",
"passage",
"al",
"though",
"cross",
"attention",
"is",
"not",
"feasible",
"for",
"retrieving",
"relevant",
"passages",
"in",
"a",
"large",
"corpus",
"due",
"to",
"its",
"non",
"decomposable",
"nature",
"it",
"has",
"more",
"capacity",
"than",
"the",
"dual",
"encoder",
"model",
"sim",
"q",
"p",
"as",
"in",
"eq",
"1",
"apply",
"ing",
"it",
"to",
"selecting",
"the",
"passage",
"from",
"a",
"small",
"number",
"of",
"retrieved",
"candidates",
"has",
"been",
"shown",
"to",
"work",
"well",
"wang",
"et",
"al",
"2019",
"2018",
"lin",
"et",
"al",
"2018",
"let",
"pi",
"rl",
"h",
"1",
"i",
"k",
"be",
"a",
"bert",
"base",
"uncased",
"in",
"our",
"experiments",
"rep",
"resentation",
"for",
"the",
"i",
"th",
"passage",
"where",
"lis",
"the",
"maximum",
"length",
"of",
"the",
"passage",
"and",
"hthe",
"hidden",
"dimension",
"the",
"probabilities",
"of",
"a",
"token",
"being",
"the",
"starting",
"ending",
"positions",
"of",
"an",
"answer",
"span",
"and",
"a",
"passage",
"being",
"selected",
"are",
"as",
"pstart",
"i",
"s",
"softmax",
"piwstart",
"s",
"3",
"pend",
"i",
"t",
"softmax",
"piwend",
"t",
"4",
"pselected",
"i",
"softmax",
"wselected",
"i",
"5",
"where",
"p",
"cls",
"1",
"p",
"cls",
"k",
"rh",
"kand",
"wstart",
"wend",
"wselected",
"rhare",
"learnable",
"vectors",
"we",
"compute",
"a",
"span",
"score",
"of",
"the",
"s",
"th",
"tot",
"th",
"words",
"from",
"thei",
"th",
"passage",
"as",
"pstart",
"i",
"s",
"pend",
"i",
"t",
"and",
"a",
"passage",
"selection",
"score",
"of",
"the",
"i",
"th",
"passage",
"as",
"pselected",
"i",
"during",
"training",
"we",
"sample",
"one",
"positive",
"and",
"m",
"1negative",
"passages",
"from",
"the",
"top",
"100",
"passages",
"returned",
"by",
"the",
"retrieval",
"system",
"bm25",
"or",
"dpr",
"for",
"each",
"question",
"mis",
"a",
"hyper",
"parameter",
"and",
"we",
"use",
"m",
"24",
"in",
"all",
"the",
"experiments"
],
[
"during",
"training",
"we",
"sample",
"one",
"positive",
"and",
"m",
"1negative",
"passages",
"from",
"the",
"top",
"100",
"passages",
"returned",
"by",
"the",
"retrieval",
"system",
"bm25",
"or",
"dpr",
"for",
"each",
"question",
"mis",
"a",
"hyper",
"parameter",
"and",
"we",
"use",
"m",
"24",
"in",
"all",
"the",
"experiments",
"the",
"training",
"ob",
"jective",
"is",
"to",
"maximize",
"the",
"marginal",
"log",
"likelihood",
"of",
"all",
"the",
"correct",
"answer",
"spans",
"in",
"the",
"positive",
"pas",
"sage",
"the",
"answer",
"string",
"may",
"appear",
"multiple",
"times",
"in",
"one",
"passage",
"combined",
"with",
"the",
"log",
"likelihood",
"of",
"the",
"positive",
"passage",
"being",
"selected",
"we",
"use",
"the",
"batch",
"size",
"of",
"16",
"for",
"large",
"nq",
"triviaqa",
"squad",
"and",
"4",
"for",
"small",
"trec",
"wq",
"datasets",
"and",
"tune",
"k",
"on",
"the",
"development",
"set",
"for",
"experiments",
"on",
"small",
"datasets",
"under",
"the",
"multi",
"setting",
"in",
"which",
"using",
"other",
"datasets",
"is",
"allowed",
"we",
"tune",
"the",
"reader",
"trained",
"on",
"natural",
"questions",
"to",
"the",
"target",
"dataset",
"all",
"experiments",
"were",
"done",
"on",
"eight",
"32gb",
"gpus",
"6",
"2",
"results",
"table",
"4",
"summarizes",
"our",
"end",
"to",
"end",
"qa",
"re",
"sults",
"measured",
"by",
"exact",
"match",
"with",
"the",
"reference",
"answer",
"after",
"minor",
"normalization",
"as",
"in",
"chen",
"et",
"al",
"2017",
"lee",
"et",
"al",
"2019",
"from",
"the",
"table",
"we",
"can"
],
[
"training",
"model",
"nq",
"triviaqa",
"wq",
"trec",
"squad",
"single",
"bm25",
"bert",
"lee",
"et",
"al",
"2019",
"26",
"5",
"47",
"1",
"17",
"7",
"21",
"3",
"33",
"2",
"single",
"orqa",
"lee",
"et",
"al",
"2019",
"33",
"3",
"45",
"0",
"36",
"4",
"30",
"1",
"20",
"2",
"single",
"hardem",
"min",
"et",
"al",
"2019a",
"28",
"1",
"50",
"9",
"single",
"graphretriever",
"min",
"et",
"al",
"2019b",
"34",
"5",
"56",
"0",
"36",
"4",
"single",
"pathretriever",
"asai",
"et",
"al",
"2020",
"32",
"6",
"56",
"5",
"single",
"realm",
"wiki",
"guu",
"et",
"al",
"2020",
"39",
"2",
"40",
"2",
"46",
"8",
"single",
"realm",
"news",
"guu",
"et",
"al",
"2020",
"40",
"4",
"40",
"7",
"42",
"9",
"singlebm25",
"32",
"6",
"52",
"4",
"29",
"9",
"24",
"9",
"38",
"1",
"dpr",
"41",
"5",
"56",
"8",
"34",
"6",
"25",
"9",
"29",
"8",
"bm25",
"dpr",
"39",
"0",
"57",
"0",
"35",
"2",
"28",
"0",
"36",
"7",
"multidpr",
"41",
"5",
"56",
"8",
"42",
"4",
"49",
"4",
"24",
"1",
"bm25",
"dpr",
"38",
"8",
"57",
"9",
"41",
"1",
"50",
"6",
"35",
"8",
"table",
"4",
"end",
"to",
"end",
"qa",
"exact",
"match",
"accuracy",
"the",
"block",
"of",
"results",
"are",
"copied",
"from",
"their",
"cited",
"papers",
"realm",
"wikiand",
"realm",
"newsare",
"the",
"same",
"model",
"but",
"pretrained",
"on",
"wikipedia",
"and",
"cc",
"news",
"respectively",
"single",
"andmulti",
"denote",
"that",
"our",
"dense",
"passage",
"retriever",
"dpr",
"is",
"trained",
"using",
"individual",
"or",
"combined",
"training",
"datasets",
"all",
"except",
"squad",
"for",
"wq",
"and",
"trec",
"in",
"the",
"multi",
"setting",
"we",
"tune",
"the",
"reader",
"trained",
"on",
"nq",
"see",
"that",
"higher",
"retriever",
"accuracy",
"typically",
"leads",
"to",
"better",
"qa",
"results",
"in",
"all",
"cases",
"except",
"squad",
"answers",
"extracted",
"from",
"the",
"passages",
"retrieved",
"by",
"dpr",
"are",
"more",
"likely",
"to",
"be",
"correct",
"compared",
"to",
"those",
"from",
"bm25",
"for",
"large",
"datasets",
"like",
"nq",
"and",
"triviaqa",
"models",
"trained",
"using",
"multiple",
"datasets",
"multi",
"perform",
"comparably",
"to",
"those",
"trained",
"using",
"the",
"individual",
"training",
"set",
"single",
"conversely",
"on",
"smaller",
"datasets",
"like",
"wq",
"and",
"trec",
"the",
"multi",
"dataset",
"setting",
"has",
"a",
"clear",
"advantage",
"overall",
"our",
"dpr",
"based",
"models",
"outperform",
"the",
"previous",
"state",
"of",
"the",
"art",
"results",
"on",
"four",
"out",
"of",
"the",
"datasets",
"with",
"1",
"to",
"12",
"absolute",
"differences",
"in",
"exact",
"match",
"accuracy",
"it",
"is",
"interesting",
"to",
"contrast",
"our",
"results",
"to",
"those",
"of",
"orqa",
"lee",
"et",
"al",
"2019",
"and",
"also",
"the",
"concurrently",
"developed",
"approach",
"realm",
"guu",
"et",
"al",
"2020"
],
[
"it",
"is",
"interesting",
"to",
"contrast",
"our",
"results",
"to",
"those",
"of",
"orqa",
"lee",
"et",
"al",
"2019",
"and",
"also",
"the",
"concurrently",
"developed",
"approach",
"realm",
"guu",
"et",
"al",
"2020",
"while",
"both",
"methods",
"include",
"addi",
"tional",
"pretraining",
"tasks",
"and",
"employ",
"an",
"expensive",
"end",
"to",
"end",
"training",
"regime",
"dpr",
"manages",
"to",
"out",
"perform",
"them",
"on",
"both",
"nq",
"and",
"triviaqa",
"simply",
"by",
"focusing",
"on",
"learning",
"a",
"strong",
"passage",
"retrieval",
"model",
"using",
"pairs",
"of",
"questions",
"and",
"answers",
"the",
"additional",
"pretraining",
"tasks",
"are",
"likely",
"more",
"useful",
"only",
"when",
"the",
"target",
"training",
"sets",
"are",
"small",
"al",
"though",
"the",
"results",
"of",
"dpr",
"on",
"wq",
"and",
"trec",
"in",
"the",
"single",
"dataset",
"setting",
"are",
"less",
"competitive",
"adding",
"more",
"question",
"answer",
"pairs",
"helps",
"boost",
"the",
"perfor",
"mance",
"achieving",
"the",
"new",
"state",
"of",
"the",
"art",
"to",
"compare",
"our",
"pipeline",
"training",
"approach",
"with",
"joint",
"learning",
"we",
"run",
"an",
"ablation",
"on",
"natural",
"ques",
"tions",
"where",
"the",
"retriever",
"and",
"reader",
"are",
"jointlytrained",
"following",
"lee",
"et",
"al",
"2019",
"this",
"approach",
"obtains",
"a",
"score",
"of",
"39",
"8",
"em",
"which",
"suggests",
"that",
"our",
"strategy",
"of",
"training",
"a",
"strong",
"retriever",
"and",
"reader",
"in",
"isolation",
"can",
"leverage",
"effectively",
"available",
"supervi",
"sion",
"while",
"outperforming",
"a",
"comparable",
"joint",
"train",
"ing",
"approach",
"with",
"a",
"simpler",
"design",
"appendix",
"d",
"one",
"thing",
"worth",
"noticing",
"is",
"that",
"our",
"reader",
"does",
"consider",
"more",
"passages",
"compared",
"to",
"orqa",
"al",
"though",
"it",
"is",
"not",
"completely",
"clear",
"how",
"much",
"more",
"time",
"it",
"takes",
"for",
"inference",
"while",
"dpr",
"processes",
"up",
"to",
"100",
"passages",
"for",
"each",
"question",
"the",
"reader",
"is",
"able",
"to",
"all",
"of",
"them",
"into",
"one",
"batch",
"on",
"a",
"sin",
"gle",
"32gb",
"gpu",
"thus",
"the",
"latency",
"remains",
"almost",
"identical",
"to",
"the",
"single",
"passage",
"case",
"around",
"20ms",
"the",
"exact",
"impact",
"on",
"throughput",
"is",
"harder",
"to",
"mea",
"sure",
"orqa",
"uses",
"2",
"3x",
"longer",
"passages",
"compared",
"to",
"dpr",
"288",
"word",
"pieces",
"compared",
"to",
"our",
"100",
"tokens",
"and",
"the",
"computational",
"complexity",
"is",
"super",
"linear",
"in",
"passage",
"length",
"we",
"also",
"note",
"that",
"we",
"foundk",
"50",
"to",
"be",
"optimal",
"for",
"nq",
"and",
"k",
"10",
"leads",
"to",
"only",
"marginal",
"loss",
"in",
"exact",
"match",
"accu",
"racy",
"40",
"8",
"vs",
"41",
"5",
"em",
"on",
"nq",
"which",
"should",
"be",
"roughly",
"comparable",
"to",
"orqa",
"s",
"5",
"passage",
"setup"
],
[
"we",
"also",
"note",
"that",
"we",
"foundk",
"50",
"to",
"be",
"optimal",
"for",
"nq",
"and",
"k",
"10",
"leads",
"to",
"only",
"marginal",
"loss",
"in",
"exact",
"match",
"accu",
"racy",
"40",
"8",
"vs",
"41",
"5",
"em",
"on",
"nq",
"which",
"should",
"be",
"roughly",
"comparable",
"to",
"orqa",
"s",
"5",
"passage",
"setup",
"7",
"related",
"work",
"passage",
"retrieval",
"has",
"been",
"an",
"important",
"compo",
"nent",
"for",
"open",
"domain",
"qa",
"v",
"oorhees",
"1999",
"it",
"not",
"only",
"effectively",
"reduces",
"the",
"search",
"space",
"for",
"answer",
"extraction",
"but",
"also",
"the",
"support",
"context",
"for",
"users",
"to",
"verify",
"the",
"answer",
"strong",
"sparse",
"vector",
"space",
"models",
"like",
"tf",
"idf",
"or",
"bm25",
"have"
],
[
"been",
"used",
"as",
"the",
"standard",
"method",
"applied",
"broadly",
"to",
"various",
"qa",
"tasks",
"e",
"g",
"chen",
"et",
"al",
"2017",
"yang",
"et",
"al",
"2019a",
"b",
"nie",
"et",
"al",
"2019",
"min",
"et",
"al",
"2019a",
"wolfson",
"et",
"al",
"2020",
"augmenting",
"text",
"based",
"re",
"trieval",
"with",
"external",
"structured",
"information",
"such",
"as",
"knowledge",
"graph",
"and",
"wikipedia",
"hyperlinks",
"has",
"also",
"been",
"explored",
"recently",
"min",
"et",
"al",
"2019b",
"asai",
"et",
"al",
"2020",
"the",
"use",
"of",
"dense",
"vector",
"representations",
"for",
"re",
"trieval",
"has",
"a",
"long",
"history",
"since",
"latent",
"semantic",
"analysis",
"deerwester",
"et",
"al",
"1990",
"using",
"labeled",
"pairs",
"of",
"queries",
"and",
"documents",
"discriminatively",
"trained",
"dense",
"encoders",
"have",
"become",
"popular",
"re",
"cently",
"yih",
"et",
"al",
"2011",
"huang",
"et",
"al",
"2013",
"gillick",
"et",
"al",
"2019",
"with",
"applications",
"to",
"cross",
"lingual",
"document",
"retrieval",
"ad",
"relevance",
"prediction",
"web",
"search",
"and",
"entity",
"retrieval",
"such",
"approaches",
"com",
"plement",
"the",
"sparse",
"vector",
"methods",
"as",
"they",
"can",
"po",
"tentially",
"give",
"high",
"similarity",
"scores",
"to",
"semantically",
"relevant",
"text",
"pairs",
"even",
"without",
"exact",
"token",
"match",
"ing",
"the",
"dense",
"representation",
"alone",
"however",
"is",
"typically",
"inferior",
"to",
"the",
"sparse",
"one",
"while",
"not",
"the",
"focus",
"of",
"this",
"work",
"dense",
"representations",
"from",
"pre",
"trained",
"models",
"along",
"with",
"cross",
"attention",
"mecha",
"nisms",
"have",
"also",
"been",
"shown",
"effective",
"in",
"passage",
"or",
"dialogue",
"re",
"ranking",
"tasks",
"nogueira",
"and",
"cho",
"2019",
"humeau",
"et",
"al",
"2020",
"finally",
"a",
"concurrent",
"work",
"khattab",
"and",
"zaharia",
"2020",
"demonstrates",
"the",
"feasibility",
"of",
"full",
"dense",
"retrieval",
"in",
"ir",
"tasks",
"instead",
"of",
"employing",
"the",
"dual",
"encoder",
"framework",
"they",
"introduced",
"a",
"late",
"interaction",
"operator",
"on",
"top",
"of",
"the",
"bert",
"encoders",
"dense",
"retrieval",
"for",
"open",
"domain",
"qa",
"has",
"been",
"explored",
"by",
"das",
"et",
"al",
"2019",
"who",
"propose",
"to",
"re",
"trieve",
"relevant",
"passages",
"iteratively",
"using",
"reformu",
"lated",
"question",
"vectors",
"as",
"an",
"alternative",
"approach",
"that",
"skips",
"passage",
"retrieval",
"seo",
"et",
"al",
"2019",
"pro",
"pose",
"to",
"encode",
"candidate",
"answer",
"phrases",
"as",
"vectors",
"and",
"directly",
"retrieve",
"the",
"answers",
"to",
"the",
"input",
"ques",
"tions",
"using",
"additional",
"pretraining",
"with",
"the",
"objective",
"that",
"matches",
"surrogates",
"of",
"questions",
"and",
"relevant",
"passages",
"lee",
"et",
"al"
],
[
"2019",
"pro",
"pose",
"to",
"encode",
"candidate",
"answer",
"phrases",
"as",
"vectors",
"and",
"directly",
"retrieve",
"the",
"answers",
"to",
"the",
"input",
"ques",
"tions",
"using",
"additional",
"pretraining",
"with",
"the",
"objective",
"that",
"matches",
"surrogates",
"of",
"questions",
"and",
"relevant",
"passages",
"lee",
"et",
"al",
"2019",
"jointly",
"train",
"the",
"question",
"encoder",
"and",
"reader",
"their",
"approach",
"outperforms",
"the",
"bm25",
"plus",
"reader",
"paradigm",
"on",
"multiple",
"open",
"domain",
"qa",
"datasets",
"in",
"qa",
"accuracy",
"and",
"is",
"further",
"extended",
"by",
"realm",
"guu",
"et",
"al",
"2020",
"which",
"includes",
"tuning",
"the",
"passage",
"encoder",
"asynchronously",
"by",
"re",
"indexing",
"the",
"passages",
"dur",
"ing",
"training",
"the",
"pretraining",
"objective",
"has",
"also",
"recently",
"been",
"improved",
"by",
"xiong",
"et",
"al",
"2020b",
"in",
"contrast",
"our",
"model",
"provides",
"a",
"simple",
"and",
"yeteffective",
"solution",
"that",
"shows",
"stronger",
"empirical",
"per",
"formance",
"without",
"relying",
"on",
"additional",
"pretraining",
"or",
"complex",
"joint",
"training",
"schemes",
"dpr",
"has",
"also",
"been",
"used",
"as",
"an",
"important",
"mod",
"ule",
"in",
"very",
"recent",
"work",
"for",
"instance",
"extending",
"the",
"idea",
"of",
"leveraging",
"hard",
"negatives",
"xiong",
"et",
"al",
"2020a",
"use",
"the",
"retrieval",
"model",
"trained",
"in",
"the",
"pre",
"vious",
"iteration",
"to",
"discover",
"new",
"negatives",
"and",
"con",
"struct",
"a",
"different",
"set",
"of",
"examples",
"in",
"each",
"training",
"iteration",
"starting",
"from",
"our",
"trained",
"dpr",
"model",
"they",
"show",
"that",
"the",
"retrieval",
"performance",
"can",
"be",
"further",
"improved",
"recent",
"work",
"izacard",
"and",
"grave",
"2020",
"lewis",
"et",
"al",
"2020b",
"have",
"also",
"shown",
"that",
"dpr",
"can",
"be",
"combined",
"with",
"generation",
"models",
"such",
"as",
"bart",
"lewis",
"et",
"al",
"2020a",
"and",
"t5",
"raf",
"fel",
"et",
"al",
"2019",
"achieving",
"good",
"performance",
"on",
"open",
"domain",
"qa",
"and",
"other",
"knowledge",
"intensive",
"tasks",
"8",
"conclusion",
"in",
"this",
"work",
"we",
"demonstrated",
"that",
"dense",
"retrieval",
"can",
"outperform",
"and",
"potentially",
"replace",
"the",
"tradi",
"tional",
"sparse",
"retrieval",
"component",
"in",
"open",
"domain",
"question",
"answering",
"while",
"a",
"simple",
"dual",
"encoder",
"approach",
"can",
"be",
"made",
"to",
"work",
"surprisingly",
"well",
"we",
"showed",
"that",
"there",
"are",
"some",
"critical",
"ingredients",
"to",
"training",
"a",
"dense",
"retriever",
"successfully",
"moreover",
"our",
"empirical",
"analysis",
"and",
"ablation",
"studies",
"indicate",
"that",
"more",
"complex",
"model",
"frameworks",
"or",
"similarity",
"functions",
"do",
"not",
"necessarily",
"provide",
"additional",
"val",
"ues"
],
[
"moreover",
"our",
"empirical",
"analysis",
"and",
"ablation",
"studies",
"indicate",
"that",
"more",
"complex",
"model",
"frameworks",
"or",
"similarity",
"functions",
"do",
"not",
"necessarily",
"provide",
"additional",
"val",
"ues",
"as",
"a",
"result",
"of",
"improved",
"retrieval",
"performance",
"we",
"obtained",
"new",
"state",
"of",
"the",
"art",
"results",
"on",
"multiple",
"open",
"domain",
"question",
"answering",
"benchmarks",
"acknowledgments",
"we",
"thank",
"the",
"anonymous",
"reviewers",
"for",
"their",
"helpful",
"comments",
"and",
"suggestions",
"references",
"akari",
"asai",
"kazuma",
"hashimoto",
"hannaneh",
"hajishirzi",
"richard",
"socher",
"and",
"caiming",
"xiong",
"2020",
"learn",
"ing",
"to",
"retrieve",
"reasoning",
"paths",
"over",
"wikipedia",
"graph",
"for",
"question",
"answering",
"in",
"international",
"conference",
"on",
"learning",
"representations",
"iclr",
"petr",
"baudi",
"and",
"jan",
"y",
"2015",
"modeling",
"of",
"the",
"question",
"answering",
"task",
"in",
"the",
"yodaqa",
"system",
"in",
"in",
"ternational",
"conference",
"of",
"the",
"cross",
"language",
"eval",
"uation",
"forum",
"for",
"european",
"languages",
"pages",
"222",
"228",
"springer",
"jonathan",
"berant",
"andrew",
"chou",
"roy",
"frostig",
"and",
"percy",
"liang",
"2013",
"semantic",
"parsing",
"on",
"freebase",
"from"
],
[
"question",
"answer",
"pairs",
"in",
"empirical",
"methods",
"in",
"nat",
"ural",
"language",
"processing",
"emnlp",
"jane",
"bromley",
"isabelle",
"guyon",
"yann",
"lecun",
"eduard",
"s",
"ackinger",
"and",
"roopak",
"shah",
"1994",
"signature",
"cation",
"using",
"a",
"siamese",
"time",
"delay",
"neural",
"network",
"innips",
"pages",
"737",
"744",
"chris",
"burges",
"tal",
"shaked",
"erin",
"renshaw",
"ari",
"lazier",
"matt",
"deeds",
"nicole",
"hamilton",
"and",
"greg",
"hullender",
"2005",
"learning",
"to",
"rank",
"using",
"gradient",
"descent",
"in",
"proceedings",
"of",
"the",
"22nd",
"international",
"conference",
"on",
"machine",
"learning",
"pages",
"89",
"96",
"danqi",
"chen",
"adam",
"fisch",
"jason",
"weston",
"and",
"antoine",
"bordes",
"2017",
"reading",
"wikipedia",
"to",
"answer",
"open",
"domain",
"questions",
"in",
"association",
"for",
"computa",
"tional",
"linguistics",
"acl",
"pages",
"1870",
"1879",
"rajarshi",
"das",
"shehzaad",
"dhuliawala",
"manzil",
"zaheer",
"and",
"andrew",
"mccallum",
"2019",
"multi",
"step",
"retriever",
"reader",
"interaction",
"for",
"scalable",
"open",
"domain",
"question",
"answering",
"in",
"international",
"conference",
"on",
"learn",
"ing",
"representations",
"iclr",
"scott",
"deerwester",
"susan",
"t",
"dumais",
"george",
"w",
"fur",
"nas",
"thomas",
"k",
"landauer",
"and",
"richard",
"harshman",
"1990",
"indexing",
"by",
"latent",
"semantic",
"analysis",
"jour",
"nal",
"of",
"the",
"american",
"society",
"for",
"information",
"science",
"41",
"6",
"391",
"407",
"jacob",
"devlin",
"ming",
"wei",
"chang",
"kenton",
"lee",
"and",
"kristina",
"toutanova",
"2019",
"bert",
"pre",
"training",
"of",
"deep",
"bidirectional",
"transformers",
"for",
"language",
"under",
"standing",
"in",
"north",
"american",
"association",
"for",
"com",
"putational",
"linguistics",
"naacl",
"david",
"a",
"ferrucci",
"2012",
"introduction",
"to",
"this",
"is",
"wat",
"son",
"ibm",
"journal",
"of",
"research",
"and",
"development",
"56",
"3",
"4",
"1",
"1",
"daniel",
"gillick",
"sayali",
"kulkarni",
"larry",
"lansing",
"alessandro",
"presta",
"jason",
"baldridge",
"eugene",
"ie",
"and",
"diego",
"garcia",
"olano",
"2019",
"learning",
"dense",
"repre",
"sentations",
"for",
"entity",
"retrieval",
"in",
"computational",
"nat",
"ural",
"language",
"learning",
"conll",
"ruiqi",
"guo",
"sanjiv",
"kumar",
"krzysztof",
"choromanski",
"and",
"david",
"simcha",
"2016",
"quantization",
"based",
"fast",
"inner",
"product",
"search",
"in",
"intelligence",
"and",
"statis",
"tics",
"pages",
"482",
"490",
"kelvin",
"guu",
"kenton",
"lee",
"zora",
"tung",
"panupong",
"pa",
"supat",
"and",
"ming",
"wei",
"chang",
"2020",
"realm",
"retrieval",
"augmented",
"language",
"model",
"pre",
"training",
"arxiv",
"abs",
"2002",
"08909"
],
[
"2016",
"quantization",
"based",
"fast",
"inner",
"product",
"search",
"in",
"intelligence",
"and",
"statis",
"tics",
"pages",
"482",
"490",
"kelvin",
"guu",
"kenton",
"lee",
"zora",
"tung",
"panupong",
"pa",
"supat",
"and",
"ming",
"wei",
"chang",
"2020",
"realm",
"retrieval",
"augmented",
"language",
"model",
"pre",
"training",
"arxiv",
"abs",
"2002",
"08909",
"matthew",
"henderson",
"rami",
"al",
"rfou",
"brian",
"strope",
"yun",
"hsuan",
"sung",
"l",
"aszl",
"o",
"luk",
"acs",
"ruiqi",
"guo",
"sanjiv",
"ku",
"mar",
"balint",
"miklos",
"and",
"ray",
"kurzweil",
"2017",
"cient",
"natural",
"language",
"response",
"suggestion",
"for",
"smart",
"reply",
"arxiv",
"abs",
"1705",
"00652",
"po",
"sen",
"huang",
"xiaodong",
"he",
"jianfeng",
"gao",
"li",
"deng",
"alex",
"acero",
"and",
"larry",
"heck",
"2013",
"learning",
"deep",
"structured",
"semantic",
"models",
"for",
"web",
"search",
"usingclickthrough",
"data",
"in",
"acm",
"international",
"confer",
"ence",
"on",
"information",
"and",
"knowledge",
"management",
"cikm",
"pages",
"2333",
"2338",
"samuel",
"humeau",
"kurt",
"shuster",
"marie",
"anne",
"lachaux",
"and",
"jason",
"weston",
"2020",
"poly",
"encoders",
"architec",
"tures",
"and",
"pre",
"training",
"strategies",
"for",
"fast",
"and",
"accurate",
"multi",
"sentence",
"scoring",
"in",
"international",
"conference",
"on",
"learning",
"representations",
"iclr",
"gautier",
"izacard",
"and",
"edouard",
"grave",
"2020",
"leveraging",
"passage",
"retrieval",
"with",
"generative",
"models",
"for",
"open",
"do",
"main",
"question",
"answering",
"arxiv",
"abs",
"2007",
"01282",
"jeff",
"johnson",
"matthijs",
"douze",
"and",
"herv",
"e",
"j",
"egou",
"2017",
"billion",
"scale",
"similarity",
"search",
"with",
"gpus",
"arxiv",
"abs",
"1702",
"08734",
"mandar",
"joshi",
"eunsol",
"choi",
"daniel",
"weld",
"and",
"luke",
"zettlemoyer",
"2017",
"triviaqa",
"a",
"large",
"scale",
"dis",
"tantly",
"supervised",
"challenge",
"dataset",
"for",
"reading",
"com",
"prehension",
"in",
"association",
"for",
"computational",
"lin",
"guistics",
"acl",
"pages",
"1601",
"1611",
"omar",
"khattab",
"and",
"matei",
"zaharia",
"2020",
"colbert",
"and",
"effective",
"passage",
"search",
"via",
"contextu",
"alized",
"late",
"interaction",
"over",
"bert",
"in",
"acm",
"sigir",
"conference",
"on",
"research",
"and",
"development",
"in",
"infor",
"mation",
"retrieval",
"sigir",
"pages",
"39",
"48",
"brian",
"kulis",
"2013",
"metric",
"learning",
"a",
"survey",
"foun",
"dations",
"and",
"trends",
"in",
"machine",
"learning",
"5",
"4",
"287",
"364",
"tom",
"kwiatkowski",
"jennimaria",
"palomaki",
"olivia",
"red",
"michael",
"collins",
"ankur",
"parikh",
"chris",
"alberti",
"danielle",
"epstein",
"illia",
"polosukhin",
"matthew",
"kelcey",
"jacob",
"devlin",
"kenton",
"lee",
"kristina",
"n"
],
[
"foun",
"dations",
"and",
"trends",
"in",
"machine",
"learning",
"5",
"4",
"287",
"364",
"tom",
"kwiatkowski",
"jennimaria",
"palomaki",
"olivia",
"red",
"michael",
"collins",
"ankur",
"parikh",
"chris",
"alberti",
"danielle",
"epstein",
"illia",
"polosukhin",
"matthew",
"kelcey",
"jacob",
"devlin",
"kenton",
"lee",
"kristina",
"n",
"toutanova",
"llion",
"jones",
"ming",
"wei",
"chang",
"andrew",
"dai",
"jakob",
"uszkoreit",
"quoc",
"le",
"and",
"slav",
"petrov",
"2019",
"natu",
"ral",
"questions",
"a",
"benchmark",
"for",
"question",
"answering",
"research",
"transactions",
"of",
"the",
"association",
"of",
"compu",
"tational",
"linguistics",
"tacl",
"kenton",
"lee",
"ming",
"wei",
"chang",
"and",
"kristina",
"toutanova"
],
[
"domain",
"question",
"answering",
"in",
"association",
"for",
"com",
"putational",
"linguistics",
"acl",
"pages",
"6086",
"6096",
"mike",
"lewis",
"yinhan",
"liu",
"naman",
"goyal",
"mar",
"jan",
"ghazvininejad",
"abdelrahman",
"mohamed",
"omer",
"levy",
"veselin",
"stoyanov",
"and",
"luke",
"zettlemoyer",
"2020a",
"bart",
"denoising",
"sequence",
"to",
"sequence",
"pre",
"training",
"for",
"natural",
"language",
"generation",
"translation",
"and",
"comprehension",
"in",
"association",
"for",
"computa",
"tional",
"linguistics",
"acl",
"pages",
"7871",
"7880",
"patrick",
"lewis",
"ethan",
"perez",
"aleksandara",
"piktus",
"fabio",
"petroni",
"vladimir",
"karpukhin",
"naman",
"goyal",
"heinrich",
"k",
"uttler",
"mike",
"lewis",
"wen",
"tau",
"yih",
"tim",
"rockt",
"aschel",
"sebastian",
"riedel",
"and",
"douwe",
"kiela",
"2020b",
"retrieval",
"augmented",
"generation",
"for",
"knowledge",
"intensive",
"nlp",
"tasks",
"in",
"advances",
"in",
"neural",
"information",
"processing",
"systems",
"neurips"
],
[
"question",
"answering",
"in",
"association",
"for",
"computa",
"tional",
"linguistics",
"acl",
"pages",
"1736",
"1745",
"sewon",
"min",
"danqi",
"chen",
"hannaneh",
"hajishirzi",
"and",
"luke",
"zettlemoyer",
"2019a",
"a",
"discrete",
"hard",
"em",
"ap",
"proach",
"for",
"weakly",
"supervised",
"question",
"answering",
"inempirical",
"methods",
"in",
"natural",
"language",
"process",
"ing",
"emnlp",
"sewon",
"min",
"danqi",
"chen",
"luke",
"zettlemoyer",
"and",
"han",
"naneh",
"hajishirzi",
"2019b",
"knowledge",
"guided",
"text",
"re",
"trieval",
"and",
"reading",
"for",
"open",
"domain",
"question",
"answer",
"ing",
"arxiv",
"abs",
"1911",
"03868",
"dan",
"moldovan",
"marius",
"pas",
"ca",
"sanda",
"harabagiu",
"and",
"mihai",
"surdeanu",
"2003",
"performance",
"issues",
"and",
"er",
"ror",
"analysis",
"in",
"an",
"open",
"domain",
"question",
"answering",
"system",
"acm",
"transactions",
"on",
"information",
"systems",
"tois",
"21",
"2",
"133",
"154",
"stephen",
"mussmann",
"and",
"stefano",
"ermon",
"2016",
"learn",
"ing",
"and",
"inference",
"via",
"maximum",
"inner",
"product",
"search",
"ininternational",
"conference",
"on",
"machine",
"learning",
"icml",
"pages",
"2587",
"2596",
"yixin",
"nie",
"songhe",
"wang",
"and",
"mohit",
"bansal",
"2019",
"re",
"vealing",
"the",
"importance",
"of",
"semantic",
"retrieval",
"for",
"ma",
"chine",
"reading",
"at",
"scale",
"in",
"empirical",
"methods",
"in",
"nat",
"ural",
"language",
"processing",
"emnlp",
"rodrigo",
"nogueira",
"and",
"kyunghyun",
"cho",
"2019",
"passage",
"re",
"ranking",
"with",
"bert",
"arxiv",
"abs",
"1901",
"04085",
"colin",
"raffel",
"noam",
"shazeer",
"adam",
"roberts",
"katherine",
"lee",
"sharan",
"narang",
"michael",
"matena",
"yanqi",
"zhou",
"wei",
"li",
"and",
"peter",
"j",
"liu",
"2019",
"exploring",
"the",
"limits",
"of",
"transfer",
"learning",
"with",
"a",
"text",
"to",
"text",
"trans",
"former",
"arxiv",
"abs",
"1910",
"10683",
"pranav",
"rajpurkar",
"jian",
"zhang",
"konstantin",
"lopyrev",
"and",
"percy",
"liang",
"2016",
"squad",
"100",
"000",
"questions",
"for",
"machine",
"comprehension",
"of",
"text",
"in",
"empirical",
"methods",
"in",
"natural",
"language",
"processing",
"emnlp",
"pages",
"2383",
"2392",
"parikshit",
"ram",
"and",
"alexander",
"g",
"gray",
"2012",
"maximum",
"inner",
"product",
"search",
"using",
"cone",
"trees",
"in",
"proceed",
"ings",
"of",
"the",
"18th",
"acm",
"sigkdd",
"international",
"con",
"ference",
"on",
"knowledge",
"discovery",
"and",
"data",
"mining",
"pages",
"931",
"939",
"adam",
"roberts",
"colin",
"raffel",
"and",
"noam",
"shazeer",
"2020",
"how",
"much",
"knowledge",
"can",
"you",
"pack",
"into",
"the",
"param",
"eters",
"of",
"a",
"language",
"model",
"arxiv",
"abs",
"2002",
"08910",
"stephen",
"robertson",
"and",
"hugo",
"zaragoza",
"2009",
"the",
"probabilistic",
"relevance",
"framework",
"bm25",
"and",
"be",
"yond",
"foundations",
"and",
"trends",
"in",
"information",
"re",
"trieval",
"3",
"4",
"333",
"389"
],
[
"2020",
"how",
"much",
"knowledge",
"can",
"you",
"pack",
"into",
"the",
"param",
"eters",
"of",
"a",
"language",
"model",
"arxiv",
"abs",
"2002",
"08910",
"stephen",
"robertson",
"and",
"hugo",
"zaragoza",
"2009",
"the",
"probabilistic",
"relevance",
"framework",
"bm25",
"and",
"be",
"yond",
"foundations",
"and",
"trends",
"in",
"information",
"re",
"trieval",
"3",
"4",
"333",
"389",
"minjoon",
"seo",
"jinhyuk",
"lee",
"tom",
"kwiatkowski",
"ankur",
"parikh",
"ali",
"farhadi",
"and",
"hannaneh",
"hajishirzi",
"2019",
"real",
"time",
"open",
"domain",
"question",
"answering",
"with",
"dense",
"sparse",
"phrase",
"index",
"in",
"association",
"for",
"com",
"putational",
"linguistics",
"acl",
"anshumali",
"shrivastava",
"and",
"ping",
"li",
"2014",
"asymmet",
"ric",
"lsh",
"alsh",
"for",
"sublinear",
"time",
"maximum",
"inner",
"product",
"search",
"mips",
"in",
"advances",
"in",
"neural",
"in",
"formation",
"processing",
"systems",
"nips",
"pages",
"2321",
"2329",
"ellen",
"m",
"v",
"oorhees",
"1999",
"the",
"trec",
"8",
"question",
"an",
"swering",
"track",
"report",
"in",
"trec",
"volume",
"99",
"pages",
"77",
"82",
"shuohang",
"wang",
"mo",
"yu",
"xiaoxiao",
"guo",
"zhiguo",
"wang",
"tim",
"klinger",
"wei",
"zhang",
"shiyu",
"chang",
"gerry",
"tesauro",
"bowen",
"zhou",
"and",
"jing",
"jiang",
"2018",
"reinforced",
"ranker",
"reader",
"for",
"open",
"domain",
"question",
"answering",
"in",
"conference",
"on",
"intelligence",
"aaai",
"zhiguo",
"wang",
"patrick",
"ng",
"xiaofei",
"ma",
"ramesh",
"nalla",
"pati",
"and",
"bing",
"xiang",
"2019",
"multi",
"passage",
"bert",
"a",
"globally",
"normalized",
"bert",
"model",
"for",
"open",
"domain",
"question",
"answering",
"in",
"empirical",
"methods",
"in",
"natu",
"ral",
"language",
"processing",
"emnlp",
"tomer",
"wolfson",
"mor",
"geva",
"ankit",
"gupta",
"matt",
"gard",
"ner",
"yoav",
"goldberg",
"daniel",
"deutch",
"and",
"jonathan",
"berant",
"2020",
"break",
"it",
"down",
"a",
"question",
"under",
"standing",
"benchmark",
"transactions",
"of",
"the",
"associa",
"tion",
"of",
"computational",
"linguistics",
"tacl",
"lee",
"xiong",
"chenyan",
"xiong",
"ye",
"li",
"kwok",
"fung",
"tang",
"jialin",
"liu",
"paul",
"bennett",
"junaid",
"ahmed",
"and",
"arnold",
"overwijk",
"2020a",
"approximate",
"nearest",
"neighbor",
"negative",
"contrastive",
"learning",
"for",
"dense",
"text",
"retrieval",
"arxiv",
"abs",
"2007",
"00808",
"wenhan",
"xiong",
"hankang",
"wang",
"and",
"william",
"yang",
"wang",
"2020b",
"progressively",
"pretrained",
"dense",
"corpus",
"index",
"for",
"open",
"domain",
"question",
"answering",
"arxiv",
"abs",
"2005",
"00038",
"wei",
"yang",
"yuqing",
"xie",
"aileen",
"lin",
"xingyu",
"li",
"luchen",
"tan",
"kun",
"xiong",
"ming",
"li",
"and",
"jimmy",
"lin",
"2019a",
"end",
"to",
"end",
"open",
"domain",
"question",
"answering",
"with",
"bertserini"
],
[
"2020b",
"progressively",
"pretrained",
"dense",
"corpus",
"index",
"for",
"open",
"domain",
"question",
"answering",
"arxiv",
"abs",
"2005",
"00038",
"wei",
"yang",
"yuqing",
"xie",
"aileen",
"lin",
"xingyu",
"li",
"luchen",
"tan",
"kun",
"xiong",
"ming",
"li",
"and",
"jimmy",
"lin",
"2019a",
"end",
"to",
"end",
"open",
"domain",
"question",
"answering",
"with",
"bertserini",
"in",
"north",
"american",
"association",
"for",
"com",
"putational",
"linguistics",
"naacl",
"pages",
"72",
"77",
"wei",
"yang",
"yuqing",
"xie",
"luchen",
"tan",
"kun",
"xiong",
"ming",
"li",
"and",
"jimmy",
"lin",
"2019b",
"data",
"augmentation",
"for",
"bert",
"tuning",
"in",
"open",
"domain",
"question",
"answering",
"arxiv",
"abs",
"1904",
"06652",
"wen",
"tau",
"yih",
"kristina",
"toutanova",
"john",
"c",
"platt",
"and",
"christopher",
"meek",
"2011",
"learning",
"discriminative",
"projections",
"for",
"text",
"similarity",
"measures",
"in",
"com",
"putational",
"natural",
"language",
"learning",
"conll",
"pages",
"247",
"256"
],
[
"a",
"distant",
"supervision",
"when",
"training",
"our",
"dpr",
"model",
"using",
"natural",
"questions",
"we",
"use",
"the",
"passages",
"in",
"our",
"collection",
"that",
"best",
"match",
"the",
"gold",
"context",
"as",
"the",
"positive",
"passages",
"as",
"some",
"qa",
"datasets",
"contain",
"only",
"the",
"question",
"and",
"answer",
"pairs",
"it",
"is",
"thus",
"interesting",
"to",
"see",
"when",
"using",
"the",
"passages",
"that",
"contain",
"the",
"answers",
"as",
"positives",
"i",
"e",
"the",
"distant",
"supervision",
"setting",
"whether",
"there",
"is",
"a",
"performance",
"degradation",
"using",
"the",
"question",
"and",
"answer",
"to",
"gether",
"as",
"the",
"query",
"we",
"run",
"lucene",
"bm25",
"and",
"pick",
"the",
"top",
"passage",
"that",
"contains",
"the",
"answer",
"as",
"the",
"pos",
"itive",
"passage",
"table",
"5",
"shows",
"the",
"performance",
"of",
"dpr",
"when",
"trained",
"using",
"the",
"original",
"setting",
"and",
"the",
"distant",
"supervision",
"setting",
"b",
"alternative",
"similarity",
"functions",
"triplet",
"loss",
"in",
"addition",
"to",
"dot",
"product",
"dp",
"and",
"negative",
"log",
"likelihood",
"based",
"on",
"softmax",
"nll",
"we",
"also",
"exper",
"iment",
"with",
"euclidean",
"distance",
"l2",
"and",
"the",
"triplet",
"loss",
"we",
"negate",
"l2",
"similarity",
"scores",
"before",
"ap",
"plying",
"softmax",
"and",
"change",
"signs",
"of",
"question",
"to",
"positive",
"and",
"question",
"to",
"negative",
"similarities",
"when",
"applying",
"the",
"triplet",
"loss",
"on",
"dot",
"product",
"scores",
"the",
"margin",
"value",
"of",
"the",
"triplet",
"loss",
"is",
"set",
"to",
"1",
"ta",
"ble",
"6",
"summarizes",
"the",
"results",
"all",
"these",
"additional",
"experiments",
"are",
"conducted",
"using",
"the",
"same",
"hyper",
"parameters",
"tuned",
"for",
"the",
"baseline",
"dp",
"nll",
"note",
"that",
"the",
"retrieval",
"accuracy",
"for",
"our",
"baseline",
"settings",
"reported",
"in",
"table",
"5",
"gold",
"and",
"table",
"6",
"dp",
"nll",
"is",
"slightly",
"better",
"than",
"those",
"reported",
"in",
"table",
"3",
"this",
"is",
"due",
"to",
"a",
"better",
"hyper",
"parameter",
"setting",
"used",
"in",
"these",
"analysis",
"experiments",
"which",
"is",
"documented",
"in",
"our",
"code",
"release",
"c",
"qualitative",
"analysis",
"although",
"dpr",
"performs",
"better",
"than",
"bm25",
"in",
"gen",
"eral",
"the",
"retrieved",
"passages",
"of",
"these",
"two",
"retrievers",
"actually",
"differ",
"qualitatively",
"methods",
"like",
"bm25",
"are",
"sensitive",
"to",
"highly",
"selective",
"keywords",
"and",
"phrases",
"but",
"cannot",
"capture",
"lexical",
"variations",
"or",
"se",
"mantic",
"relationships",
"well",
"in",
"contrast",
"dpr",
"excels",
"at",
"semantic",
"representation",
"but",
"might",
"lack",
"capacity",
"to",
"represent",
"salient",
"phrases",
"which",
"appear",
"rarely",
"table",
"7",
"illustrates",
"this",
"phenomenon",
"with",
"two",
"examples"
],
[
"in",
"contrast",
"dpr",
"excels",
"at",
"semantic",
"representation",
"but",
"might",
"lack",
"capacity",
"to",
"represent",
"salient",
"phrases",
"which",
"appear",
"rarely",
"table",
"7",
"illustrates",
"this",
"phenomenon",
"with",
"two",
"examples",
"in",
"the",
"example",
"the",
"top",
"scor",
"ing",
"passage",
"from",
"bm25",
"is",
"irrelevant",
"even",
"though",
"keywords",
"such",
"as",
"england",
"andireland",
"appear",
"mul",
"tiple",
"times",
"in",
"comparison",
"dpr",
"is",
"able",
"to",
"returntop",
"1",
"top",
"5",
"top",
"20",
"top",
"100",
"gold",
"44",
"9",
"66",
"8",
"78",
"1",
"85",
"0",
"dist",
"sup",
"43",
"9",
"65",
"3",
"77",
"1",
"84",
"4",
"table",
"5",
"retrieval",
"accuracy",
"on",
"the",
"development",
"set",
"of",
"natural",
"questions",
"trained",
"on",
"passages",
"that",
"match",
"the",
"gold",
"context",
"gold",
"or",
"the",
"top",
"bm25",
"passage",
"that",
"con",
"tains",
"the",
"answer",
"dist",
"sup",
"sim",
"loss",
"retrieval",
"accuracy",
"top",
"1",
"top",
"5",
"top",
"20",
"top",
"100",
"dpnll",
"44",
"9",
"66",
"8",
"78",
"1",
"85",
"0",
"triplet",
"41",
"6",
"65",
"0",
"77",
"2",
"84",
"5",
"l2nll",
"43",
"5",
"64",
"7",
"76",
"1",
"83",
"1",
"triplet",
"42",
"2",
"66",
"0",
"78",
"1",
"84",
"9",
"table",
"6",
"retrieval",
"top",
"kaccuracy",
"on",
"the",
"development",
"set",
"of",
"natural",
"questions",
"using",
"different",
"similarity",
"and",
"loss",
"functions",
"the",
"correct",
"answer",
"presumably",
"by",
"matching",
"body",
"of",
"water",
"with",
"semantic",
"neighbors",
"such",
"as",
"seaand",
"channel",
"even",
"though",
"no",
"lexical",
"overlap",
"exists",
"the",
"second",
"example",
"is",
"one",
"where",
"bm25",
"does",
"better",
"the",
"salient",
"phrase",
"thoros",
"of",
"myr",
"is",
"critical",
"and",
"dpr",
"is",
"unable",
"to",
"capture",
"it",
"d",
"joint",
"training",
"of",
"retriever",
"and",
"reader",
"we",
"the",
"passage",
"encoder",
"in",
"our",
"joint",
"training",
"scheme",
"while",
"allowing",
"only",
"the",
"question",
"encoder",
"to",
"receive",
"backpropagation",
"signal",
"from",
"the",
"com",
"bined",
"retriever",
"reader",
"loss",
"function",
"this",
"allows",
"us",
"to",
"leverage",
"the",
"hnsw",
"based",
"faiss",
"index",
"for",
"low",
"latency",
"retrieving",
"without",
"reindexing",
"the",
"passages",
"during",
"model",
"updates",
"our",
"loss",
"func",
"tion",
"largely",
"follows",
"orqa",
"s",
"approach",
"which",
"uses",
"log",
"probabilities",
"of",
"positive",
"passages",
"selected",
"from",
"the",
"retriever",
"model",
"and",
"correct",
"spans",
"and",
"passages",
"selected",
"from",
"the",
"reader",
"model",
"since",
"the",
"passage",
"encoder",
"is",
"we",
"could",
"use",
"larger",
"amount",
"of",
"retrieved",
"passages",
"when",
"calculating",
"the",
"retriever",
"loss"
],
[
"since",
"the",
"passage",
"encoder",
"is",
"we",
"could",
"use",
"larger",
"amount",
"of",
"retrieved",
"passages",
"when",
"calculating",
"the",
"retriever",
"loss",
"we",
"get",
"top",
"100",
"passages",
"for",
"each",
"question",
"in",
"a",
"mini",
"batch",
"and",
"use",
"the",
"method",
"similar",
"to",
"in",
"batch",
"negative",
"training",
"all",
"retrieved",
"passages",
"vectors",
"participate",
"in",
"the",
"loss",
"calculation",
"for",
"all",
"questions",
"in",
"a",
"batch",
"our",
"training",
"batch",
"size",
"is",
"set",
"to",
"16",
"which",
"effectively",
"gives",
"1",
"600",
"passages",
"per",
"question",
"to",
"calculate",
"retriever",
"loss",
"the",
"reader",
"still",
"uses",
"24",
"passages",
"per",
"question",
"which",
"are",
"selected"
],
[
"question",
"passage",
"received",
"by",
"bm25",
"passage",
"retrieved",
"by",
"dpr",
"what",
"is",
"the",
"body",
"of",
"water",
"between",
"england",
"and",
"ireland",
"title",
"british",
"cycling",
"title",
"irish",
"sea",
"england",
"is",
"not",
"recognised",
"as",
"a",
"region",
"by",
"the",
"uci",
"and",
"there",
"is",
"no",
"english",
"cycling",
"team",
"outside",
"the",
"commonwealth",
"games",
"for",
"those",
"occasions",
"british",
"cycling",
"selects",
"and",
"sup",
"ports",
"the",
"england",
"team",
"cycling",
"is",
"represented",
"on",
"the",
"isle",
"of",
"man",
"by",
"the",
"isle",
"of",
"man",
"cycling",
"association",
"cycling",
"in",
"northern",
"ireland",
"is",
"organised",
"under",
"cycling",
"ulster",
"part",
"of",
"the",
"all",
"ireland",
"governing",
"body",
"cycling",
"ireland",
"until",
"2006",
"a",
"rival",
"governing",
"body",
"existed",
"annual",
"between",
"great",
"britain",
"and",
"ireland",
"amounts",
"to",
"over",
"12",
"million",
"passengers",
"and",
"of",
"traded",
"goods",
"the",
"irish",
"sea",
"is",
"connected",
"to",
"the",
"north",
"atlantic",
"at",
"both",
"its",
"northern",
"and",
"southern",
"ends",
"to",
"the",
"north",
"the",
"connection",
"is",
"through",
"the",
"north",
"channel",
"between",
"scotland",
"and",
"northern",
"ireland",
"and",
"the",
"malin",
"sea",
"the",
"southern",
"end",
"is",
"linked",
"to",
"the",
"atlantic",
"through",
"the",
"st",
"george",
"s",
"channel",
"between",
"ireland",
"and",
"pem",
"brokeshire",
"and",
"the",
"celtic",
"sea",
"who",
"plays",
"thoros",
"of",
"myr",
"in",
"game",
"of",
"thrones",
"title",
"no",
"one",
"game",
"of",
"thrones",
"title",
"p",
"al",
"sverre",
"hagen",
"he",
"may",
"be",
"no",
"one",
"but",
"there",
"s",
"still",
"enough",
"of",
"a",
"person",
"left",
"in",
"him",
"to",
"respect",
"and",
"admire",
"who",
"this",
"girl",
"is",
"and",
"what",
"she",
"s",
"become",
"arya",
"tells",
"us",
"something",
"that",
"we",
"ve",
"kind",
"of",
"known",
"all",
"along",
"that",
"she",
"s",
"not",
"no",
"one",
"she",
"s",
"arya",
"stark",
"of",
"winterfell",
"no",
"one",
"saw",
"the",
"reintroduction",
"of",
"richard",
"dormer",
"and",
"paul",
"kaye",
"who",
"portrayed",
"beric",
"dondarrion",
"and",
"thoros",
"ofmyr",
"respectively",
"in",
"the",
"third",
"season",
"p",
"al",
"sverre",
"valheim",
"hagen",
"born",
"6",
"november",
"1980",
"is",
"a",
"nor",
"wegian",
"stage",
"and",
"screen",
"actor",
"he",
"appeared",
"in",
"the",
"norwe",
"gian",
"max",
"manus",
"and",
"played",
"thor",
"heyerdahl",
"in",
"the",
"oscar",
"nominated",
"2012",
"kon",
"tiki",
"pl",
"hagen",
"was",
"born",
"in",
"stavanger",
"norway",
"the",
"son",
"of",
"roar",
"hagen",
"a",
"norwegian",
"cartoonist",
"who",
"has",
"long",
"been",
"associated",
"with",
"norway",
"s",
"largest",
"daily",
"vg",
"he",
"lived",
"in",
"jtten",
"a",
"neighborhood",
"in",
"the",
"city",
"of",
"stavanger",
"in",
"south",
"western",
"norway"
],
[
"pl",
"hagen",
"was",
"born",
"in",
"stavanger",
"norway",
"the",
"son",
"of",
"roar",
"hagen",
"a",
"norwegian",
"cartoonist",
"who",
"has",
"long",
"been",
"associated",
"with",
"norway",
"s",
"largest",
"daily",
"vg",
"he",
"lived",
"in",
"jtten",
"a",
"neighborhood",
"in",
"the",
"city",
"of",
"stavanger",
"in",
"south",
"western",
"norway",
"table",
"7",
"examples",
"of",
"passages",
"returned",
"from",
"bm25",
"and",
"dpr",
"correct",
"answers",
"are",
"written",
"in",
"blue",
"and",
"the",
"content",
"words",
"in",
"the",
"question",
"are",
"written",
"in",
"bold",
"from",
"the",
"top",
"5",
"positive",
"and",
"top",
"30",
"negative",
"passages",
"from",
"the",
"set",
"of",
"top",
"100",
"passages",
"retrieved",
"from",
"the",
"same",
"question",
"the",
"question",
"encoder",
"s",
"initial",
"state",
"is",
"taken",
"from",
"a",
"dpr",
"model",
"previously",
"trained",
"on",
"the",
"nq",
"dataset",
"the",
"reader",
"s",
"initial",
"state",
"is",
"a",
"bert",
"base",
"model",
"in",
"terms",
"of",
"the",
"end",
"to",
"end",
"qa",
"results",
"our",
"joint",
"training",
"scheme",
"does",
"not",
"provide",
"better",
"results",
"compared",
"to",
"the",
"usual",
"retriever",
"reader",
"training",
"pipeline",
"resulting",
"in",
"the",
"same",
"39",
"8",
"exact",
"match",
"score",
"on",
"nq",
"dev",
"as",
"in",
"our",
"regular",
"reader",
"model",
"training"
],
[
"passage",
"re",
"ranking",
"with",
"bert",
"rodrigo",
"nogueira",
"new",
"york",
"university",
"rodrigonogueira",
"nyu",
"edukyunghyun",
"cho",
"new",
"york",
"university",
"facebook",
"ai",
"research",
"cifar",
"azrieli",
"global",
"scholar",
"kyunghyun",
"cho",
"nyu",
"edu"
],
[
"recently",
"neural",
"models",
"pretrained",
"on",
"a",
"language",
"modeling",
"task",
"such",
"as",
"elmo",
"peters",
"et",
"al",
"2017",
"openai",
"gpt",
"radford",
"et",
"al",
"2018",
"and",
"bert",
"de",
"vlin",
"et",
"al",
"2018",
"have",
"achieved",
"impressive",
"results",
"on",
"various",
"natural",
"language",
"processing",
"tasks",
"such",
"as",
"question",
"answering",
"and",
"natural",
"language",
"inference",
"in",
"this",
"paper",
"we",
"describe",
"a",
"simple",
"re",
"implementation",
"of",
"bert",
"for",
"query",
"based",
"pas",
"sage",
"re",
"ranking",
"our",
"system",
"is",
"the",
"state",
"of",
"the",
"art",
"on",
"the",
"trec",
"car",
"dataset",
"and",
"the",
"top",
"entry",
"in",
"the",
"leaderboard",
"of",
"the",
"ms",
"marco",
"passage",
"retrieval",
"task",
"outper",
"forming",
"the",
"previous",
"state",
"of",
"the",
"art",
"by",
"27",
"relative",
"in",
"mrr",
"10",
"the",
"code",
"to",
"reproduce",
"our",
"results",
"is",
"available",
"at",
"https",
"github",
"com",
"nyu",
"dl",
"dl4marco",
"bert",
"1",
"i",
"ntroduction",
"we",
"have",
"seen",
"rapid",
"progress",
"in",
"machine",
"reading",
"compression",
"in",
"recent",
"years",
"with",
"the",
"introduction",
"of",
"large",
"scale",
"datasets",
"such",
"as",
"squad",
"rajpurkar",
"et",
"al",
"2016",
"ms",
"marco",
"nguyen",
"et",
"al",
"2016",
"searchqa",
"dunn",
"et",
"al",
"2017",
"triviaqa",
"joshi",
"et",
"al",
"2017",
"and",
"quasar",
"t",
"dhingra",
"et",
"al",
"2017",
"and",
"the",
"broad",
"adoption",
"of",
"neural",
"models",
"such",
"as",
"bidaf",
"seo",
"et",
"al",
"2016",
"drqa",
"chen",
"et",
"al",
"2017",
"documentqa",
"clark",
"gardner",
"2017",
"and",
"qanet",
"yu",
"et",
"al",
"2018",
"the",
"information",
"retrieval",
"ir",
"community",
"has",
"also",
"experienced",
"a",
"development",
"of",
"neural",
"ranking",
"models",
"such",
"as",
"drmm",
"guo",
"et",
"al",
"2016",
"knrm",
"xiong",
"et",
"al",
"2017",
"co",
"pacrr",
"hui",
"et",
"al",
"2018",
"and",
"duet",
"mitra",
"et",
"al",
"2017",
"however",
"until",
"recently",
"there",
"were",
"only",
"a",
"few",
"large",
"datasets",
"for",
"passage",
"ranking",
"with",
"the",
"notable",
"exception",
"of",
"the",
"trec",
"car",
"dietz",
"et",
"al",
"2017",
"this",
"at",
"least",
"in",
"part",
"prevented",
"the",
"neural",
"ranking",
"models",
"from",
"being",
"successful",
"when",
"compared",
"to",
"more",
"classical",
"ir",
"techniques",
"lin",
"2019",
"we",
"argue",
"that",
"the",
"same",
"two",
"ingredients",
"that",
"made",
"possible",
"much",
"progress",
"on",
"the",
"reading",
"compre",
"hension",
"task",
"are",
"now",
"available",
"for",
"passage",
"ranking",
"task"
],
[
"we",
"argue",
"that",
"the",
"same",
"two",
"ingredients",
"that",
"made",
"possible",
"much",
"progress",
"on",
"the",
"reading",
"compre",
"hension",
"task",
"are",
"now",
"available",
"for",
"passage",
"ranking",
"task",
"namely",
"the",
"ms",
"marco",
"passage",
"ranking",
"dataset",
"which",
"contains",
"one",
"million",
"queries",
"from",
"real",
"users",
"and",
"their",
"respective",
"relevant",
"passages",
"annotated",
"by",
"humans",
"and",
"bert",
"a",
"powerful",
"general",
"purpose",
"natural",
"language",
"processing",
"model",
"in",
"this",
"paper",
"we",
"describe",
"in",
"detail",
"how",
"we",
"have",
"re",
"purposed",
"bert",
"as",
"a",
"passage",
"re",
"ranker",
"and",
"achieved",
"state",
"of",
"the",
"art",
"results",
"on",
"the",
"ms",
"marco",
"passage",
"re",
"ranking",
"task",
"2",
"p",
"assage",
"re",
"ranking",
"with",
"bert",
"task",
"a",
"simple",
"question",
"answering",
"pipeline",
"consists",
"of",
"three",
"main",
"stages",
"first",
"a",
"large",
"number",
"for",
"example",
"a",
"thousand",
"of",
"possibly",
"relevant",
"documents",
"to",
"a",
"given",
"question",
"are",
"retrieved",
"from",
"a",
"corpus",
"by",
"a",
"standard",
"mechanism",
"such",
"as",
"bm25",
"in",
"the",
"second",
"stage",
"passage",
"re",
"ranking",
"each",
"of",
"these",
"documents",
"is",
"scored",
"and",
"re",
"ranked",
"by",
"a",
"more",
"computationally",
"intensive",
"method",
"finally",
"the",
"top",
"ten",
"or",
"of",
"these",
"documents",
"will",
"be",
"the",
"source",
"for",
"the",
"candidate",
"answers",
"by",
"an",
"answer",
"generation",
"module",
"in",
"this",
"paper",
"we",
"describe",
"how",
"we",
"implemented",
"the",
"second",
"stage",
"of",
"this",
"pipeline",
"passage",
"re",
"ranking",
"method",
"the",
"job",
"of",
"the",
"re",
"ranker",
"is",
"to",
"estimate",
"a",
"score",
"siof",
"how",
"relevant",
"a",
"candidate",
"passage",
"diis",
"to",
"a",
"query",
"q",
"we",
"use",
"bert",
"as",
"our",
"re",
"ranker",
"using",
"the",
"same",
"notation",
"used",
"by",
"devlin",
"et",
"al",
"1arxiv",
"1901",
"04085v5",
"cs",
"ir",
"14",
"apr",
"2020"
],
[
"2018",
"we",
"feed",
"the",
"query",
"as",
"sentence",
"a",
"and",
"the",
"passage",
"text",
"as",
"sentence",
"b",
"we",
"truncate",
"the",
"query",
"to",
"have",
"at",
"most",
"64",
"tokens",
"we",
"also",
"truncate",
"the",
"passage",
"text",
"such",
"that",
"the",
"concatenation",
"of",
"query",
"passage",
"and",
"separator",
"tokens",
"have",
"the",
"maximum",
"length",
"of",
"512",
"tokens",
"we",
"use",
"a",
"bert",
"large",
"model",
"as",
"a",
"binary",
"model",
"that",
"is",
"we",
"use",
"the",
"cls",
"vector",
"as",
"input",
"to",
"a",
"single",
"layer",
"neural",
"network",
"to",
"obtain",
"the",
"probability",
"of",
"the",
"passage",
"being",
"relevant",
"we",
"compute",
"this",
"probability",
"for",
"each",
"passage",
"independently",
"and",
"obtain",
"the",
"list",
"of",
"passages",
"by",
"ranking",
"them",
"with",
"respect",
"to",
"these",
"probabilities",
"we",
"start",
"training",
"from",
"a",
"pre",
"trained",
"bert",
"model",
"and",
"tune",
"it",
"to",
"our",
"re",
"ranking",
"task",
"using",
"the",
"cross",
"entropy",
"loss",
"l",
"j",
"jposlog",
"sj",
"j",
"jneglog",
"1",
"sj",
"1",
"wherejposis",
"the",
"set",
"of",
"indexes",
"of",
"the",
"relevant",
"passages",
"and",
"jnegis",
"the",
"set",
"of",
"indexes",
"of",
"non",
"relevant",
"passages",
"in",
"top",
"1",
"000",
"documents",
"retrieved",
"with",
"bm25",
"3",
"e",
"xperiments",
"we",
"train",
"and",
"evaluate",
"our",
"models",
"on",
"two",
"passage",
"ranking",
"datasets",
"ms",
"marco",
"and",
"trec",
"car",
"3",
"1",
"ms",
"marco",
"the",
"training",
"set",
"contains",
"approximately",
"400m",
"tuples",
"of",
"a",
"query",
"relevant",
"and",
"non",
"relevant",
"passages",
"the",
"development",
"set",
"contains",
"approximately",
"6",
"900",
"queries",
"each",
"paired",
"with",
"the",
"top",
"1",
"000",
"pas",
"sages",
"retrieved",
"with",
"bm25",
"from",
"the",
"ms",
"marco",
"corpus",
"on",
"average",
"each",
"query",
"has",
"one",
"relevant",
"passage",
"however",
"some",
"have",
"no",
"relevant",
"passage",
"because",
"the",
"corpus",
"was",
"initially",
"constructed",
"by",
"retrieving",
"the",
"top",
"10",
"passages",
"from",
"the",
"bing",
"search",
"engine",
"and",
"then",
"annotated",
"hence",
"some",
"of",
"the",
"relevant",
"passages",
"might",
"not",
"be",
"retrieved",
"by",
"bm25",
"an",
"evaluation",
"set",
"with",
"approximately",
"6",
"800",
"queries",
"and",
"their",
"top",
"1",
"000",
"retrieved",
"passages",
"without",
"relevance",
"annotations",
"is",
"also",
"provided",
"training",
"we",
"tune",
"the",
"model",
"using",
"a",
"tpu",
"v3",
"81with",
"a",
"batch",
"size",
"of",
"128",
"128",
"sequences",
"512",
"tokens",
"65",
"536",
"tokens",
"batch",
"for",
"100k",
"iterations",
"which",
"takes",
"approximately",
"30",
"hours",
"this",
"corresponds",
"to",
"training",
"on",
"12",
"8m",
"100k",
"128",
"query",
"passage",
"pairs",
"or",
"less",
"than",
"2",
"of",
"the",
"full",
"training",
"set"
],
[
"this",
"corresponds",
"to",
"training",
"on",
"12",
"8m",
"100k",
"128",
"query",
"passage",
"pairs",
"or",
"less",
"than",
"2",
"of",
"the",
"full",
"training",
"set",
"we",
"could",
"not",
"see",
"any",
"improvement",
"in",
"the",
"dev",
"set",
"when",
"training",
"for",
"another",
"3",
"days",
"which",
"equivalent",
"to",
"seeing",
"50m",
"pairs",
"in",
"total",
"we",
"use",
"adam",
"kingma",
"ba",
"2014",
"with",
"the",
"initial",
"learning",
"rate",
"set",
"to",
"3",
"10",
"6",
"0",
"9",
"0",
"999",
"l2",
"weight",
"decay",
"of",
"0",
"01",
"learning",
"rate",
"warmup",
"over",
"the",
"10",
"000",
"steps",
"and",
"linear",
"decay",
"of",
"the",
"learning",
"rate",
"we",
"use",
"a",
"dropout",
"probability",
"of",
"0",
"1on",
"all",
"layers",
"3",
"2",
"trec",
"car",
"introduced",
"by",
"dietz",
"et",
"al",
"2017",
"in",
"this",
"dataset",
"the",
"input",
"query",
"is",
"the",
"concatenation",
"of",
"a",
"wikipedia",
"article",
"title",
"with",
"the",
"title",
"of",
"one",
"of",
"its",
"section",
"the",
"relevant",
"passages",
"are",
"the",
"paragraphs",
"within",
"that",
"section",
"the",
"corpus",
"consists",
"of",
"all",
"of",
"the",
"english",
"wikipedia",
"paragraphs",
"except",
"the",
"abstracts",
"the",
"released",
"dataset",
"has",
"folds",
"and",
"we",
"use",
"the",
"four",
"as",
"a",
"training",
"set",
"approximately",
"2",
"3m",
"queries",
"and",
"the",
"remaining",
"as",
"a",
"validation",
"set",
"approximately",
"580k",
"queries",
"the",
"test",
"set",
"is",
"the",
"same",
"one",
"used",
"to",
"evaluate",
"the",
"submissions",
"to",
"trec",
"car",
"2017",
"approx",
"2",
"254",
"queries",
"although",
"trec",
"car",
"2017",
"organizers",
"provide",
"manual",
"annotations",
"for",
"the",
"test",
"set",
"only",
"the",
"top",
"passages",
"retrieved",
"by",
"the",
"systems",
"submitted",
"to",
"the",
"competition",
"have",
"manual",
"annotations",
"this",
"means",
"that",
"true",
"relevant",
"passages",
"are",
"not",
"annotated",
"if",
"they",
"rank",
"low",
"hence",
"we",
"evaluate",
"using",
"the",
"automatic",
"annotations",
"which",
"provide",
"relevance",
"scores",
"for",
"all",
"possible",
"query",
"passage",
"pairs",
"training",
"we",
"follow",
"the",
"same",
"procedure",
"described",
"for",
"the",
"ms",
"marco",
"dataset",
"to",
"tune",
"our",
"models",
"on",
"trec",
"car",
"however",
"there",
"is",
"an",
"important",
"difference",
"the",
"pre",
"trained",
"bert",
"1https",
"cloud",
"google",
"com",
"tpu",
"2"
],
[
"ms",
"marco",
"trec",
"car",
"mrr",
"10",
"map",
"method",
"dev",
"eval",
"test",
"bm25",
"lucene",
"no",
"tuning",
"16",
"7",
"16",
"5",
"12",
"3",
"bm25",
"anserini",
"tuned",
"15",
"3",
"co",
"pacrr",
"macavaney",
"et",
"al",
"2017",
"14",
"8",
"knrm",
"xiong",
"et",
"al",
"2017",
"21",
"8",
"19",
"8",
"conv",
"knrm",
"dai",
"et",
"al",
"2018",
"29",
"0",
"27",
"1",
"irnet",
"27",
"8",
"28",
"1",
"bert",
"base",
"34",
"7",
"31",
"0",
"bert",
"large",
"36",
"5",
"35",
"8",
"33",
"5",
"table",
"1",
"main",
"result",
"on",
"the",
"passage",
"re",
"ranking",
"datasets",
"best",
"entry",
"in",
"the",
"trec",
"car",
"2017",
"previous",
"sota",
"in",
"the",
"ms",
"marco",
"leaderboard",
"as",
"of",
"01",
"04",
"2019",
"unpublished",
"work",
"number",
"of",
"training",
"question",
"passage",
"pairsmrr",
"10",
"00",
"10",
"20",
"30",
"4",
"1k",
"10k",
"100k",
"1m",
"10m",
"100mbert",
"large",
"ir",
"net",
"previous",
"sota",
"figure",
"1",
"number",
"of",
"ms",
"marco",
"examples",
"seen",
"during",
"training",
"vs",
"mrr",
"10",
"performance",
"models2were",
"pre",
"trained",
"on",
"the",
"full",
"wikipedia",
"and",
"therefore",
"they",
"have",
"seen",
"although",
"in",
"an",
"unsu",
"pervised",
"way",
"wikipedia",
"documents",
"that",
"are",
"used",
"in",
"the",
"test",
"set",
"of",
"trec",
"car",
"thus",
"to",
"avoid",
"this",
"leak",
"of",
"test",
"data",
"into",
"training",
"we",
"pre",
"trained",
"the",
"bert",
"re",
"ranker",
"only",
"on",
"the",
"half",
"of",
"wikipedia",
"used",
"by",
"trec",
"car",
"s",
"training",
"set",
"for",
"the",
"tuning",
"data",
"we",
"generate",
"our",
"query",
"passage",
"pairs",
"by",
"retrieving",
"the",
"top",
"ten",
"passages",
"from",
"the",
"entire",
"trec",
"car",
"corpus",
"using",
"bm25",
"3this",
"means",
"that",
"we",
"end",
"up",
"with",
"30m",
"example",
"pairs",
"3m",
"queries",
"10",
"passages",
"query",
"to",
"train",
"our",
"model",
"we",
"train",
"it",
"for",
"400k",
"iterations",
"or",
"12",
"8m",
"examples",
"400k",
"iterations",
"32",
"pairs",
"batch",
"which",
"corresponds",
"to",
"only",
"40",
"of",
"the",
"training",
"set",
"similarly",
"to",
"ms",
"marco",
"experiments",
"we",
"did",
"not",
"see",
"any",
"gain",
"on",
"the",
"dev",
"set",
"by",
"training",
"the",
"models",
"longer",
"3",
"3",
"r",
"esults",
"we",
"show",
"the",
"main",
"result",
"in",
"table",
"1",
"despite",
"training",
"on",
"a",
"fraction",
"of",
"the",
"data",
"available",
"the",
"proposed",
"bert",
"based",
"models",
"surpass",
"the",
"previous",
"state",
"of",
"the",
"art",
"models",
"by",
"a",
"large",
"margin",
"on",
"both",
"of",
"the",
"tasks",
"training",
"size",
"vs",
"performance",
"we",
"found",
"that",
"the",
"pretrained",
"models",
"used",
"in",
"this",
"work",
"require",
"few",
"training",
"examples",
"from",
"the",
"end",
"task",
"to",
"achieve",
"a",
"good",
"performance",
"1",
"for",
"example",
"a",
"bert",
"large",
"trained",
"on",
"100k",
"question",
"passage",
"pairs",
"less",
"than",
"0",
"3",
"of",
"the",
"ms",
"marco",
"training",
"data",
"is",
"already",
"1",
"4",
"mrr",
"10",
"points",
"better",
"than",
"the",
"previous",
"state",
"of",
"the",
"art",
"ir",
"net"
],
[
"for",
"example",
"a",
"bert",
"large",
"trained",
"on",
"100k",
"question",
"passage",
"pairs",
"less",
"than",
"0",
"3",
"of",
"the",
"ms",
"marco",
"training",
"data",
"is",
"already",
"1",
"4",
"mrr",
"10",
"points",
"better",
"than",
"the",
"previous",
"state",
"of",
"the",
"art",
"ir",
"net",
"2https",
"github",
"com",
"google",
"research",
"bert",
"3we",
"use",
"the",
"anserini",
"toolkit",
"yang",
"et",
"al",
"2018",
"to",
"index",
"and",
"retrieve",
"the",
"passages",
"3"
],
[
"4",
"c",
"onclusion",
"we",
"have",
"described",
"a",
"simple",
"adaptation",
"of",
"bert",
"as",
"a",
"passage",
"re",
"ranker",
"that",
"has",
"become",
"the",
"state",
"of",
"the",
"art",
"on",
"two",
"different",
"tasks",
"which",
"are",
"trec",
"car",
"and",
"ms",
"marco",
"we",
"have",
"made",
"the",
"code",
"to",
"reproduce",
"our",
"experiments",
"publicly",
"available"
],
[
"danqi",
"chen",
"adam",
"fisch",
"jason",
"weston",
"and",
"antoine",
"bordes",
"reading",
"wikipedia",
"to",
"answer",
"open",
"domain",
"questions",
"arxiv",
"preprint",
"arxiv",
"1704",
"00051",
"2017",
"christopher",
"clark",
"and",
"matt",
"gardner",
"simple",
"and",
"effective",
"multi",
"paragraph",
"reading",
"comprehension",
"arxiv",
"preprint",
"arxiv",
"1710",
"10723",
"2017",
"zhuyun",
"dai",
"chenyan",
"xiong",
"jamie",
"callan",
"and",
"zhiyuan",
"liu",
"convolutional",
"neural",
"networks",
"for",
"soft",
"matching",
"n",
"grams",
"in",
"ad",
"hoc",
"search",
"in",
"proceedings",
"of",
"the",
"eleventh",
"acm",
"international",
"con",
"ference",
"on",
"web",
"search",
"and",
"data",
"mining",
"pp",
"126",
"134",
"acm",
"2018",
"jacob",
"devlin",
"ming",
"wei",
"chang",
"kenton",
"lee",
"and",
"kristina",
"toutanova",
"bert",
"pre",
"training",
"of",
"deep",
"bidirectional",
"transformers",
"for",
"language",
"understanding",
"arxiv",
"preprint",
"arxiv",
"1810",
"04805",
"2018",
"bhuwan",
"dhingra",
"kathryn",
"mazaitis",
"and",
"william",
"w",
"cohen",
"quasar",
"datasets",
"for",
"question",
"answer",
"ing",
"by",
"search",
"and",
"reading",
"arxiv",
"preprint",
"arxiv",
"1707",
"03904",
"2017",
"laura",
"dietz",
"manisha",
"verma",
"filip",
"radlinski",
"and",
"nick",
"craswell",
"trec",
"complex",
"answer",
"retrieval",
"overview",
"trec",
"2017",
"matthew",
"dunn",
"levent",
"sagun",
"mike",
"higgins",
"v",
"ugur",
"guney",
"v",
"olkan",
"cirik",
"and",
"kyunghyun",
"cho",
"searchqa",
"a",
"new",
"q",
"a",
"dataset",
"augmented",
"with",
"context",
"from",
"a",
"search",
"engine",
"arxiv",
"preprint",
"arxiv",
"1704",
"05179",
"2017",
"jiafeng",
"guo",
"yixing",
"fan",
"qingyao",
"ai",
"and",
"w",
"bruce",
"croft",
"a",
"deep",
"relevance",
"matching",
"model",
"for",
"ad",
"hoc",
"retrieval",
"in",
"proceedings",
"of",
"the",
"25th",
"acm",
"international",
"on",
"conference",
"on",
"information",
"and",
"knowledge",
"management",
"pp",
"55",
"64",
"acm",
"2016",
"kai",
"hui",
"andrew",
"yates",
"klaus",
"berberich",
"and",
"gerard",
"de",
"melo",
"co",
"pacrr",
"a",
"context",
"aware",
"neural",
"ir",
"model",
"for",
"ad",
"hoc",
"retrieval",
"in",
"proceedings",
"of",
"the",
"eleventh",
"acm",
"international",
"conference",
"on",
"web",
"search",
"and",
"data",
"mining",
"pp",
"279",
"287",
"acm",
"2018",
"mandar",
"joshi",
"eunsol",
"choi",
"daniel",
"s",
"weld",
"and",
"luke",
"zettlemoyer",
"triviaqa",
"a",
"large",
"scale",
"distantly",
"supervised",
"challenge",
"dataset",
"for",
"reading",
"comprehension",
"arxiv",
"preprint",
"arxiv",
"1705",
"03551",
"2017",
"diederik",
"p",
"kingma",
"and",
"jimmy",
"ba",
"adam",
"a",
"method",
"for",
"stochastic",
"optimization",
"arxiv",
"preprint",
"arxiv",
"1412",
"6980",
"2014",
"jimmy",
"lin",
"the",
"neural",
"hype",
"and",
"comparisons",
"against",
"weak",
"baseline",
"2019",
"sean",
"macavaney",
"andrew",
"yates",
"and",
"kai",
"hui",
"contextualized",
"pacrr",
"for",
"complex",
"answer",
"retrieval",
"2017"
],
[
"adam",
"a",
"method",
"for",
"stochastic",
"optimization",
"arxiv",
"preprint",
"arxiv",
"1412",
"6980",
"2014",
"jimmy",
"lin",
"the",
"neural",
"hype",
"and",
"comparisons",
"against",
"weak",
"baseline",
"2019",
"sean",
"macavaney",
"andrew",
"yates",
"and",
"kai",
"hui",
"contextualized",
"pacrr",
"for",
"complex",
"answer",
"retrieval",
"2017",
"bhaskar",
"mitra",
"fernando",
"diaz",
"and",
"nick",
"craswell",
"learning",
"to",
"match",
"using",
"local",
"and",
"distributed",
"representations",
"of",
"text",
"for",
"web",
"search",
"in",
"proceedings",
"of",
"the",
"26th",
"international",
"conference",
"on",
"world",
"wide",
"web",
"pp",
"1291",
"1299",
"international",
"world",
"wide",
"web",
"conferences",
"steering",
"commit",
"tee",
"2017",
"tri",
"nguyen",
"mir",
"rosenberg",
"xia",
"song",
"jianfeng",
"gao",
"saurabh",
"tiwary",
"rangan",
"majumder",
"and",
"li",
"deng",
"ms",
"marco",
"a",
"human",
"generated",
"machine",
"reading",
"comprehension",
"dataset",
"arxiv",
"preprint",
"arxiv",
"1611",
"09268",
"2016",
"matthew",
"e",
"peters",
"waleed",
"ammar",
"chandra",
"bhagavatula",
"and",
"russell",
"power",
"semi",
"supervised",
"sequence",
"tagging",
"with",
"bidirectional",
"language",
"models",
"arxiv",
"preprint",
"arxiv",
"1705",
"00108",
"2017",
"4"
],
[
"alec",
"radford",
"karthik",
"narasimhan",
"tim",
"salimans",
"and",
"ilya",
"sutskever",
"improving",
"language",
"un",
"derstanding",
"by",
"generative",
"pre",
"training",
"url",
"https",
"s3",
"us",
"west",
"2",
"amazonaws",
"com",
"openai",
"assets",
"research",
"covers",
"language",
"unsupervised",
"language",
"understanding",
"paper",
"pdf",
"2018",
"pranav",
"rajpurkar",
"jian",
"zhang",
"konstantin",
"lopyrev",
"and",
"percy",
"liang",
"squad",
"100",
"000",
"questions",
"for",
"machine",
"comprehension",
"of",
"text",
"arxiv",
"preprint",
"arxiv",
"1606",
"05250",
"2016",
"minjoon",
"seo",
"aniruddha",
"kembhavi",
"ali",
"farhadi",
"and",
"hannaneh",
"hajishirzi",
"bidirectional",
"attention",
"for",
"machine",
"comprehension",
"arxiv",
"preprint",
"arxiv",
"1611",
"01603",
"2016",
"chenyan",
"xiong",
"zhuyun",
"dai",
"jamie",
"callan",
"zhiyuan",
"liu",
"and",
"russell",
"power",
"end",
"to",
"end",
"neural",
"ad",
"hoc",
"ranking",
"with",
"kernel",
"pooling",
"in",
"proceedings",
"of",
"the",
"40th",
"international",
"acm",
"sigir",
"conference",
"on",
"research",
"and",
"development",
"in",
"information",
"retrieval",
"pp",
"55",
"64",
"acm",
"2017",
"peilin",
"yang",
"hui",
"fang",
"and",
"jimmy",
"lin",
"anserini",
"reproducible",
"ranking",
"baselines",
"using",
"lucene",
"journal",
"of",
"data",
"and",
"information",
"quality",
"jdiq",
"10",
"4",
"16",
"2018",
"adams",
"wei",
"yu",
"david",
"dohan",
"minh",
"thang",
"luong",
"rui",
"zhao",
"kai",
"chen",
"mohammad",
"norouzi",
"and",
"quoc",
"v",
"le",
"qanet",
"combining",
"local",
"convolution",
"with",
"global",
"self",
"attention",
"for",
"reading",
"compre",
"hension",
"arxiv",
"preprint",
"arxiv",
"1804",
"09541",
"2018",
"5"
],
[
"precise",
"zero",
"shot",
"dense",
"retrieval",
"without",
"relevance",
"labels",
"luyu",
"gao",
"xueguang",
"ma",
"jimmy",
"lin",
"jamie",
"callan",
"language",
"technologies",
"institute",
"carnegie",
"mellon",
"university",
"david",
"r",
"cheriton",
"school",
"of",
"computer",
"science",
"university",
"of",
"waterloo",
"luyug",
"callan",
"cs",
"cmu",
"edu",
"x93ma",
"jimmylin",
"uwaterloo",
"ca",
"abstract",
"while",
"dense",
"retrieval",
"has",
"been",
"shown",
"effec",
"tive",
"and",
"across",
"tasks",
"and",
"languages",
"it",
"remains",
"to",
"create",
"effective",
"fully",
"zero",
"shot",
"dense",
"retrieval",
"systems",
"when",
"no",
"rel",
"evance",
"label",
"is",
"available",
"in",
"this",
"paper",
"we",
"recognize",
"the",
"of",
"zero",
"shot",
"learning",
"and",
"encoding",
"relevance",
"instead",
"we",
"pro",
"pose",
"to",
"pivot",
"through",
"hy",
"pothetical",
"d",
"ocument",
"embeddings",
"hyde",
"given",
"a",
"query",
"hyde",
"zero",
"shot",
"instructs",
"an",
"instruction",
"following",
"language",
"model",
"e",
"g",
"instructgpt",
"to",
"gen",
"erate",
"a",
"hypothetical",
"document",
"the",
"docu",
"ment",
"captures",
"relevance",
"patterns",
"but",
"is",
"unreal",
"and",
"may",
"contain",
"false",
"details",
"then",
"an",
"un",
"supervised",
"contrastively",
"learned",
"encoder",
"e",
"g",
"contriever",
"encodes",
"the",
"document",
"into",
"an",
"embedding",
"vector",
"this",
"vector",
"a",
"neighborhood",
"in",
"the",
"corpus",
"embedding",
"space",
"where",
"similar",
"real",
"documents",
"are",
"retrieved",
"based",
"on",
"vector",
"similarity",
"this",
"second",
"step",
"ground",
"the",
"generated",
"document",
"to",
"the",
"actual",
"corpus",
"with",
"the",
"encoder",
"s",
"dense",
"bottleneck",
"out",
"the",
"incorrect",
"details",
"our",
"exper",
"iments",
"show",
"that",
"hyde",
"outper",
"forms",
"the",
"state",
"of",
"the",
"art",
"unsupervised",
"dense",
"retriever",
"contriever",
"and",
"shows",
"strong",
"per",
"formance",
"comparable",
"to",
"tuned",
"retrievers",
"across",
"various",
"tasks",
"e",
"g",
"web",
"search",
"qa",
"fact",
"and",
"languages",
"e",
"g",
"sw",
"ko",
"ja",
"1",
"1",
"introduction",
"dense",
"retrieval",
"lee",
"et",
"al",
"2019",
"karpukhin",
"et",
"al",
"2020",
"the",
"method",
"of",
"retrieving",
"documents",
"using",
"semantic",
"embedding",
"similarities",
"has",
"been",
"shown",
"successful",
"across",
"tasks",
"like",
"web",
"search",
"question",
"answering",
"and",
"fact",
"a",
"variety",
"of",
"meth",
"ods",
"such",
"as",
"negative",
"mining",
"xiong",
"et",
"al",
"2021",
"qu",
"et",
"al",
"2021",
"distillation",
"qu",
"et",
"al",
"2021",
"lin",
"et",
"al",
"2021b",
"et",
"al",
"2021",
"and",
"task",
"equal",
"contribution"
],
[
"a",
"variety",
"of",
"meth",
"ods",
"such",
"as",
"negative",
"mining",
"xiong",
"et",
"al",
"2021",
"qu",
"et",
"al",
"2021",
"distillation",
"qu",
"et",
"al",
"2021",
"lin",
"et",
"al",
"2021b",
"et",
"al",
"2021",
"and",
"task",
"equal",
"contribution",
"1no",
"models",
"were",
"trained",
"or",
"tuned",
"in",
"making",
"this",
"pre",
"print",
"our",
"open",
"source",
"code",
"is",
"available",
"at",
"https",
"github",
"com",
"texttron",
"hyde",
"pre",
"training",
"izacard",
"et",
"al",
"2021",
"gao",
"and",
"callan",
"2021",
"lu",
"et",
"al",
"2021",
"gao",
"and",
"callan",
"2022",
"liu",
"and",
"shao",
"2022",
"have",
"been",
"proposed",
"to",
"improve",
"the",
"effectiveness",
"of",
"supervised",
"dense",
"retrieval",
"models",
"on",
"the",
"other",
"hand",
"zero",
"shot",
"dense",
"retrieval",
"still",
"remains",
"many",
"recent",
"works",
"consider",
"the",
"alternative",
"transfer",
"learning",
"setup",
"where",
"the",
"dense",
"retrievers",
"are",
"trained",
"on",
"a",
"high",
"resource",
"dataset",
"and",
"then",
"evaluated",
"on",
"queries",
"from",
"new",
"tasks",
"the",
"ms",
"marco",
"collection",
"bajaj",
"et",
"al",
"2016",
"a",
"massive",
"judged",
"dataset",
"with",
"a",
"large",
"number",
"of",
"judged",
"query",
"document",
"pairs",
"is",
"arguably",
"the",
"most",
"commonly",
"used",
"as",
"argued",
"by",
"izacard",
"et",
"al",
"2021",
"in",
"prac",
"tice",
"however",
"the",
"existence",
"of",
"such",
"a",
"large",
"dataset",
"cannot",
"always",
"be",
"assumed",
"even",
"ms",
"marco",
"re",
"stricts",
"commercial",
"use",
"and",
"cannot",
"be",
"adopted",
"in",
"a",
"variety",
"of",
"real",
"world",
"search",
"scenarios",
"in",
"this",
"paper",
"we",
"aim",
"to",
"build",
"effective",
"fully",
"zero",
"shot",
"dense",
"retrieval",
"systems",
"that",
"require",
"no",
"relevance",
"supervision",
"work",
"out",
"of",
"box",
"and",
"gener",
"alize",
"across",
"tasks",
"as",
"supervision",
"is",
"not",
"available",
"we",
"start",
"by",
"examining",
"self",
"supervised",
"representa",
"tion",
"learning",
"methods",
"modern",
"deep",
"learning",
"en",
"ables",
"two",
"distinct",
"learning",
"algorithms",
"at",
"the",
"token",
"level",
"generative",
"large",
"language",
"models",
"llm",
"pre",
"trained",
"on",
"large",
"corpus",
"have",
"demonstrated",
"strong",
"natural",
"language",
"understanding",
"nlu",
"and",
"gen",
"eration",
"nlg",
"capabilities",
"brown",
"et",
"al",
"2020",
"chen",
"et",
"al",
"2021",
"rae",
"et",
"al",
"2021",
"hoffmann",
"et",
"al",
"2022",
"thoppilan",
"et",
"al",
"2022",
"chowdhery",
"et",
"al",
"2022",
"at",
"the",
"document",
"level",
"text",
"chunk",
"encoders",
"pre",
"trained",
"with",
"contrastive",
"objectives",
"learn",
"to",
"encode",
"document",
"document",
"similarity",
"into",
"inner",
"product",
"izacard",
"et",
"al",
"2021",
"gao",
"and",
"callan",
"2022"
],
[
"at",
"the",
"document",
"level",
"text",
"chunk",
"encoders",
"pre",
"trained",
"with",
"contrastive",
"objectives",
"learn",
"to",
"encode",
"document",
"document",
"similarity",
"into",
"inner",
"product",
"izacard",
"et",
"al",
"2021",
"gao",
"and",
"callan",
"2022",
"on",
"top",
"of",
"these",
"one",
"extra",
"insight",
"into",
"llm",
"is",
"borrowed",
"the",
"llms",
"further",
"trained",
"to",
"follow",
"instructions",
"can",
"zero",
"shot",
"generalize",
"to",
"diverse",
"un",
"seen",
"instructions",
"ouyang",
"et",
"al",
"2022",
"sanh",
"et",
"al",
"2022",
"min",
"et",
"al",
"2022",
"wei",
"et",
"al",
"2022",
"ouyang",
"et",
"al",
"2022",
"show",
"that",
"with",
"a",
"small",
"amount",
"of",
"data",
"gpt",
"3",
"brown",
"et",
"al",
"2020",
"models",
"can",
"be",
"alignedarxiv",
"2212",
"10496v1",
"cs",
"ir",
"20",
"dec",
"2022"
],
[
"hyde",
"gptcontrieverhow",
"long",
"does",
"it",
"take",
"to",
"remove",
"wisdom",
"tooth",
"it",
"usually",
"takes",
"between",
"30",
"minutes",
"and",
"two",
"hours",
"to",
"remove",
"a",
"wisdom",
"tooth",
"how",
"wisdom",
"teeth",
"are",
"removed",
"some",
"a",
"few",
"minutes",
"whereas",
"others",
"can",
"take",
"20",
"minutes",
"or",
"longer",
"how",
"has",
"the",
"covid",
"19",
"pandemic",
"impacted",
"mental",
"health",
"depression",
"and",
"anxiety",
"had",
"increased",
"by",
"20",
"since",
"the",
"start",
"of",
"the",
"pandemic",
"two",
"studies",
"investigating",
"covid",
"19",
"patients",
"significantly",
"higher",
"level",
"of",
"depressive",
"write",
"a",
"passage",
"to",
"answer",
"the",
"question",
"write",
"a",
"scientific",
"paper",
"passage",
"to",
"answer",
"the",
"question",
"write",
"a",
"passage",
"in",
"korean",
"to",
"answer",
"the",
"question",
"in",
"800",
"142",
"instruction",
"query",
"generated",
"document",
"real",
"documentfigure",
"1",
"an",
"illustration",
"of",
"the",
"hyde",
"model",
"documents",
"snippets",
"are",
"shown",
"hyde",
"serves",
"all",
"types",
"of",
"queries",
"without",
"changing",
"the",
"underlying",
"gpt",
"3",
"andcontriever",
"mcontriever",
"models",
"to",
"human",
"intent",
"to",
"follow",
"instructions",
"with",
"these",
"ingredients",
"we",
"propose",
"to",
"pivot",
"through",
"hypothetical",
"document",
"embeddings",
"hyde",
"and",
"decompose",
"dense",
"retrieval",
"into",
"two",
"tasks",
"a",
"generative",
"task",
"per",
"formed",
"by",
"an",
"instruction",
"following",
"language",
"model",
"and",
"a",
"document",
"document",
"similarity",
"task",
"performed",
"by",
"a",
"contrastive",
"encoder",
"figure",
"1",
"first",
"we",
"feed",
"the",
"query",
"to",
"the",
"generative",
"model",
"and",
"instruct",
"it",
"to",
"write",
"a",
"document",
"that",
"answers",
"the",
"question",
"i",
"e",
"a",
"hypothetical",
"document",
"we",
"expect",
"the",
"generative",
"process",
"to",
"capture",
"relevance",
"by",
"giving",
"an",
"example",
"the",
"generated",
"document",
"is",
"not",
"real",
"can",
"contain",
"factual",
"errors",
"but",
"is",
"like",
"a",
"relevant",
"document",
"in",
"the",
"second",
"step",
"we",
"use",
"an",
"unsupervised",
"contrastive",
"encoder",
"to",
"encode",
"this",
"document",
"into",
"an",
"embedding",
"vector",
"here",
"we",
"expect",
"the",
"encoder",
"s",
"dense",
"bottleneck",
"to",
"serve",
"a",
"lossy",
"compressor",
"where",
"the",
"extra",
"hallucinated",
"details",
"are",
"out",
"from",
"the",
"embedding",
"we",
"use",
"this",
"vector",
"to",
"search",
"against",
"the",
"corpus",
"embeddings",
"the",
"most",
"similar",
"real",
"documents",
"are",
"retrieved",
"and",
"returned"
],
[
"we",
"use",
"this",
"vector",
"to",
"search",
"against",
"the",
"corpus",
"embeddings",
"the",
"most",
"similar",
"real",
"documents",
"are",
"retrieved",
"and",
"returned",
"the",
"retrieval",
"leverages",
"document",
"document",
"similarity",
"encoded",
"in",
"the",
"inner",
"product",
"during",
"contrastive",
"training",
"note",
"that",
"interestingly",
"with",
"hyde",
"factorization",
"the",
"query",
"document",
"similarity",
"score",
"is",
"no",
"longer",
"explicitly",
"modeled",
"nor",
"computed",
"instead",
"the",
"retrieval",
"task",
"is",
"cast",
"into",
"two",
"nlu",
"and",
"nlg",
"tasks",
"hyde",
"appears",
"unsupervised",
"nomodel",
"is",
"trained",
"inhyde",
"both",
"the",
"generative",
"model",
"and",
"the",
"con",
"trastive",
"encoder",
"remain",
"intact",
"supervision",
"signals",
"were",
"only",
"involved",
"in",
"instruction",
"learning",
"of",
"our",
"backbone",
"llm",
"in",
"our",
"experiments",
"we",
"show",
"hyde",
"using",
"instruct",
"gpt",
"ouyang",
"et",
"al",
"2022",
"and",
"contriever",
"izacard",
"et",
"al",
"2021",
"as",
"backbone",
"models",
"out",
"performs",
"the",
"previous",
"state",
"of",
"the",
"art",
"contriever",
"only",
"zero",
"shot",
"no",
"relevance",
"system",
"on",
"11",
"queriessets",
"covering",
"tasks",
"like",
"web",
"search",
"question",
"answering",
"fact",
"and",
"languages",
"like",
"swahili",
"korean",
"japanese",
"2",
"related",
"works",
"dense",
"retrieval",
"lee",
"et",
"al",
"2019",
"karpukhin",
"et",
"al",
"2020",
"has",
"been",
"extensively",
"studied",
"after",
"the",
"emergence",
"of",
"pre",
"trained",
"transformer",
"language",
"models",
"devlin",
"et",
"al",
"2019",
"researchers",
"stud",
"ied",
"the",
"metric",
"learning",
"problems",
"such",
"as",
"training",
"loss",
"karpukhin",
"et",
"al",
"2020",
"and",
"negative",
"sam",
"pling",
"xiong",
"et",
"al",
"2021",
"qu",
"et",
"al",
"2021",
"and",
"also",
"introduced",
"distillation",
"qu",
"et",
"al",
"2021",
"lin",
"et",
"al",
"2021b",
"et",
"al",
"2021",
"later",
"works",
"studied",
"the",
"second",
"stage",
"pre",
"training",
"of",
"language",
"model",
"for",
"retrieval",
"izacard",
"et",
"al",
"2021",
"gao",
"and",
"callan",
"2021",
"lu",
"et",
"al",
"2021",
"gao",
"and",
"callan",
"2022",
"liu",
"and",
"shao",
"2022",
"the",
"popularity",
"of",
"dense",
"retrieval",
"can",
"be",
"partially",
"attributed",
"to",
"the",
"rich",
"and",
"successful",
"research",
"in",
"very",
"minimum",
"inner",
"product",
"search",
"mips",
"at",
"very",
"large",
"billion",
"scales",
"johnson",
"et",
"al",
"2017"
],
[
"the",
"popularity",
"of",
"dense",
"retrieval",
"can",
"be",
"partially",
"attributed",
"to",
"the",
"rich",
"and",
"successful",
"research",
"in",
"very",
"minimum",
"inner",
"product",
"search",
"mips",
"at",
"very",
"large",
"billion",
"scales",
"johnson",
"et",
"al",
"2017",
"instructions",
"following",
"language",
"models",
"soon",
"after",
"the",
"emergence",
"of",
"llms",
"several",
"groups",
"of",
"researchers",
"discover",
"that",
"llms",
"trained",
"on",
"data",
"consisting",
"of",
"instructions",
"and",
"their",
"execution",
"can",
"zero",
"shot",
"generalize",
"to",
"perform",
"new",
"tasks",
"with",
"new",
"instructions",
"ouyang",
"et",
"al",
"2022",
"sanh",
"et",
"al",
"2022",
"min",
"et",
"al",
"2022",
"wei",
"et",
"al",
"2022",
"this",
"can",
"be",
"done",
"by",
"standard",
"supervised",
"sequence",
"to",
"sequence",
"learning",
"or",
"more",
"effectively",
"with",
"reinforcement",
"learning",
"ouyang",
"et",
"al",
"2022",
"concurrent",
"to",
"us",
"asai",
"et",
"al",
"2022",
"studied",
"task",
"aware",
"retrieval",
"with",
"instructions",
"they",
"tuned",
"dense",
"encoders",
"that",
"can",
"also",
"encode",
"task",
"instruction",
"prepended",
"to",
"query",
"in",
"comparison",
"we",
"use",
"an",
"unsupervised",
"encoder",
"and",
"handle",
"different",
"tasks",
"and",
"their",
"instruction",
"with",
"an"
],
[
"instruction",
"following",
"generative",
"llm",
"as",
"described",
"above",
"zero",
"shot",
"dense",
"retrieval",
"the",
"tasks",
"of",
"zero",
"shot",
"dense",
"retrieval",
"are",
"arguably",
"empirically",
"de",
"by",
"thakur",
"et",
"al",
"2021",
"for",
"the",
"neural",
"re",
"trieval",
"community",
"their",
"beir",
"benchmark",
"con",
"sists",
"of",
"diverse",
"retrieval",
"tasks",
"the",
"paper",
"and",
"many",
"follow",
"up",
"research",
"generally",
"consider",
"the",
"transfer",
"learning",
"setup",
"where",
"the",
"dense",
"re",
"triever",
"is",
"learned",
"using",
"a",
"diverse",
"and",
"richly",
"supervised",
"corpus",
"and",
"query",
"collection",
"namely",
"ms",
"marco",
"thakur",
"et",
"al",
"2021",
"wang",
"et",
"al",
"2022",
"yu",
"et",
"al",
"2022",
"however",
"as",
"stated",
"by",
"izacard",
"et",
"al",
"2021",
"such",
"a",
"large",
"collection",
"can",
"rarely",
"be",
"assumed",
"in",
"this",
"paper",
"therefore",
"we",
"study",
"the",
"problem",
"of",
"building",
"effective",
"dense",
"retrieval",
"systems",
"without",
"relevance",
"labels",
"similar",
"to",
"izacard",
"et",
"al",
"2021",
"we",
"also",
"do",
"not",
"assume",
"access",
"to",
"the",
"test",
"time",
"corpora",
"for",
"training",
"this",
"is",
"a",
"more",
"realistic",
"setup",
"and",
"prevents",
"over",
"engineering",
"on",
"the",
"test",
"corpora",
"by",
"the",
"in",
"sachan",
"et",
"al",
"2022",
"our",
"setup",
"can",
"be",
"roughly",
"considered",
"as",
"unsuper",
"vised",
"strictly",
"as",
"with",
"sachan",
"et",
"al",
"2022",
"the",
"only",
"supervision",
"resides",
"in",
"the",
"llm",
"in",
"the",
"pro",
"cessing",
"of",
"learning",
"to",
"follow",
"instructions",
"generative",
"retrieval",
"generative",
"search",
"is",
"a",
"new",
"class",
"of",
"retrieval",
"methods",
"that",
"use",
"neural",
"generative",
"models",
"as",
"search",
"indices",
"metzler",
"et",
"al",
"2021",
"tay",
"et",
"al",
"2022",
"bevilacqua",
"et",
"al",
"2022",
"lee",
"et",
"al",
"2022",
"these",
"models",
"use",
"constrained",
"decoding",
"to",
"generate",
"document",
"such",
"as",
"id",
"and",
"sub",
"string",
"which",
"map",
"directly",
"to",
"realdocuments",
"they",
"have",
"to",
"go",
"through",
"special",
"training",
"procedures",
"over",
"relevance",
"data",
"effective",
"search",
"may",
"also",
"need",
"to",
"use",
"novel",
"forms",
"of",
"search",
"indices",
"bevilacqua",
"et",
"al",
"2022",
"lee",
"et",
"al",
"2022",
"in",
"comparison",
"our",
"method",
"uses",
"the",
"standard",
"mips",
"index",
"and",
"requires",
"no",
"training",
"or",
"training",
"data",
"our",
"generative",
"model",
"produces",
"an",
"intermediate",
"hypothetical",
"document",
"to",
"be",
"fed",
"into",
"a",
"dense",
"encoder",
"instead",
"of",
"a",
"real",
"document",
"3",
"methodology",
"in",
"this",
"section",
"we",
"formally",
"the",
"prob",
"lem",
"of",
"zero",
"shot",
"dense",
"retrieval"
],
[
"our",
"generative",
"model",
"produces",
"an",
"intermediate",
"hypothetical",
"document",
"to",
"be",
"fed",
"into",
"a",
"dense",
"encoder",
"instead",
"of",
"a",
"real",
"document",
"3",
"methodology",
"in",
"this",
"section",
"we",
"formally",
"the",
"prob",
"lem",
"of",
"zero",
"shot",
"dense",
"retrieval",
"then",
"we",
"will",
"introduce",
"how",
"hyde",
"is",
"designed",
"to",
"solve",
"it",
"3",
"1",
"preliminaries",
"dense",
"retrieval",
"models",
"similarity",
"between",
"query",
"and",
"document",
"with",
"inner",
"product",
"similarity",
"given",
"a",
"query",
"qand",
"document",
"d",
"it",
"uses",
"two",
"encoder",
"function",
"encqandencdto",
"map",
"them",
"into",
"ddimen",
"sion",
"vectors",
"vq",
"vd",
"whose",
"inner",
"product",
"is",
"used",
"as",
"similarity",
"measurement",
"sim",
"q",
"d",
"encq",
"q",
"encd",
"d",
"vq",
"vd",
"1",
"for",
"zero",
"shot",
"retrieval",
"we",
"consider",
"lquery",
"sets",
"q1",
"q2",
"q",
"land",
"their",
"corresponding",
"search",
"cor",
"pus",
"document",
"sets",
"d1",
"d2",
"d",
"l",
"denote",
"the",
"j",
"th",
"query",
"from",
"i",
"th",
"set",
"query",
"set",
"qiasqij",
"we",
"need",
"to",
"fully",
"mapping",
"functions",
"encqand",
"encdwithout",
"access",
"to",
"any",
"query",
"set",
"qi",
"document",
"setdi",
"or",
"any",
"relevance",
"judgment",
"rij",
"the",
"of",
"zero",
"shot",
"dense",
"retrieval",
"lies",
"precisely",
"in",
"equation",
"1",
"it",
"requires",
"learning",
"of",
"two",
"embedding",
"functions",
"for",
"query",
"and",
"document",
"re",
"spectively",
"into",
"the",
"same",
"embedding",
"space",
"where",
"inner",
"product",
"captures",
"relevance",
"without",
"rele",
"vance",
"judgments",
"scores",
"to",
"learning",
"becomes",
"intractable",
"3",
"2",
"hyde",
"hyde",
"circumvents",
"the",
"aforementioned",
"learning",
"problem",
"by",
"performing",
"search",
"in",
"document",
"only",
"embedding",
"space",
"that",
"captures",
"document",
"document",
"similarity",
"this",
"can",
"be",
"easily",
"learned",
"using",
"unsupervised",
"contrastive",
"learning",
"izacard",
"et",
"al",
"2021",
"gao",
"et",
"al",
"2021",
"gao",
"and",
"callan",
"2022",
"we",
"set",
"document",
"encoder",
"encddirectly",
"as",
"a",
"contrastive",
"encoder",
"enc",
"con",
"f",
"encd",
"enc",
"con",
"2",
"this",
"function",
"is",
"also",
"denoted",
"as",
"ffor",
"simplic",
"ity",
"this",
"unsupervised",
"contrastive",
"encoder",
"will",
"be",
"shared",
"by",
"all",
"incoming",
"document",
"corpus",
"vd",
"f",
"d",
"d",
"d1",
"d2",
"dl",
"3",
"to",
"build",
"the",
"query",
"vector",
"we",
"consider",
"in",
"addition",
"an",
"instruction",
"following",
"lm",
"instructlm",
"it",
"takes",
"a",
"query",
"qand",
"a",
"textual",
"instruction",
"inst",
"and",
"follows",
"them",
"to",
"perform",
"the",
"task",
"by",
"inst"
],
[
"vd",
"f",
"d",
"d",
"d1",
"d2",
"dl",
"3",
"to",
"build",
"the",
"query",
"vector",
"we",
"consider",
"in",
"addition",
"an",
"instruction",
"following",
"lm",
"instructlm",
"it",
"takes",
"a",
"query",
"qand",
"a",
"textual",
"instruction",
"inst",
"and",
"follows",
"them",
"to",
"perform",
"the",
"task",
"by",
"inst",
"for",
"simplicity",
"denote",
"g",
"q",
"inst",
"instructlm",
"q",
"inst",
"4",
"now",
"we",
"can",
"use",
"gto",
"map",
"queries",
"to",
"hypotheti",
"cal",
"documents",
"by",
"sampling",
"from",
"g",
"setting",
"inst"
],
[
"to",
"be",
"write",
"a",
"paragraph",
"that",
"answers",
"the",
"question",
"the",
"generated",
"document",
"is",
"not",
"real",
"can",
"and",
"is",
"likely",
"to",
"be",
"ungrounded",
"factually",
"brown",
"et",
"al",
"2020",
"thoppilan",
"et",
"al",
"2022",
"we",
"only",
"re",
"quire",
"it",
"to",
"capture",
"relevance",
"pattern",
"this",
"is",
"done",
"by",
"generating",
"documents",
"i",
"e",
"providing",
"exam",
"ples",
"critically",
"here",
"we",
"relevance",
"mod",
"eling",
"from",
"representation",
"learning",
"model",
"to",
"an",
"nlg",
"model",
"that",
"generalizes",
"more",
"eas",
"ily",
"naturally",
"and",
"effectively",
"brown",
"et",
"al",
"2020",
"ouyang",
"et",
"al",
"2022",
"generating",
"examples",
"also",
"replaces",
"explicit",
"modeling",
"of",
"relevance",
"scores",
"we",
"can",
"now",
"encode",
"the",
"generated",
"document",
"using",
"the",
"document",
"encoder",
"f",
"write",
"e",
"vqij",
"e",
"f",
"g",
"qij",
"inst",
"i",
"5",
"formally",
"a",
"probability",
"distribution",
"based",
"on",
"the",
"chain",
"rule",
"in",
"this",
"paper",
"we",
"simply",
"consider",
"the",
"expectation",
"value",
"assuming",
"the",
"distribution",
"of",
"vqijis",
"uni",
"modal",
"i",
"e",
"the",
"query",
"is",
"not",
"ambiguous",
"the",
"study",
"of",
"ambiguous",
"queries",
"and",
"diversity",
"is",
"left",
"to",
"future",
"work",
"we",
"estimate",
"equation",
"5",
"by",
"sampling",
"ndocuments",
"from",
"g",
"1",
"n",
"g",
"qij",
"inst",
"i",
"f",
"dk",
"6",
"1",
"nn",
"k",
"1f",
"7",
"we",
"also",
"consider",
"the",
"query",
"as",
"a",
"possible",
"hypothesis",
"1",
"n",
"1",
"n",
"k",
"1f",
"f",
"qij",
"8",
"inner",
"product",
"is",
"computed",
"between",
"the",
"set",
"of",
"all",
"document",
"vectors",
"f",
"d",
"d",
"di",
"the",
"most",
"similar",
"documents",
"are",
"retrieved",
"here",
"the",
"encoder",
"function",
"fserves",
"as",
"a",
"lossy",
"compressor",
"that",
"outputs",
"dense",
"vectors",
"where",
"the",
"extra",
"details",
"are",
"and",
"left",
"out",
"from",
"the",
"vector",
"it",
"further",
"grounds",
"the",
"hypothetical",
"vector",
"to",
"the",
"actual",
"corpus",
"and",
"the",
"real",
"documents",
"the",
"full",
"hyde",
"system",
"is",
"illustrated",
"in",
"figure",
"1",
"4",
"experiments",
"4",
"1",
"setup",
"implementation",
"we",
"implement",
"hyde",
"using",
"instructgpt",
"a",
"gpt",
"3",
"model",
"from",
"the",
"instruct",
"series",
"text",
"davinci",
"003",
"ouyang",
"et",
"al",
"2022",
"andcontriever",
"models",
"izacard",
"et",
"al",
"2021",
"wesample",
"from",
"instructgpt",
"using",
"the",
"openai",
"play",
"ground",
"default",
"temperature",
"of",
"0",
"7",
"for",
"open",
"ended",
"generations",
"we",
"use",
"the",
"english",
"only",
"contriever",
"model",
"for",
"english",
"retrieval",
"tasks",
"and",
"multilingual",
"mcontriever",
"for",
"non",
"english",
"tasks"
],
[
"wesample",
"from",
"instructgpt",
"using",
"the",
"openai",
"play",
"ground",
"default",
"temperature",
"of",
"0",
"7",
"for",
"open",
"ended",
"generations",
"we",
"use",
"the",
"english",
"only",
"contriever",
"model",
"for",
"english",
"retrieval",
"tasks",
"and",
"multilingual",
"mcontriever",
"for",
"non",
"english",
"tasks",
"we",
"conducted",
"retrieval",
"experiments",
"with",
"the",
"pyserini",
"toolkit",
"lin",
"et",
"al",
"2021a",
"datasets",
"we",
"consider",
"web",
"search",
"query",
"sets",
"trec",
"dl19",
"craswell",
"et",
"al",
"2020a",
"and",
"dl20",
"craswell",
"et",
"al",
"2020b",
"they",
"are",
"based",
"on",
"the",
"ms",
"marco",
"dataset",
"bajaj",
"et",
"al",
"2016",
"we",
"also",
"use",
"a",
"diverse",
"collection",
"of",
"6",
"low",
"resource",
"datasets",
"from",
"the",
"beir",
"dataset",
"thakur",
"et",
"al",
"2021",
"for",
"non",
"english",
"retrieval",
"we",
"consider",
"swahili",
"korean",
"japanese",
"and",
"bengali",
"from",
"the",
"mr",
"tydi",
"dataset",
"zhang",
"et",
"al",
"2021",
"we",
"use",
"different",
"instructions",
"for",
"each",
"dataset",
"they",
"share",
"a",
"similar",
"structure",
"but",
"have",
"different",
"to",
"control",
"the",
"exact",
"form",
"of",
"the",
"gener",
"ated",
"hypothetical",
"documents",
"these",
"instructions",
"can",
"be",
"found",
"in",
"subsection",
"a",
"1",
"compared",
"systems",
"contriever",
"models",
"contriever",
"andmcontriever",
"serve",
"as",
"our",
"major",
"baseline",
"they",
"are",
"trained",
"using",
"unsupervised",
"contrastive",
"learning",
"hyde",
"retrievers",
"share",
"the",
"exact",
"same",
"embedding",
"spaces",
"with",
"them",
"the",
"only",
"difference",
"is",
"how",
"the",
"query",
"vector",
"is",
"built",
"these",
"comparisons",
"allow",
"us",
"to",
"easily",
"examine",
"the",
"effect",
"of",
"hyde",
"the",
"classical",
"heuristic",
"based",
"lexical",
"retriever",
"bm25",
"is",
"also",
"included",
"several",
"systems",
"that",
"involve",
"tuning",
"on",
"mas",
"sive",
"relevance",
"data",
"are",
"also",
"included",
"as",
"refer",
"ences",
"we",
"consider",
"models",
"tuned",
"on",
"ms",
"marco",
"and",
"transferred",
"dpr",
"and",
"ance",
"from",
"the",
"beir",
"paper",
"for",
"multilingual",
"we",
"include",
"the",
"mdpr",
"model",
"from",
"mr",
"tydi",
"paper",
"and",
"ms",
"marco",
"tuned",
"mbert",
"and",
"xlm",
"r",
"from",
"the",
"contriever",
"paper",
"we",
"also",
"include",
"the",
"state",
"of",
"the",
"art",
"transfer",
"learning",
"models",
"contriever",
"and",
"mcontriever",
"tuned",
"on",
"ms",
"marco",
"denoted",
"contrieverftandmcontrieverft"
],
[
"we",
"also",
"include",
"the",
"state",
"of",
"the",
"art",
"transfer",
"learning",
"models",
"contriever",
"and",
"mcontriever",
"tuned",
"on",
"ms",
"marco",
"denoted",
"contrieverftandmcontrieverft",
"these",
"mod",
"els",
"have",
"run",
"through",
"the",
"state",
"of",
"the",
"art",
"retrieval",
"model",
"training",
"pipeline",
"that",
"involves",
"second",
"stage",
"retrieval",
"pre",
"training",
"lee",
"et",
"al",
"2019",
"and",
"a",
"few",
"rounds",
"of",
"tuning",
"qu",
"et",
"al",
"2021",
"they",
"should",
"be",
"considered",
"empirical",
"upper",
"bounds",
"4",
"2",
"web",
"search",
"in",
"table",
"1",
"we",
"show",
"retrieval",
"results",
"on",
"trec",
"dl19",
"and",
"trec",
"dl20",
"we",
"see",
"hyde",
"bring",
"sizable",
"improvements",
"to",
"contriever",
"across",
"the",
"board",
"for"
],
[
"dl19",
"dl20",
"map",
"ndcg",
"10",
"recall",
"1k",
"map",
"ndcg",
"10",
"recall",
"1k",
"w",
"o",
"relevance",
"judgement",
"bm25",
"30",
"1",
"50",
"6",
"75",
"0",
"28",
"6",
"48",
"0",
"78",
"6",
"contriever",
"24",
"0",
"44",
"5",
"74",
"6",
"24",
"0",
"42",
"1",
"75",
"4",
"hyde",
"41",
"8",
"61",
"3",
"88",
"0",
"38",
"2",
"57",
"9",
"84",
"4",
"w",
"relevance",
"judgement",
"dpr",
"36",
"5",
"62",
"2",
"76",
"9",
"41",
"8",
"65",
"3",
"81",
"4",
"ance",
"37",
"1",
"64",
"5",
"75",
"5",
"40",
"8",
"64",
"6",
"77",
"6",
"contrieverft41",
"7",
"62",
"1",
"83",
"6",
"43",
"6",
"63",
"2",
"85",
"8",
"table",
"1",
"results",
"for",
"web",
"search",
"on",
"dl19",
"20",
"best",
"performing",
"w",
"o",
"relevance",
"and",
"overall",
"system",
"s",
"are",
"marked",
"bold",
"dpr",
"ance",
"and",
"contrieverftare",
"in",
"domain",
"supervised",
"models",
"that",
"are",
"on",
"ms",
"marco",
"training",
"data",
"scifact",
"arguana",
"trec",
"covid",
"fiqa",
"dbpedia",
"trec",
"news",
"ndcg",
"10",
"w",
"o",
"relevance",
"judgement",
"bm25",
"67",
"9",
"39",
"7",
"59",
"5",
"23",
"6",
"31",
"8",
"39",
"5",
"contriever",
"64",
"9",
"37",
"9",
"27",
"3",
"24",
"5",
"29",
"2",
"34",
"8",
"hyde",
"69",
"1",
"46",
"6",
"59",
"3",
"27",
"3",
"36",
"8",
"44",
"0",
"w",
"relevance",
"judgement",
"dpr",
"31",
"8",
"17",
"5",
"33",
"2",
"29",
"5",
"26",
"3",
"16",
"1",
"ance",
"50",
"7",
"41",
"5",
"65",
"4",
"30",
"0",
"28",
"1",
"38",
"2",
"contrieverft67",
"7",
"44",
"6",
"59",
"6",
"32",
"9",
"41",
"3",
"42",
"8",
"recall",
"100",
"w",
"o",
"relevance",
"judgement",
"bm25",
"92",
"5",
"93",
"2",
"49",
"8",
"54",
"0",
"46",
"8",
"44",
"7",
"contriever",
"92",
"6",
"90",
"1",
"17",
"2",
"56",
"2",
"45",
"3",
"42",
"3",
"hyde",
"96",
"4",
"97",
"9",
"41",
"4",
"62",
"1",
"47",
"2",
"50",
"9",
"w",
"relevance",
"judgement",
"dpr",
"72",
"7",
"75",
"1",
"21",
"2",
"34",
"2",
"34",
"9",
"21",
"5",
"ance",
"81",
"6",
"93",
"7",
"45",
"7",
"58",
"1",
"31",
"9",
"39",
"8",
"contrieverft94",
"7",
"97",
"7",
"40",
"7",
"65",
"6",
"54",
"1",
"49",
"2",
"table",
"2",
"low",
"resource",
"tasks",
"from",
"beir",
"best",
"performing",
"w",
"o",
"relevance",
"and",
"overall",
"system",
"s",
"are",
"marked",
"bold",
"both",
"precision",
"oriented",
"and",
"recall",
"metrics",
"while",
"unsupervised",
"contriever",
"can",
"underperform",
"the",
"classical",
"bm25",
"approach",
"hyde",
"outperforms",
"bm25",
"by",
"large",
"margins",
"hyde",
"remains",
"competitive",
"even",
"when",
"compared",
"to",
"tuned",
"models",
"note",
"that",
"trec",
"dl19",
"20",
"are",
"search",
"tasks",
"on",
"ms",
"marco",
"and",
"there",
"all",
"the",
"tuned",
"models",
"are",
"richly",
"super",
"vised",
"on",
"trec",
"dl19",
"hyde",
"shows",
"comparable",
"map",
"and",
"ndcg",
"10",
"to",
"contrieverftand",
"best",
"re",
"call",
"1k",
"on",
"dl20",
"hyde",
"gets",
"around",
"10",
"lower",
"map",
"and",
"ndcg",
"10",
"than",
"contrieverftand",
"sim",
"ilar",
"recall",
"1k",
"the",
"ance",
"model",
"shows",
"better",
"ndcg",
"10",
"numbers",
"than",
"hyde",
"but",
"lower",
"recall",
"sug",
"gesting",
"it",
"may",
"be",
"biased",
"to",
"a",
"subset",
"of",
"queries",
"and",
"or",
"relevant",
"documents",
"4",
"3",
"low",
"resource",
"retrieval",
"in",
"table",
"2",
"we",
"show",
"retrieval",
"results",
"on",
"low",
"resource",
"tasks",
"from",
"beir"
],
[
"the",
"ance",
"model",
"shows",
"better",
"ndcg",
"10",
"numbers",
"than",
"hyde",
"but",
"lower",
"recall",
"sug",
"gesting",
"it",
"may",
"be",
"biased",
"to",
"a",
"subset",
"of",
"queries",
"and",
"or",
"relevant",
"documents",
"4",
"3",
"low",
"resource",
"retrieval",
"in",
"table",
"2",
"we",
"show",
"retrieval",
"results",
"on",
"low",
"resource",
"tasks",
"from",
"beir",
"similar",
"to",
"web",
"search",
"hyde",
"again",
"brings",
"sizable",
"improvements",
"to",
"contriever",
"across",
"the",
"board",
"in",
"terms",
"of",
"both",
"ndcg",
"and",
"recall",
"hyde",
"is",
"only",
"outperformed",
"by",
"bm25",
"on",
"one",
"dataset",
"trec",
"covid",
"but",
"with",
"a",
"tiny",
"0",
"2",
"mar",
"gin",
"in",
"comparison",
"the",
"underlying",
"contriever",
"underperforms",
"by",
"more",
"than",
"50",
"we",
"also",
"observe",
"hyde",
"demonstrates",
"strong",
"performance",
"compared",
"to",
"tuned",
"models",
"hyde",
"generally",
"shows",
"better",
"performance",
"than",
"ance",
"and",
"dpr",
"even",
"though",
"the",
"two",
"are",
"tuned",
"on",
"ms",
"marco",
"and",
"ance",
"also",
"in",
"volves",
"some",
"sophisticated",
"hard",
"negative",
"techniques",
"contrieverftshows",
"performance",
"advantages",
"on",
"fiqa",
"and",
"dbpedia",
"these",
"involve",
"retrieval",
"of",
"nancial",
"posts",
"or",
"entities",
"respectively",
"we",
"believe",
"the",
"performance",
"difference",
"can",
"be",
"attributed",
"to",
"the"
],
[
"swahili",
"korean",
"japanese",
"bengali",
"w",
"o",
"relevance",
"judgement",
"bm25",
"38",
"9",
"28",
"5",
"21",
"2",
"41",
"8",
"mcontriever",
"38",
"3",
"22",
"3",
"19",
"5",
"35",
"3",
"hyde",
"41",
"7",
"30",
"6",
"30",
"7",
"41",
"3",
"w",
"relevance",
"judgement",
"mdpr",
"7",
"3",
"21",
"9",
"18",
"1",
"25",
"8",
"mbert",
"37",
"4",
"28",
"1",
"27",
"1",
"35",
"1",
"xlm",
"r",
"35",
"1",
"32",
"2",
"24",
"8",
"41",
"7",
"mcontrieverft51",
"2",
"34",
"2",
"32",
"4",
"42",
"3",
"table",
"3",
"mrr",
"100",
"on",
"mr",
"tydi",
"best",
"performing",
"w",
"o",
"relevance",
"and",
"overall",
"system",
"s",
"are",
"marked",
"bold",
"under",
"of",
"the",
"instruction",
"more",
"elabo",
"rative",
"instructions",
"may",
"help",
"4",
"4",
"multilingual",
"retrieval",
"multilingual",
"setup",
"poses",
"several",
"additional",
"chal",
"lenges",
"to",
"hyde",
"the",
"small",
"sized",
"contrastive",
"en",
"coder",
"gets",
"saturated",
"as",
"the",
"number",
"of",
"languages",
"scales",
"conneau",
"et",
"al",
"2020",
"izacard",
"et",
"al",
"2021",
"meanwhile",
"our",
"generative",
"llm",
"faces",
"an",
"opposite",
"issue",
"with",
"languages",
"of",
"not",
"as",
"high",
"resource",
"as",
"english",
"or",
"french",
"the",
"high",
"capacity",
"llm",
"can",
"get",
"under",
"trained",
"hoffmann",
"et",
"al",
"2022",
"nevertheless",
"in",
"table",
"3",
"we",
"still",
"hyde",
"able",
"to",
"improve",
"the",
"mcontriever",
"model",
"it",
"can",
"outperform",
"non",
"contriever",
"models",
"tuned",
"on",
"and",
"transferred",
"from",
"ms",
"marco",
"on",
"the",
"other",
"hand",
"we",
"do",
"observe",
"some",
"margins",
"between",
"hyde",
"and",
"tuned",
"mcontrieverft",
"sincehyde",
"and",
"mcontrieverftuse",
"similar",
"contrastive",
"encoders",
"we",
"hypothesize",
"this",
"is",
"because",
"the",
"non",
"english",
"lan",
"guages",
"we",
"considered",
"are",
"under",
"trained",
"in",
"both",
"pre",
"training",
"and",
"instruction",
"learning",
"stages",
"5",
"analysis",
"the",
"generative",
"llm",
"and",
"contrastive",
"encoder",
"make",
"up",
"the",
"backbone",
"of",
"hyde",
"in",
"this",
"section",
"we",
"study",
"the",
"effect",
"of",
"changing",
"their",
"realizations",
"in",
"partic",
"ular",
"we",
"consider",
"smaller",
"language",
"models",
"lm",
"and",
"tuned",
"encoders",
"we",
"conduct",
"our",
"studies",
"on",
"trec",
"dl19",
"20",
"5",
"1",
"effect",
"of",
"different",
"generative",
"models",
"in",
"table",
"4",
"we",
"show",
"hyde",
"using",
"other",
"instruction",
"following",
"language",
"models",
"in",
"particular",
"we",
"consider",
"a",
"52",
"billion",
"cohere",
"model",
"command",
"xlarge",
"20221108",
"and",
"a",
"11",
"billion",
"flan",
"model",
"flan",
"t5",
"xxl",
"wei",
"et",
"al"
],
[
"5",
"1",
"effect",
"of",
"different",
"generative",
"models",
"in",
"table",
"4",
"we",
"show",
"hyde",
"using",
"other",
"instruction",
"following",
"language",
"models",
"in",
"particular",
"we",
"consider",
"a",
"52",
"billion",
"cohere",
"model",
"command",
"xlarge",
"20221108",
"and",
"a",
"11",
"billion",
"flan",
"model",
"flan",
"t5",
"xxl",
"wei",
"et",
"al",
"2022",
"2generally",
"we",
"observe",
"that",
"all",
"2model",
"sizes",
"are",
"from",
"https",
"crfm",
"stanford",
"edu",
"helm",
"v1",
"0",
"models",
"model",
"dl19",
"dl20",
"contriever",
"44",
"5",
"42",
"1",
"contrieverft62",
"1",
"63",
"2",
"hyde",
"w",
"contriever",
"w",
"flan",
"t5",
"11b",
"48",
"9",
"52",
"9",
"w",
"cohere",
"52b",
"53",
"8",
"53",
"8",
"w",
"gpt",
"175b",
"61",
"3",
"57",
"9",
"w",
"contrieverft",
"w",
"flan",
"t5",
"11b",
"60",
"2",
"62",
"1",
"w",
"cohere",
"52b",
"61",
"4",
"63",
"1",
"w",
"gpt",
"175b",
"67",
"4",
"63",
"5",
"table",
"4",
"ndcg",
"10",
"on",
"trec",
"dl19",
"20",
"effect",
"of",
"changing",
"different",
"instruction",
"lms",
"and",
"using",
"tuned",
"encoder",
"best",
"w",
"o",
"relevance",
"and",
"overall",
"models",
"are",
"marked",
"bold",
"models",
"bring",
"improvement",
"to",
"the",
"unsupervised",
"contriever",
"with",
"larger",
"models",
"bringing",
"larger",
"improvements",
"at",
"the",
"time",
"when",
"this",
"paper",
"is",
"written",
"the",
"cohere",
"model",
"is",
"still",
"experimental",
"without",
"much",
"detail",
"disclosed",
"we",
"can",
"only",
"tentatively",
"hypothesize",
"that",
"training",
"techniques",
"may",
"have",
"also",
"played",
"some",
"role",
"in",
"the",
"performance",
"difference",
"5",
"2",
"hyde",
"with",
"fine",
"tuned",
"encoder",
"to",
"begin",
"with",
"hyde",
"with",
"tuned",
"encoder",
"is",
"notthe",
"intended",
"usage",
"hyde",
"is",
"more",
"powerful",
"and",
"irreplaceable",
"when",
"few",
"relevance",
"labels",
"are",
"present",
"here",
"we",
"are",
"interested",
"to",
"out",
"if",
"and",
"howhyde",
"embedding",
"can",
"affect",
"tuned",
"en",
"coders",
"in",
"table",
"4",
"we",
"see",
"that",
"less",
"powerful",
"instruc",
"tion",
"lms",
"can",
"negatively",
"impact",
"the",
"overall",
"perfor",
"mance",
"of",
"the",
"tuned",
"retriever",
"to",
"remind",
"our",
"readers",
"contrieverftis",
"in",
"domain",
"supervisedly",
"tuned",
"for",
"trec",
"dl19",
"20",
"the",
"performance",
"degradations",
"remain",
"small",
"on",
"the",
"other",
"hand",
"we",
"also",
"observe",
"the",
"instructgpt",
"model",
"able",
"to",
"fur",
"ther",
"bring",
"up",
"the",
"performance",
"especially",
"on",
"dl19",
"this",
"suggests",
"that",
"there",
"may",
"still",
"exist",
"certain",
"fac",
"tors",
"not",
"captured",
"by",
"the",
"tuned",
"encoder",
"but",
"only",
"by",
"the",
"generative",
"model",
"6",
"conclusion",
"at",
"the",
"end",
"of",
"the",
"paper",
"we",
"encourage",
"the",
"readers",
"to",
"take",
"a",
"moment",
"and",
"on",
"the",
"hyde",
"model",
"compare",
"it",
"to",
"some",
"of",
"the",
"other",
"recently",
"seen",
"re",
"trievers",
"or",
"re",
"ranker"
],
[
"6",
"conclusion",
"at",
"the",
"end",
"of",
"the",
"paper",
"we",
"encourage",
"the",
"readers",
"to",
"take",
"a",
"moment",
"and",
"on",
"the",
"hyde",
"model",
"compare",
"it",
"to",
"some",
"of",
"the",
"other",
"recently",
"seen",
"re",
"trievers",
"or",
"re",
"ranker",
"these",
"other",
"models",
"probably",
"differ",
"in",
"their",
"architecture",
"training",
"method",
"and",
"or",
"task",
"but",
"probably",
"all",
"of",
"them",
"involve",
"modeling",
"relevance",
"scores",
"between",
"a",
"pair",
"of",
"query",
"and",
"docu"
],
[
"ment",
"dense",
"retrievers",
"consider",
"vector",
"similarities",
"while",
"self",
"attentive",
"re",
"rankers",
"regression",
"scores",
"in",
"comparison",
"the",
"concept",
"of",
"relevance",
"in",
"hyde",
"is",
"captured",
"by",
"an",
"nlg",
"model",
"and",
"the",
"language",
"gener",
"ation",
"process",
"we",
"demonstrate",
"in",
"many",
"cases",
"hyde",
"can",
"be",
"as",
"effective",
"as",
"dense",
"retrievers",
"that",
"learn",
"to",
"model",
"numerical",
"relevance",
"scores",
"so",
"is",
"numeri",
"cal",
"relevance",
"just",
"a",
"statistical",
"artifact",
"of",
"language",
"understanding",
"will",
"a",
"weak",
"retriever",
"theoretically",
"as",
"the",
"nlu",
"nlg",
"models",
"rapidly",
"become",
"stronger",
"rushing",
"to",
"conclusions",
"is",
"not",
"smart",
"more",
"works",
"need",
"to",
"be",
"done",
"to",
"get",
"answers",
"with",
"this",
"paper",
"we",
"just",
"want",
"to",
"raise",
"these",
"questions",
"concretely",
"in",
"this",
"paper",
"we",
"introduce",
"a",
"new",
"paradigm",
"of",
"interactions",
"between",
"llm",
"and",
"dense",
"encoder",
"retriever",
"we",
"demonstrate",
"part",
"of",
"rel",
"evance",
"modeling",
"and",
"instruction",
"understanding",
"can",
"be",
"delegated",
"to",
"the",
"more",
"powerful",
"and",
"ible",
"llm",
"as",
"a",
"consequence",
"the",
"need",
"for",
"rele",
"vance",
"labels",
"is",
"removed",
"we",
"are",
"excited",
"to",
"see",
"how",
"this",
"can",
"be",
"generalized",
"further",
"to",
"more",
"so",
"phisticated",
"tasks",
"like",
"multi",
"hop",
"retrieval",
"qa",
"and",
"conversational",
"search",
"we",
"argue",
"hyde",
"is",
"also",
"of",
"practical",
"use",
"though",
"not",
"necessarily",
"over",
"the",
"entire",
"lifespan",
"of",
"a",
"search",
"sys",
"tem",
"at",
"the",
"very",
"beginning",
"of",
"the",
"life",
"of",
"the",
"search",
"system",
"serving",
"queries",
"using",
"hyde",
"offers",
"perfor",
"mance",
"comparable",
"to",
"a",
"tuned",
"model",
"which",
"no",
"other",
"relevance",
"free",
"model",
"can",
"offer",
"as",
"the",
"search",
"log",
"grows",
"a",
"supervised",
"dense",
"retriever",
"can",
"be",
"gradually",
"rolled",
"out",
"as",
"the",
"dense",
"retriever",
"grows",
"stronger",
"more",
"queries",
"will",
"be",
"routed",
"to",
"it",
"with",
"only",
"less",
"common",
"and",
"emerging",
"ones",
"going",
"tohyde",
"backend",
"references",
"akari",
"asai",
"timo",
"schick",
"patrick",
"lewis",
"xilun",
"chen",
"gautier",
"izacard",
"sebastian",
"riedel",
"hannaneh",
"ha",
"jishirzi",
"and",
"wen",
"tau",
"yih",
"2022",
"task",
"aware",
"re",
"trieval",
"with",
"instructions",
"payal",
"bajaj",
"daniel",
"campos",
"nick",
"craswell",
"li",
"deng",
"jianfeng",
"gao",
"xiaodong",
"liu",
"rangan",
"majumder",
"andrew",
"mcnamara",
"bhaskar",
"mitra",
"tri",
"nguyen",
"mir",
"rosenberg",
"xia",
"song",
"alina",
"stoica",
"saurabh",
"ti",
"wary",
"and",
"tong",
"wang",
"2016",
"ms",
"marco",
"a",
"human",
"generated",
"machine",
"reading",
"comprehension",
"dataset"
],
[
"2016",
"ms",
"marco",
"a",
"human",
"generated",
"machine",
"reading",
"comprehension",
"dataset",
"michele",
"bevilacqua",
"giuseppe",
"ottaviano",
"patrick",
"lewis",
"wen",
"tau",
"yih",
"sebastian",
"riedel",
"and",
"fabio",
"petroni",
"2022",
"autoregressive",
"search",
"engines",
"gen",
"erating",
"substrings",
"as",
"document",
"corr",
"abs",
"2204",
"10628",
"tom",
"b",
"brown",
"benjamin",
"mann",
"nick",
"ryder",
"melanie",
"subbiah",
"jared",
"kaplan",
"prafulla",
"dhariwal",
"arvind",
"neelakantan",
"pranav",
"shyam",
"girish",
"sastry",
"amanda",
"askell",
"sandhini",
"agarwal",
"ariel",
"herbert",
"v",
"oss",
"gretchen",
"krueger",
"tom",
"henighan",
"rewon",
"child",
"aditya",
"ramesh",
"daniel",
"m",
"ziegler",
"jeffrey",
"wu",
"clemens",
"winter",
"christopher",
"hesse",
"mark",
"chen",
"eric",
"sigler",
"mateusz",
"litwin",
"scott",
"gray",
"benjamin",
"chess",
"jack",
"clark",
"christopher",
"berner",
"sam",
"mc",
"candlish",
"alec",
"radford",
"ilya",
"sutskever",
"and",
"dario",
"amodei",
"2020",
"language",
"models",
"are",
"few",
"shot",
"learn",
"ers",
"in",
"advances",
"in",
"neural",
"information",
"processing",
"systems",
"33",
"annual",
"conference",
"on",
"neural",
"informa",
"tion",
"processing",
"systems",
"2020",
"neurips",
"2020",
"de",
"cember",
"6",
"12",
"2020",
"virtual",
"mark",
"chen",
"jerry",
"tworek",
"heewoo",
"jun",
"qiming",
"yuan",
"henrique",
"ponde",
"de",
"oliveira",
"pinto",
"jared",
"ka",
"plan",
"harri",
"edwards",
"yuri",
"burda",
"nicholas",
"joseph",
"greg",
"brockman",
"alex",
"ray",
"raul",
"puri",
"gretchen",
"krueger",
"michael",
"petrov",
"heidy",
"khlaaf",
"girish",
"sas",
"try",
"pamela",
"mishkin",
"brooke",
"chan",
"scott",
"gray",
"nick",
"ryder",
"mikhail",
"pavlov",
"alethea",
"power",
"lukasz",
"kaiser",
"mohammad",
"bavarian",
"clemens",
"winter",
"philippe",
"tillet",
"felipe",
"petroski",
"such",
"dave",
"cum",
"mings",
"matthias",
"plappert",
"fotios",
"chantzis",
"eliza",
"beth",
"barnes",
"ariel",
"herbert",
"v",
"oss",
"william",
"hebgen",
"guss",
"alex",
"nichol",
"alex",
"paino",
"nikolas",
"tezak",
"jie",
"tang",
"igor",
"babuschkin",
"suchir",
"balaji",
"shantanu",
"jain",
"william",
"saunders",
"christopher",
"hesse",
"andrew",
"n",
"carr",
"jan",
"leike",
"josh",
"achiam",
"vedant",
"misra",
"evan",
"morikawa",
"alec",
"radford",
"matthew",
"knight",
"miles",
"brundage",
"mira",
"murati",
"katie",
"mayer",
"peter",
"welin",
"der",
"bob",
"mcgrew",
"dario",
"amodei",
"sam",
"mccandlish",
"ilya",
"sutskever",
"and",
"wojciech",
"zaremba",
"2021",
"eval",
"uating",
"large",
"language",
"models",
"trained",
"on",
"code"
],
[
"2021",
"eval",
"uating",
"large",
"language",
"models",
"trained",
"on",
"code",
"aakanksha",
"chowdhery",
"sharan",
"narang",
"jacob",
"devlin",
"maarten",
"bosma",
"gaurav",
"mishra",
"adam",
"roberts",
"paul",
"barham",
"hyung",
"won",
"chung",
"charles",
"sutton",
"sebastian",
"gehrmann",
"parker",
"schuh",
"kensen",
"shi",
"sasha",
"tsvyashchenko",
"joshua",
"maynez",
"abhishek",
"rao",
"parker",
"barnes",
"yi",
"tay",
"noam",
"shazeer",
"vin",
"odkumar",
"prabhakaran",
"emily",
"reif",
"nan",
"du",
"ben",
"hutchinson",
"reiner",
"pope",
"james",
"bradbury",
"jacob",
"austin",
"michael",
"isard",
"guy",
"gur",
"ari",
"pengcheng",
"yin",
"toju",
"duke",
"anselm",
"levskaya",
"sanjay",
"ghe",
"mawat",
"sunipa",
"dev",
"henryk",
"michalewski",
"xavier",
"garcia",
"vedant",
"misra",
"kevin",
"robinson",
"liam",
"fe",
"dus",
"denny",
"zhou",
"daphne",
"ippolito",
"david",
"luan",
"hyeontaek",
"lim",
"barret",
"zoph",
"alexander",
"spiridonov",
"ryan",
"sepassi",
"david",
"dohan",
"shivani",
"agrawal",
"mark",
"omernick",
"andrew",
"m",
"dai",
"thanumalayan",
"sankara",
"narayana",
"pillai",
"marie",
"pellat",
"aitor",
"lewkowycz",
"erica",
"moreira",
"rewon",
"child",
"oleksandr",
"polozov",
"katherine",
"lee",
"zongwei",
"zhou",
"xuezhi",
"wang",
"bren",
"nan",
"saeta",
"mark",
"diaz",
"orhan",
"firat",
"michele",
"catasta",
"jason",
"wei",
"kathy",
"meier",
"hellstern",
"douglas",
"eck",
"jeff",
"dean",
"slav",
"petrov",
"and",
"noah",
"fiedel",
"2022",
"palm",
"scaling",
"language",
"modeling",
"with",
"pathways",
"alexis",
"conneau",
"kartikay",
"khandelwal",
"naman",
"goyal",
"vishrav",
"chaudhary",
"guillaume",
"wenzek",
"francisco",
"edouard",
"grave",
"myle",
"ott",
"luke",
"zettle"
],
[
"moyer",
"and",
"veselin",
"stoyanov",
"2020",
"unsupervised",
"cross",
"lingual",
"representation",
"learning",
"at",
"scale",
"in",
"proceedings",
"of",
"the",
"58th",
"annual",
"meeting",
"of",
"the",
"asso",
"ciation",
"for",
"computational",
"linguistics",
"pages",
"8440",
"8451",
"online",
"association",
"for",
"computational",
"lin",
"guistics",
"nick",
"craswell",
"bhaskar",
"mitra",
"emine",
"yilmaz",
"daniel",
"campos",
"and",
"ellen",
"m",
"v",
"oorhees",
"2020a",
"overview",
"of",
"the",
"trec",
"2019",
"deep",
"learning",
"track",
"nick",
"craswell",
"bhaskar",
"mitra",
"emine",
"yilmaz",
"daniel",
"fernando",
"campos",
"and",
"ellen",
"m",
"v",
"oorhees",
"2020b",
"overview",
"of",
"the",
"trec",
"2020",
"deep",
"learning",
"track",
"arxiv",
"abs",
"2003",
"07820",
"jacob",
"devlin",
"ming",
"wei",
"chang",
"kenton",
"lee",
"and",
"kristina",
"toutanova",
"2019",
"bert",
"pre",
"training",
"of",
"deep",
"bidirectional",
"transformers",
"for",
"language",
"under",
"standing",
"in",
"proceedings",
"of",
"the",
"2019",
"conference",
"of",
"the",
"north",
"american",
"chapter",
"of",
"the",
"association",
"for",
"computational",
"linguistics",
"human",
"language",
"technologies",
"volume",
"1",
"long",
"and",
"short",
"papers",
"pages",
"4171",
"4186",
"minneapolis",
"minnesota",
"associ",
"ation",
"for",
"computational",
"linguistics",
"luyu",
"gao",
"and",
"jamie",
"callan",
"2021",
"condenser",
"a",
"pre",
"training",
"architecture",
"for",
"dense",
"retrieval",
"in",
"proceed",
"ings",
"of",
"the",
"2021",
"conference",
"on",
"empirical",
"methods",
"in",
"natural",
"language",
"processing",
"pages",
"981",
"993",
"online",
"and",
"punta",
"cana",
"dominican",
"republic",
"asso",
"ciation",
"for",
"computational",
"linguistics",
"luyu",
"gao",
"and",
"jamie",
"callan",
"2022",
"unsupervised",
"cor",
"pus",
"aware",
"language",
"model",
"pre",
"training",
"for",
"dense",
"passage",
"retrieval",
"in",
"proceedings",
"of",
"the",
"60th",
"annual",
"meeting",
"of",
"the",
"association",
"for",
"computational",
"lin",
"guistics",
"volume",
"1",
"long",
"papers",
"pages",
"2843",
"2853",
"dublin",
"ireland",
"association",
"for",
"computational",
"lin",
"guistics",
"tianyu",
"gao",
"xingcheng",
"yao",
"and",
"danqi",
"chen",
"2021",
"simcse",
"simple",
"contrastive",
"learning",
"of",
"sentence",
"embeddings",
"in",
"proceedings",
"of",
"the",
"2021",
"conference",
"on",
"empirical",
"methods",
"in",
"natural",
"language",
"process",
"ing",
"pages",
"6894",
"6910",
"online",
"and",
"punta",
"cana",
"do",
"minican",
"republic",
"association",
"for",
"computational",
"linguistics"
],
[
"2021",
"simcse",
"simple",
"contrastive",
"learning",
"of",
"sentence",
"embeddings",
"in",
"proceedings",
"of",
"the",
"2021",
"conference",
"on",
"empirical",
"methods",
"in",
"natural",
"language",
"process",
"ing",
"pages",
"6894",
"6910",
"online",
"and",
"punta",
"cana",
"do",
"minican",
"republic",
"association",
"for",
"computational",
"linguistics",
"jordan",
"hoffmann",
"sebastian",
"borgeaud",
"arthur",
"mensch",
"elena",
"buchatskaya",
"trevor",
"cai",
"eliza",
"rutherford",
"diego",
"de",
"las",
"casas",
"lisa",
"anne",
"hendricks",
"johannes",
"welbl",
"aidan",
"clark",
"tom",
"hennigan",
"eric",
"noland",
"katie",
"millican",
"george",
"van",
"den",
"driessche",
"bogdan",
"damoc",
"aurelia",
"guy",
"simon",
"osindero",
"karen",
"si",
"monyan",
"erich",
"elsen",
"jack",
"w",
"rae",
"oriol",
"vinyals",
"and",
"laurent",
"sifre",
"2022",
"training",
"compute",
"optimal",
"large",
"language",
"models",
"sebastian",
"sheng",
"chieh",
"lin",
"jheng",
"hong",
"yang",
"jimmy",
"lin",
"and",
"allan",
"hanbury",
"2021",
"ef",
"teaching",
"an",
"effective",
"dense",
"retriever",
"with",
"balanced",
"topic",
"aware",
"sampling",
"in",
"proceedings",
"of",
"the",
"44th",
"international",
"acm",
"sigir",
"conference",
"on",
"research",
"and",
"development",
"in",
"information",
"retrieval",
"sigir",
"21",
"page",
"113",
"122",
"new",
"york",
"ny",
"usa",
"as",
"sociation",
"for",
"computing",
"machinery",
"gautier",
"izacard",
"mathilde",
"caron",
"lucas",
"hosseini",
"se",
"bastian",
"riedel",
"piotr",
"bojanowski",
"armand",
"joulin",
"and",
"edouard",
"grave",
"2021",
"towards",
"unsupervised",
"dense",
"information",
"retrieval",
"with",
"contrastive",
"learning",
"corr",
"abs",
"2112",
"09118",
"jeff",
"johnson",
"matthijs",
"douze",
"and",
"2017",
"billion",
"scale",
"similarity",
"search",
"with",
"gpus",
"corr",
"abs",
"1702",
"08734",
"vladimir",
"karpukhin",
"barlas",
"oguz",
"sewon",
"min",
"patrick",
"lewis",
"ledell",
"wu",
"sergey",
"edunov",
"danqi",
"chen",
"and",
"wen",
"tau",
"yih",
"2020",
"dense",
"passage",
"retrieval",
"for",
"open",
"domain",
"question",
"answering",
"in",
"proceedings",
"of",
"the",
"2020",
"conference",
"on",
"empirical",
"methods",
"in",
"nat",
"ural",
"language",
"processing",
"emnlp",
"pages",
"6769",
"6781",
"online",
"association",
"for",
"computational",
"lin",
"guistics",
"hyunji",
"lee",
"sohee",
"yang",
"hanseok",
"oh",
"and",
"minjoon",
"seo",
"2022",
"generative",
"multi",
"hop",
"retrieval",
"kenton",
"lee",
"ming",
"wei",
"chang",
"and",
"kristina",
"toutanova"
],
[
"domain",
"question",
"answering",
"in",
"proceedings",
"of",
"the",
"57th",
"annual",
"meeting",
"of",
"the",
"association",
"for",
"com",
"putational",
"linguistics",
"pages",
"6086",
"6096",
"florence",
"italy",
"association",
"for",
"computational",
"linguistics",
"jimmy",
"lin",
"xueguang",
"ma",
"sheng",
"chieh",
"lin",
"jheng",
"hong",
"yang",
"ronak",
"pradeep",
"and",
"rodrigo",
"nogueira",
"2021a",
"pyserini",
"a",
"python",
"toolkit",
"for",
"reproducible",
"information",
"retrieval",
"research",
"with",
"sparse",
"and",
"dense",
"representations",
"in",
"proceedings",
"of",
"the",
"44th",
"annual",
"international",
"acm",
"sigir",
"conference",
"on",
"research",
"and",
"development",
"in",
"information",
"retrieval",
"sigir",
"2021",
"pages",
"2356",
"2362",
"sheng",
"chieh",
"lin",
"jheng",
"hong",
"yang",
"and",
"jimmy",
"lin",
"2021b",
"in",
"batch",
"negatives",
"for",
"knowledge",
"distillation",
"with",
"tightly",
"coupled",
"teachers",
"for",
"dense",
"retrieval",
"in",
"proceedings",
"of",
"the",
"6th",
"workshop",
"on",
"representation",
"learning",
"for",
"nlp",
"repl4nlp",
"2021",
"pages",
"163",
"173",
"online",
"association",
"for",
"computational",
"linguis",
"tics",
"zheng",
"liu",
"and",
"yingxia",
"shao",
"2022",
"retromae",
"pre",
"training",
"retrieval",
"oriented",
"transformers",
"via",
"masked",
"auto",
"encoder",
"arxiv",
"abs",
"2205",
"12035",
"shuqi",
"lu",
"di",
"he",
"chenyan",
"xiong",
"guolin",
"ke",
"waleed",
"malik",
"zhicheng",
"dou",
"paul",
"bennett",
"tie",
"yan",
"liu",
"and",
"arnold",
"overwijk",
"2021",
"less",
"is",
"more",
"pre",
"train",
"a",
"strong",
"siamese",
"encoder",
"for",
"dense",
"text",
"re",
"trieval",
"using",
"a",
"weak",
"decoder",
"in",
"proceedings",
"of",
"the",
"2021",
"conference",
"on",
"empirical",
"methods",
"in",
"natural",
"language",
"processing",
"pages",
"2780",
"2791",
"online",
"and",
"punta",
"cana",
"dominican",
"republic",
"association",
"for",
"computational",
"linguistics",
"donald",
"metzler",
"yi",
"tay",
"dara",
"bahri",
"and",
"marc",
"najork"
],
[
"sewon",
"min",
"mike",
"lewis",
"luke",
"zettlemoyer",
"and",
"han",
"naneh",
"hajishirzi",
"2022",
"metaicl",
"learning",
"to",
"learn",
"in",
"context",
"in",
"proceedings",
"of",
"the",
"2022",
"conference",
"of",
"the",
"north",
"american",
"chapter",
"of",
"the",
"association",
"for",
"computational",
"linguistics",
"human",
"language",
"tech",
"nologies",
"pages",
"2791",
"2809",
"seattle",
"united",
"states",
"association",
"for",
"computational",
"linguistics",
"long",
"ouyang",
"jeff",
"wu",
"xu",
"jiang",
"diogo",
"almeida",
"carroll",
"l",
"wainwright",
"pamela",
"mishkin",
"chong",
"zhang",
"sandhini",
"agarwal",
"katarina",
"slama",
"alex",
"ray",
"john",
"schulman",
"jacob",
"hilton",
"fraser",
"kelton",
"luke",
"miller",
"maddie",
"simens",
"amanda",
"askell",
"pe",
"ter",
"welinder",
"paul",
"christiano",
"jan",
"leike",
"and",
"ryan",
"lowe",
"2022",
"training",
"language",
"models",
"to",
"follow",
"in",
"structions",
"with",
"human",
"feedback",
"yingqi",
"qu",
"yuchen",
"ding",
"jing",
"liu",
"kai",
"liu",
"ruiyang",
"ren",
"wayne",
"xin",
"zhao",
"daxiang",
"dong",
"hua",
"wu",
"and",
"haifeng",
"wang",
"2021",
"rocketqa",
"an",
"opti",
"mized",
"training",
"approach",
"to",
"dense",
"passage",
"retrieval",
"for",
"open",
"domain",
"question",
"answering",
"in",
"proceed",
"ings",
"of",
"the",
"2021",
"conference",
"of",
"the",
"north",
"ameri",
"can",
"chapter",
"of",
"the",
"association",
"for",
"computational",
"linguistics",
"human",
"language",
"technologies",
"pages",
"5835",
"5847",
"online",
"association",
"for",
"computational",
"linguistics",
"jack",
"w"
],
[
"in",
"proceed",
"ings",
"of",
"the",
"2021",
"conference",
"of",
"the",
"north",
"ameri",
"can",
"chapter",
"of",
"the",
"association",
"for",
"computational",
"linguistics",
"human",
"language",
"technologies",
"pages",
"5835",
"5847",
"online",
"association",
"for",
"computational",
"linguistics",
"jack",
"w",
"rae",
"sebastian",
"borgeaud",
"trevor",
"cai",
"katie",
"millican",
"jordan",
"hoffmann",
"francis",
"song",
"john",
"aslanides",
"sarah",
"henderson",
"roman",
"ring",
"susan",
"nah",
"young",
"eliza",
"rutherford",
"tom",
"hennigan",
"ja",
"cob",
"menick",
"albin",
"cassirer",
"richard",
"powell",
"george",
"van",
"den",
"driessche",
"lisa",
"anne",
"hendricks",
"mari",
"beth",
"rauh",
"po",
"sen",
"huang",
"amelia",
"glaese",
"jo",
"hannes",
"welbl",
"sumanth",
"dathathri",
"saffron",
"huang",
"jonathan",
"uesato",
"john",
"mellor",
"irina",
"higgins",
"an",
"tonia",
"creswell",
"nat",
"mcaleese",
"amy",
"wu",
"erich",
"elsen",
"siddhant",
"jayakumar",
"elena",
"buchatskaya",
"david",
"budden",
"esme",
"sutherland",
"karen",
"simonyan",
"michela",
"paganini",
"laurent",
"sifre",
"lena",
"martens",
"xiang",
"lorraine",
"li",
"adhiguna",
"kuncoro",
"aida",
"ne",
"matzadeh",
"elena",
"gribovskaya",
"domenic",
"donato",
"angeliki",
"lazaridou",
"arthur",
"mensch",
"jean",
"baptiste",
"lespiau",
"maria",
"tsimpoukelli",
"nikolai",
"grigorev",
"doug",
"fritz",
"thibault",
"sottiaux",
"mantas",
"pajarskas",
"toby",
"pohlen",
"zhitao",
"gong",
"daniel",
"toyama",
"cy",
"prien",
"de",
"masson",
"d",
"autume",
"yujia",
"li",
"tayfun",
"terzi",
"vladimir",
"mikulik",
"igor",
"babuschkin",
"aidan",
"clark",
"diego",
"de",
"las",
"casas",
"aurelia",
"guy",
"chris",
"jones",
"james",
"bradbury",
"matthew",
"johnson",
"blake",
"hecht",
"man",
"laura",
"weidinger",
"iason",
"gabriel",
"william",
"isaac",
"ed",
"lockhart",
"simon",
"osindero",
"laura",
"rimell",
"chris",
"dyer",
"oriol",
"vinyals",
"kareem",
"ayoub",
"jeff",
"stan",
"way",
"lorrayne",
"bennett",
"demis",
"hassabis",
"koray",
"kavukcuoglu",
"and",
"geoffrey",
"irving",
"2021",
"scal",
"ing",
"language",
"models",
"methods",
"analysis",
"insights",
"from",
"training",
"gopher",
"devendra",
"singh",
"sachan",
"mike",
"lewis",
"mandar",
"joshi",
"armen",
"aghajanyan",
"wen",
"tau",
"yih",
"joelle",
"pineau",
"and",
"luke",
"zettlemoyer",
"2022",
"improving",
"passage",
"re",
"trieval",
"with",
"zero",
"shot",
"question",
"generation",
"victor",
"sanh",
"albert",
"webson",
"colin",
"raffel",
"stephen",
"bach",
"lintang",
"sutawika",
"zaid",
"alyafeai",
"antoine",
"arnaud",
"stiegler",
"arun",
"raja",
"manan",
"dey",
"m",
"saiful",
"bari",
"canwen",
"xu",
"urmish",
"thakker",
"shanya",
"sharma",
"sharma",
"eliza",
"szczechla",
"taewoon",
"kim",
"gunjan",
"chhablani",
"nihal",
"v"
],
[
"nayak",
"de",
"bajyoti",
"datta",
"jonathan",
"chang",
"mike",
"tian",
"jian",
"jiang",
"han",
"wang",
"matteo",
"manica",
"sheng",
"shen",
"zheng",
"xin",
"yong",
"harshit",
"pandey",
"rachel",
"bawden",
"thomas",
"wang",
"trishala",
"neeraj",
"jos",
"rozen",
"ab",
"heesht",
"sharma",
"andrea",
"santilli",
"thibault",
"ja",
"son",
"alan",
"fries",
"ryan",
"teehan",
"teven",
"le",
"scao",
"stella",
"biderman",
"leo",
"gao",
"thomas",
"wolf",
"and",
"alexan",
"der",
"m",
"rush",
"2022",
"multitask",
"prompted",
"training",
"enables",
"zero",
"shot",
"task",
"generalization",
"in",
"the",
"tenth",
"international",
"conference",
"on",
"learning",
"representa",
"tions",
"iclr",
"2022",
"virtual",
"event",
"april",
"25",
"29",
"2022",
"openreview",
"net",
"yi",
"tay",
"vinh",
"q",
"tran",
"mostafa",
"dehghani",
"jianmo",
"ni",
"dara",
"bahri",
"harsh",
"mehta",
"zhen",
"qin",
"kai",
"hui",
"zhe",
"zhao",
"jai",
"prakash",
"gupta",
"tal",
"schuster",
"william",
"w",
"cohen",
"and",
"donald",
"metzler",
"2022",
"transformer",
"memory",
"as",
"a",
"differentiable",
"search",
"index",
"corr",
"abs",
"2202",
"06991",
"nandan",
"thakur",
"nils",
"reimers",
"andreas",
"ab",
"hishek",
"srivastava",
"and",
"iryna",
"gurevych",
"2021",
"beir",
"a",
"heterogenous",
"benchmark",
"for",
"zero",
"shot",
"evalu",
"ation",
"of",
"information",
"retrieval",
"models",
"corr",
"abs",
"2104",
"08663",
"romal",
"thoppilan",
"daniel",
"de",
"freitas",
"jamie",
"hall",
"noam",
"shazeer",
"apoorv",
"kulshreshtha",
"heng",
"tze",
"cheng",
"alicia",
"jin",
"taylor",
"bos",
"leslie",
"baker",
"yu",
"du",
"yaguang",
"li",
"hongrae",
"lee",
"huaixiu",
"steven",
"zheng",
"amin",
"ghafouri",
"marcelo",
"menegali",
"yanping",
"huang",
"maxim",
"krikun",
"dmitry",
"lepikhin",
"james",
"qin",
"dehao",
"chen",
"yuanzhong",
"xu",
"zhifeng",
"chen",
"adam",
"roberts",
"maarten",
"bosma",
"yanqi",
"zhou",
"chung",
"ching",
"chang",
"igor",
"krivokon",
"will",
"rusch",
"marc",
"pickett",
"kath",
"leen",
"s",
"meier",
"hellstern",
"meredith",
"ringel",
"morris",
"tulsee",
"doshi",
"renelito",
"delos",
"santos",
"toju",
"duke",
"johnny",
"soraker",
"ben",
"zevenbergen",
"vinodkumar",
"prabhakaran",
"mark",
"diaz",
"ben",
"hutchinson",
"kristen",
"olson",
"alejandra",
"molina",
"erin",
"hoffman",
"john",
"josh",
"lee",
"lora",
"aroyo",
"ravi",
"rajakumar",
"alena",
"butryna",
"matthew",
"lamm",
"viktoriya",
"kuzmina",
"joe",
"fenton",
"aaron",
"cohen",
"rachel",
"bernstein",
"ray",
"kurzweil",
"blaise",
"aguera",
"arcas",
"claire",
"cui",
"marian",
"croak",
"ed",
"h",
"chi",
"and",
"quoc",
"le",
"2022",
"lamda",
"lan",
"guage",
"models",
"for",
"dialog",
"applications",
"corr",
"abs",
"2201",
"08239",
"kexin",
"wang",
"nandan",
"thakur",
"nils",
"reimers",
"and",
"iryna",
"gurevych",
"2022"
],
[
"chi",
"and",
"quoc",
"le",
"2022",
"lamda",
"lan",
"guage",
"models",
"for",
"dialog",
"applications",
"corr",
"abs",
"2201",
"08239",
"kexin",
"wang",
"nandan",
"thakur",
"nils",
"reimers",
"and",
"iryna",
"gurevych",
"2022",
"gpl",
"generative",
"pseudo",
"label",
"ing",
"for",
"unsupervised",
"domain",
"adaptation",
"of",
"dense",
"re",
"trieval",
"in",
"proceedings",
"of",
"the",
"2022",
"conference",
"of",
"the",
"north",
"american",
"chapter",
"of",
"the",
"association",
"for",
"computational",
"linguistics",
"human",
"language",
"tech",
"nologies",
"pages",
"2345",
"2360",
"seattle",
"united",
"states",
"association",
"for",
"computational",
"linguistics",
"jason",
"wei",
"maarten",
"bosma",
"vincent",
"y",
"zhao",
"kelvin",
"guu",
"adams",
"wei",
"yu",
"brian",
"lester",
"nan",
"du",
"an"
],
[
"drew",
"m",
"dai",
"and",
"quoc",
"v",
"le",
"2022",
"finetuned",
"lan",
"guage",
"models",
"are",
"zero",
"shot",
"learners",
"in",
"the",
"tenth",
"international",
"conference",
"on",
"learning",
"representa",
"tions",
"iclr",
"2022",
"virtual",
"event",
"april",
"25",
"29",
"2022",
"openreview",
"net",
"lee",
"xiong",
"chenyan",
"xiong",
"ye",
"li",
"kwok",
"fung",
"tang",
"jialin",
"liu",
"paul",
"n",
"bennett",
"junaid",
"ahmed",
"and",
"arnold",
"overwijk",
"2021",
"approximate",
"nearest",
"neigh",
"bor",
"negative",
"contrastive",
"learning",
"for",
"dense",
"text",
"re",
"trieval",
"in",
"9th",
"international",
"conference",
"on",
"learning",
"representations",
"iclr",
"2021",
"virtual",
"event",
"austria",
"may",
"3",
"7",
"2021",
"openreview",
"net",
"yue",
"yu",
"chenyan",
"xiong",
"si",
"sun",
"chao",
"zhang",
"and",
"arnold",
"overwijk",
"2022",
"coco",
"dr",
"combating",
"dis",
"tribution",
"shifts",
"in",
"zero",
"shot",
"dense",
"retrieval",
"with",
"con",
"trastive",
"and",
"distributionally",
"robust",
"learning",
"in",
"pro",
"ceedings",
"of",
"the",
"2022",
"conference",
"on",
"empirical",
"meth",
"ods",
"in",
"natural",
"language",
"processing",
"xinyu",
"zhang",
"xueguang",
"ma",
"peng",
"shi",
"and",
"jimmy",
"lin",
"2021",
"mr",
"tydi",
"a",
"multi",
"lingual",
"benchmark",
"for",
"dense",
"retrieval",
"arxiv",
"2108",
"08787"
],
[
"a",
"appendix",
"a",
"1",
"instructions",
"a",
"1",
"1",
"web",
"search",
"please",
"write",
"a",
"passage",
"to",
"answer",
"the",
"question",
"question",
"question",
"passage",
"a",
"1",
"2",
"scifact",
"please",
"write",
"a",
"paper",
"passage",
"to",
"support",
"refute",
"the",
"claim",
"claim",
"claim",
"passage",
"a",
"1",
"3",
"arguana",
"please",
"write",
"a",
"counter",
"argument",
"for",
"the",
"passage",
"passage",
"passage",
"counter",
"argument",
"a",
"1",
"4",
"trec",
"covid",
"please",
"write",
"a",
"paper",
"passage",
"to",
"answer",
"the",
"question",
"question",
"question",
"passage",
"a",
"1",
"5",
"fiqa",
"please",
"write",
"a",
"article",
"passage",
"to",
"answer",
"the",
"question",
"question",
"question",
"passage",
"a",
"1",
"6",
"dbpedia",
"entity",
"please",
"write",
"a",
"passage",
"to",
"answer",
"the",
"question",
"question",
"question",
"passage",
"a",
"1",
"7",
"trec",
"news",
"please",
"write",
"a",
"news",
"passage",
"about",
"the",
"topic",
"topic",
"topic",
"passage",
"a",
"1",
"8",
"mr",
"tydi",
"please",
"write",
"a",
"passage",
"in",
"swahili",
"korean",
"japanese",
"bengali",
"to",
"answer",
"the",
"question",
"in",
"detail",
"question",
"question",
"passage"
],
[
"retrieval",
"augmented",
"generation",
"for",
"knowledge",
"intensive",
"nlp",
"tasks",
"patrick",
"lewis",
"ethan",
"perez",
"aleksandra",
"piktus",
"fabio",
"petroni",
"vladimir",
"karpukhin",
"naman",
"goyal",
"heinrich",
"mike",
"lewis",
"wen",
"tau",
"yih",
"tim",
"sebastian",
"riedel",
"douwe",
"kiela",
"facebook",
"ai",
"research",
"university",
"college",
"london",
"new",
"york",
"university",
"plewis",
"fb",
"com",
"abstract",
"large",
"pre",
"trained",
"language",
"models",
"have",
"been",
"shown",
"to",
"store",
"factual",
"knowledge",
"in",
"their",
"parameters",
"and",
"achieve",
"state",
"of",
"the",
"art",
"results",
"when",
"tuned",
"on",
"down",
"stream",
"nlp",
"tasks",
"however",
"their",
"ability",
"to",
"access",
"and",
"precisely",
"manipulate",
"knowl",
"edge",
"is",
"still",
"limited",
"and",
"hence",
"on",
"knowledge",
"intensive",
"tasks",
"their",
"performance",
"lags",
"behind",
"task",
"architectures",
"additionally",
"providing",
"provenance",
"for",
"their",
"decisions",
"and",
"updating",
"their",
"world",
"knowledge",
"remain",
"open",
"research",
"problems",
"pre",
"trained",
"models",
"with",
"a",
"differentiable",
"access",
"mechanism",
"to",
"explicit",
"non",
"parametric",
"memory",
"have",
"so",
"far",
"been",
"only",
"investigated",
"for",
"extractive",
"downstream",
"tasks",
"we",
"explore",
"a",
"general",
"purpose",
"tuning",
"recipe",
"for",
"retrieval",
"augmented",
"generation",
"rag",
"models",
"which",
"combine",
"pre",
"trained",
"parametric",
"and",
"non",
"parametric",
"mem",
"ory",
"for",
"language",
"generation",
"we",
"introduce",
"rag",
"models",
"where",
"the",
"parametric",
"memory",
"is",
"a",
"pre",
"trained",
"seq2seq",
"model",
"and",
"the",
"non",
"parametric",
"memory",
"is",
"a",
"dense",
"vector",
"index",
"of",
"wikipedia",
"accessed",
"with",
"a",
"pre",
"trained",
"neural",
"retriever",
"we",
"com",
"pare",
"two",
"rag",
"formulations",
"one",
"which",
"conditions",
"on",
"the",
"same",
"retrieved",
"passages",
"across",
"the",
"whole",
"generated",
"sequence",
"and",
"another",
"which",
"can",
"use",
"different",
"passages",
"per",
"token",
"we",
"tune",
"and",
"evaluate",
"our",
"models",
"on",
"a",
"wide",
"range",
"of",
"knowledge",
"intensive",
"nlp",
"tasks",
"and",
"set",
"the",
"state",
"of",
"the",
"art",
"on",
"three",
"open",
"domain",
"qa",
"tasks",
"outperforming",
"parametric",
"seq2seq",
"models",
"and",
"task",
"retrieve",
"and",
"extract",
"architectures",
"for",
"language",
"generation",
"tasks",
"we",
"that",
"rag",
"models",
"generate",
"more",
"diverse",
"and",
"factual",
"language",
"than",
"a",
"state",
"of",
"the",
"art",
"parametric",
"only",
"seq2seq",
"baseline"
],
[
"for",
"language",
"generation",
"tasks",
"we",
"that",
"rag",
"models",
"generate",
"more",
"diverse",
"and",
"factual",
"language",
"than",
"a",
"state",
"of",
"the",
"art",
"parametric",
"only",
"seq2seq",
"baseline",
"1",
"introduction",
"pre",
"trained",
"neural",
"language",
"models",
"have",
"been",
"shown",
"to",
"learn",
"a",
"substantial",
"amount",
"of",
"in",
"depth",
"knowl",
"edge",
"from",
"data",
"47",
"they",
"can",
"do",
"so",
"without",
"any",
"access",
"to",
"an",
"external",
"memory",
"as",
"a",
"parameterized",
"implicit",
"knowledge",
"base",
"51",
"52",
"while",
"this",
"development",
"is",
"exciting",
"such",
"models",
"do",
"have",
"down",
"sides",
"they",
"cannot",
"easily",
"expand",
"or",
"revise",
"their",
"memory",
"can",
"t",
"straightforwardly",
"provide",
"insight",
"into",
"their",
"predictions",
"and",
"may",
"produce",
"hallucinations",
"38",
"hybrid",
"models",
"that",
"combine",
"parametric",
"memory",
"with",
"non",
"parametric",
"i",
"e",
"retrieval",
"based",
"memories",
"20",
"26",
"48",
"can",
"address",
"some",
"of",
"these",
"issues",
"because",
"knowledge",
"can",
"be",
"directly",
"revised",
"and",
"expanded",
"and",
"accessed",
"knowledge",
"can",
"be",
"inspected",
"and",
"interpreted",
"realm",
"20",
"and",
"orqa",
"31",
"two",
"recently",
"introduced",
"models",
"that",
"combine",
"masked",
"language",
"models",
"8",
"with",
"a",
"differentiable",
"retriever",
"have",
"shown",
"promising",
"results",
"arxiv",
"2005",
"11401v4",
"cs",
"cl",
"12",
"apr",
"2021"
],
[
"the",
"divine",
"comedy",
"x",
"qquery",
"encoder",
"q",
"x",
"mips",
"p",
"parametric",
"margin",
"alize",
"this",
"14th",
"century",
"work",
"is",
"divided",
"into",
"3",
"sections",
"inferno",
"purgatorio",
"paradiso",
"y",
"end",
"to",
"end",
"backprop",
"through",
"q",
"and",
"p",
"barack",
"obama",
"was",
"born",
"in",
"hawaii",
"x",
"fact",
"v",
"fact",
"querysupports",
"y",
"question",
"generationfact",
"v",
"label",
"generationdocument",
"indexdefine",
"middle",
"ear",
"x",
"question",
"answering",
"question",
"querythe",
"middle",
"ear",
"includes",
"the",
"tympanic",
"cavity",
"and",
"the",
"three",
"ossicles",
"y",
"question",
"answering",
"answer",
"generationretriever",
"non",
"parametric",
"z",
"4",
"z3",
"z2",
"z",
"1d",
"z",
"jeopardy",
"question",
"generation",
"answer",
"queryfigure",
"1",
"overview",
"of",
"our",
"approach",
"we",
"combine",
"a",
"pre",
"trained",
"retriever",
"query",
"encoder",
"document",
"index",
"with",
"a",
"pre",
"trained",
"seq2seq",
"model",
"generator",
"and",
"tune",
"end",
"to",
"end",
"for",
"query",
"x",
"we",
"use",
"maximum",
"inner",
"product",
"search",
"mips",
"to",
"the",
"top",
"k",
"documents",
"zi",
"for",
"prediction",
"y",
"we",
"treatzas",
"a",
"latent",
"variable",
"and",
"marginalize",
"over",
"seq2seq",
"predictions",
"given",
"different",
"documents",
"but",
"have",
"only",
"explored",
"open",
"domain",
"extractive",
"question",
"answering",
"here",
"we",
"bring",
"hybrid",
"parametric",
"and",
"non",
"parametric",
"memory",
"to",
"the",
"workhorse",
"of",
"nlp",
"i",
"e",
"sequence",
"to",
"sequence",
"seq2seq",
"models",
"we",
"endow",
"pre",
"trained",
"parametric",
"memory",
"generation",
"models",
"with",
"a",
"non",
"parametric",
"memory",
"through",
"a",
"general",
"purpose",
"tuning",
"approach",
"which",
"we",
"refer",
"to",
"as",
"retrieval",
"augmented",
"generation",
"rag",
"we",
"build",
"rag",
"models",
"where",
"the",
"parametric",
"memory",
"is",
"a",
"pre",
"trained",
"seq2seq",
"transformer",
"and",
"the",
"non",
"parametric",
"memory",
"is",
"a",
"dense",
"vector",
"index",
"of",
"wikipedia",
"accessed",
"with",
"a",
"pre",
"trained",
"neural",
"retriever",
"we",
"combine",
"these",
"components",
"in",
"a",
"probabilistic",
"model",
"trained",
"end",
"to",
"end",
"fig",
"1",
"the",
"retriever",
"dense",
"passage",
"retriever",
"26",
"henceforth",
"dpr",
"provides",
"latent",
"documents",
"conditioned",
"on",
"the",
"input",
"and",
"the",
"seq2seq",
"model",
"bart",
"32",
"then",
"conditions",
"on",
"these",
"latent",
"documents",
"together",
"with",
"the",
"input",
"to",
"generate",
"the",
"output"
],
[
"1",
"the",
"retriever",
"dense",
"passage",
"retriever",
"26",
"henceforth",
"dpr",
"provides",
"latent",
"documents",
"conditioned",
"on",
"the",
"input",
"and",
"the",
"seq2seq",
"model",
"bart",
"32",
"then",
"conditions",
"on",
"these",
"latent",
"documents",
"together",
"with",
"the",
"input",
"to",
"generate",
"the",
"output",
"we",
"marginalize",
"the",
"latent",
"documents",
"with",
"a",
"top",
"k",
"approximation",
"either",
"on",
"a",
"per",
"output",
"basis",
"assuming",
"the",
"same",
"document",
"is",
"responsible",
"for",
"all",
"tokens",
"or",
"a",
"per",
"token",
"basis",
"where",
"different",
"documents",
"are",
"responsible",
"for",
"different",
"tokens",
"like",
"t5",
"51",
"or",
"bart",
"rag",
"can",
"be",
"tuned",
"on",
"any",
"seq2seq",
"task",
"whereby",
"both",
"the",
"generator",
"and",
"retriever",
"are",
"jointly",
"learned",
"there",
"has",
"been",
"extensive",
"previous",
"work",
"proposing",
"architectures",
"to",
"enrich",
"systems",
"with",
"non",
"parametric",
"memory",
"which",
"are",
"trained",
"from",
"scratch",
"for",
"tasks",
"e",
"g",
"memory",
"networks",
"64",
"55",
"stack",
"augmented",
"networks",
"25",
"and",
"memory",
"layers",
"30",
"in",
"contrast",
"we",
"explore",
"a",
"setting",
"where",
"both",
"parametric",
"and",
"non",
"parametric",
"memory",
"components",
"are",
"pre",
"trained",
"and",
"pre",
"loaded",
"with",
"extensive",
"knowledge",
"crucially",
"by",
"using",
"pre",
"trained",
"access",
"mechanisms",
"the",
"ability",
"to",
"access",
"knowledge",
"is",
"present",
"without",
"additional",
"training",
"our",
"results",
"highlight",
"the",
"of",
"combining",
"parametric",
"and",
"non",
"parametric",
"memory",
"with",
"genera",
"tion",
"for",
"knowledge",
"intensive",
"tasks",
"tasks",
"that",
"humans",
"could",
"not",
"reasonably",
"be",
"expected",
"to",
"perform",
"without",
"access",
"to",
"an",
"external",
"knowledge",
"source",
"our",
"rag",
"models",
"achieve",
"state",
"of",
"the",
"art",
"results",
"on",
"open",
"natural",
"questions",
"29",
"webquestions",
"3",
"and",
"curatedtrec",
"2",
"and",
"strongly",
"outperform",
"recent",
"approaches",
"that",
"use",
"specialised",
"pre",
"training",
"objectives",
"on",
"triviaqa",
"24",
"despite",
"these",
"being",
"extractive",
"tasks",
"we",
"that",
"unconstrained",
"generation",
"outperforms",
"previous",
"extractive",
"approaches",
"for",
"knowledge",
"intensive",
"generation",
"we",
"experiment",
"with",
"ms",
"marco",
"1",
"and",
"jeopardy",
"question",
"generation",
"and",
"we",
"that",
"our",
"models",
"generate",
"responses",
"that",
"are",
"more",
"factual",
"and",
"diverse",
"than",
"a",
"bart",
"baseline",
"for",
"fever",
"56",
"fact",
"we",
"achieve",
"results",
"within",
"4",
"3",
"of",
"state",
"of",
"the",
"art",
"pipeline",
"models",
"which",
"use",
"strong",
"retrieval",
"supervision"
],
[
"for",
"fever",
"56",
"fact",
"we",
"achieve",
"results",
"within",
"4",
"3",
"of",
"state",
"of",
"the",
"art",
"pipeline",
"models",
"which",
"use",
"strong",
"retrieval",
"supervision",
"finally",
"we",
"demonstrate",
"that",
"the",
"non",
"parametric",
"memory",
"can",
"be",
"replaced",
"to",
"update",
"the",
"models",
"knowledge",
"as",
"the",
"world",
"changes",
"1",
"2",
"methods",
"we",
"explore",
"rag",
"models",
"which",
"use",
"the",
"input",
"sequence",
"xto",
"retrieve",
"text",
"documents",
"zand",
"use",
"them",
"as",
"additional",
"context",
"when",
"generating",
"the",
"target",
"sequence",
"y",
"as",
"shown",
"in",
"figure",
"1",
"our",
"models",
"leverage",
"two",
"components",
"i",
"a",
"retriever",
"z",
"x",
"with",
"parameters",
"returns",
"top",
"k",
"truncated",
"distributions",
"over",
"text",
"passages",
"given",
"a",
"query",
"xand",
"ii",
"a",
"generator",
"yi",
"x",
"z",
"y",
"1",
"i",
"1",
"parametrized",
"1code",
"to",
"run",
"experiments",
"with",
"rag",
"has",
"been",
"open",
"sourced",
"as",
"part",
"of",
"the",
"huggingface",
"transform",
"ers",
"library",
"66",
"and",
"can",
"be",
"found",
"at",
"https",
"github",
"com",
"huggingface",
"transformers",
"blob",
"master",
"examples",
"rag",
"an",
"interactive",
"demo",
"of",
"rag",
"models",
"can",
"be",
"found",
"at",
"https",
"huggingface",
"co",
"rag",
"2"
],
[
"generates",
"a",
"current",
"token",
"based",
"on",
"a",
"context",
"of",
"the",
"previous",
"i",
"1tokensy1",
"i",
"1",
"the",
"original",
"inputxand",
"a",
"retrieved",
"passage",
"z",
"to",
"train",
"the",
"retriever",
"and",
"generator",
"end",
"to",
"end",
"we",
"treat",
"the",
"retrieved",
"document",
"as",
"a",
"latent",
"variable",
"we",
"propose",
"two",
"models",
"that",
"marginalize",
"over",
"the",
"latent",
"documents",
"in",
"different",
"ways",
"to",
"produce",
"a",
"distribution",
"over",
"generated",
"text",
"in",
"one",
"approach",
"rag",
"sequence",
"the",
"model",
"uses",
"the",
"same",
"document",
"to",
"predict",
"each",
"target",
"token",
"the",
"second",
"approach",
"rag",
"token",
"can",
"predict",
"each",
"target",
"token",
"based",
"on",
"a",
"different",
"document",
"in",
"the",
"following",
"we",
"formally",
"introduce",
"both",
"models",
"and",
"then",
"describe",
"the",
"as",
"well",
"as",
"the",
"training",
"and",
"decoding",
"procedure",
"2",
"1",
"models",
"rag",
"sequence",
"model",
"the",
"rag",
"sequence",
"model",
"uses",
"the",
"same",
"retrieved",
"document",
"to",
"generate",
"the",
"complete",
"sequence",
"technically",
"it",
"treats",
"the",
"retrieved",
"document",
"as",
"a",
"single",
"latent",
"variable",
"that",
"is",
"marginalized",
"to",
"get",
"the",
"seq2seq",
"probability",
"p",
"y",
"x",
"via",
"a",
"top",
"k",
"approximation",
"concretely",
"the",
"top",
"k",
"documents",
"are",
"retrieved",
"using",
"the",
"retriever",
"and",
"the",
"generator",
"produces",
"the",
"output",
"sequence",
"probability",
"for",
"each",
"document",
"which",
"are",
"then",
"marginalized",
"prag",
"sequence",
"y",
"x",
"z",
"top",
"k",
"p",
"x",
"z",
"x",
"y",
"x",
"z",
"z",
"top",
"k",
"p",
"x",
"z",
"x",
"n",
"yi",
"x",
"z",
"y",
"1",
"i",
"1",
"rag",
"token",
"model",
"in",
"the",
"rag",
"token",
"model",
"we",
"can",
"draw",
"a",
"different",
"latent",
"document",
"for",
"each",
"target",
"token",
"and",
"marginalize",
"accordingly",
"this",
"allows",
"the",
"generator",
"to",
"choose",
"content",
"from",
"several",
"documents",
"when",
"producing",
"an",
"answer",
"concretely",
"the",
"top",
"k",
"documents",
"are",
"retrieved",
"using",
"the",
"retriever",
"and",
"then",
"the",
"generator",
"produces",
"a",
"distribution",
"for",
"the",
"next",
"output",
"token",
"for",
"each",
"document",
"before",
"marginalizing",
"and",
"repeating",
"the",
"process",
"with",
"the",
"following",
"output",
"token",
"formally",
"we",
"prag",
"token",
"y",
"x",
"n",
"i",
"z",
"top",
"k",
"p",
"x",
"z",
"x",
"yi",
"x",
"z",
"y",
"1",
"i",
"1",
"finally",
"we",
"note",
"that",
"rag",
"can",
"be",
"used",
"for",
"sequence",
"tasks",
"by",
"considering",
"the",
"target",
"class",
"as",
"a",
"target",
"sequence",
"of",
"length",
"one",
"in",
"which",
"case",
"rag",
"sequence",
"and",
"rag",
"token",
"are",
"equivalent",
"2",
"2",
"retriever",
"dpr",
"the",
"retrieval",
"component",
"z",
"x",
"is",
"based",
"on",
"dpr",
"26"
],
[
"2",
"2",
"retriever",
"dpr",
"the",
"retrieval",
"component",
"z",
"x",
"is",
"based",
"on",
"dpr",
"26",
"dpr",
"follows",
"a",
"bi",
"encoder",
"architecture",
"z",
"x",
"exp",
"d",
"z",
"q",
"x",
"d",
"z",
"bertd",
"z",
"q",
"x",
"bertq",
"x",
"where",
"d",
"z",
"is",
"a",
"dense",
"representation",
"of",
"a",
"document",
"produced",
"by",
"a",
"bert",
"base",
"document",
"encoder",
"8",
"andq",
"x",
"a",
"query",
"representation",
"produced",
"by",
"a",
"query",
"encoder",
"also",
"based",
"on",
"bert",
"base",
"calculating",
"top",
"k",
"x",
"the",
"list",
"ofkdocumentszwith",
"highest",
"prior",
"probability",
"z",
"x",
"is",
"a",
"maximum",
"inner",
"product",
"search",
"mips",
"problem",
"which",
"can",
"be",
"approximately",
"solved",
"in",
"sub",
"linear",
"time",
"23",
"we",
"use",
"a",
"pre",
"trained",
"bi",
"encoder",
"from",
"dpr",
"to",
"initialize",
"our",
"retriever",
"and",
"to",
"build",
"the",
"document",
"index",
"this",
"retriever",
"was",
"trained",
"to",
"retrieve",
"documents",
"which",
"contain",
"answers",
"to",
"triviaqa",
"24",
"questions",
"and",
"natural",
"questions",
"29",
"we",
"refer",
"to",
"the",
"document",
"index",
"as",
"the",
"non",
"parametric",
"memory",
"2",
"3",
"generator",
"bart",
"the",
"generator",
"component",
"yi",
"x",
"z",
"y",
"1",
"i",
"1",
"could",
"be",
"modelled",
"using",
"any",
"encoder",
"decoder",
"we",
"use",
"bart",
"large",
"32",
"a",
"pre",
"trained",
"seq2seq",
"transformer",
"58",
"with",
"400m",
"parameters",
"to",
"combine",
"the",
"input",
"xwith",
"the",
"retrieved",
"content",
"zwhen",
"generating",
"from",
"bart",
"we",
"simply",
"concatenate",
"them",
"bart",
"was",
"pre",
"trained",
"using",
"a",
"denoising",
"objective",
"and",
"a",
"variety",
"of",
"different",
"noising",
"functions",
"it",
"has",
"obtained",
"state",
"of",
"the",
"art",
"results",
"on",
"a",
"diverse",
"set",
"of",
"generation",
"tasks",
"and",
"outperforms",
"comparably",
"sized",
"t5",
"models",
"32",
"we",
"refer",
"to",
"the",
"bart",
"generator",
"parameters",
"the",
"parametric",
"memory",
"henceforth",
"2",
"4",
"training",
"we",
"jointly",
"train",
"the",
"retriever",
"and",
"generator",
"components",
"without",
"any",
"direct",
"supervision",
"on",
"what",
"document",
"should",
"be",
"retrieved",
"given",
"a",
"tuning",
"training",
"corpus",
"of",
"input",
"output",
"pairs",
"xj",
"yj",
"we",
"3"
],
[
"minimize",
"the",
"negative",
"marginal",
"log",
"likelihood",
"of",
"each",
"target",
"j",
"logp",
"yj",
"xj",
"using",
"stochastic",
"gradient",
"descent",
"with",
"adam",
"28",
"updating",
"the",
"document",
"encoder",
"bertdduring",
"training",
"is",
"costly",
"as",
"it",
"requires",
"the",
"document",
"index",
"to",
"be",
"periodically",
"updated",
"as",
"realm",
"does",
"during",
"pre",
"training",
"20",
"we",
"do",
"not",
"this",
"step",
"necessary",
"for",
"strong",
"performance",
"and",
"keep",
"the",
"document",
"encoder",
"and",
"index",
"only",
"tuning",
"the",
"query",
"encoder",
"bert",
"qand",
"the",
"bart",
"generator",
"2",
"5",
"decoding",
"at",
"test",
"time",
"rag",
"sequence",
"and",
"rag",
"token",
"require",
"different",
"ways",
"to",
"approximate",
"arg",
"maxyp",
"y",
"x",
"rag",
"token",
"the",
"rag",
"token",
"model",
"can",
"be",
"seen",
"as",
"a",
"standard",
"autoregressive",
"seq2seq",
"genera",
"tor",
"with",
"transition",
"probability",
"p",
"yi",
"x",
"y",
"1",
"i",
"1",
"z",
"top",
"k",
"p",
"x",
"zi",
"x",
"yi",
"x",
"zi",
"y1",
"i",
"1",
"to",
"decode",
"we",
"can",
"plug",
"p",
"yi",
"x",
"y",
"1",
"i",
"1",
"into",
"a",
"standard",
"beam",
"decoder",
"rag",
"sequence",
"for",
"rag",
"sequence",
"the",
"likelihood",
"p",
"y",
"x",
"does",
"not",
"break",
"into",
"a",
"conventional",
"per",
"token",
"likelihood",
"hence",
"we",
"cannot",
"solve",
"it",
"with",
"a",
"single",
"beam",
"search",
"instead",
"we",
"run",
"beam",
"search",
"for",
"each",
"document",
"z",
"scoring",
"each",
"hypothesis",
"using",
"yi",
"x",
"z",
"y",
"1",
"i",
"1",
"this",
"yields",
"a",
"set",
"of",
"hypotheses",
"y",
"some",
"of",
"which",
"may",
"not",
"have",
"appeared",
"in",
"the",
"beams",
"of",
"all",
"documents",
"to",
"estimate",
"the",
"probability",
"of",
"an",
"hypothesis",
"ywe",
"run",
"an",
"additional",
"forward",
"pass",
"for",
"each",
"document",
"zfor",
"whichydoes",
"not",
"appear",
"in",
"the",
"beam",
"multiply",
"generator",
"probability",
"with",
"z",
"x",
"and",
"then",
"sum",
"the",
"probabilities",
"across",
"beams",
"for",
"the",
"marginals",
"we",
"refer",
"to",
"this",
"decoding",
"procedure",
"as",
"thorough",
"decoding",
"for",
"longer",
"output",
"sequences",
"y",
"can",
"become",
"large",
"requiring",
"many",
"forward",
"passes",
"for",
"more",
"decoding",
"we",
"can",
"make",
"a",
"further",
"approximation",
"that",
"y",
"x",
"zi",
"0whereywas",
"not",
"generated",
"during",
"beam",
"search",
"from",
"x",
"zi",
"this",
"avoids",
"the",
"need",
"to",
"run",
"additional",
"forward",
"passes",
"once",
"the",
"candidate",
"set",
"yhas",
"been",
"generated",
"we",
"refer",
"to",
"this",
"decoding",
"procedure",
"as",
"fast",
"decoding",
"3",
"experiments",
"we",
"experiment",
"with",
"rag",
"in",
"a",
"wide",
"range",
"of",
"knowledge",
"intensive",
"tasks",
"for",
"all",
"experiments",
"we",
"use",
"a",
"single",
"wikipedia",
"dump",
"for",
"our",
"non",
"parametric",
"knowledge",
"source",
"following",
"lee",
"et",
"al",
"31",
"and",
"karpukhin",
"et",
"al"
],
[
"for",
"all",
"experiments",
"we",
"use",
"a",
"single",
"wikipedia",
"dump",
"for",
"our",
"non",
"parametric",
"knowledge",
"source",
"following",
"lee",
"et",
"al",
"31",
"and",
"karpukhin",
"et",
"al",
"26",
"we",
"use",
"the",
"december",
"2018",
"dump",
"each",
"wikipedia",
"article",
"is",
"split",
"into",
"disjoint",
"100",
"word",
"chunks",
"to",
"make",
"a",
"total",
"of",
"21m",
"documents",
"we",
"use",
"the",
"document",
"encoder",
"to",
"compute",
"an",
"embedding",
"for",
"each",
"document",
"and",
"build",
"a",
"single",
"mips",
"index",
"using",
"faiss",
"23",
"with",
"a",
"hierarchical",
"navigable",
"small",
"world",
"approximation",
"for",
"fast",
"retrieval",
"37",
"during",
"training",
"we",
"retrieve",
"the",
"top",
"kdocuments",
"for",
"each",
"query",
"we",
"consider",
"k",
"5",
"10",
"for",
"training",
"and",
"set",
"kfor",
"test",
"time",
"using",
"dev",
"data",
"we",
"now",
"discuss",
"experimental",
"details",
"for",
"each",
"task",
"3",
"1",
"open",
"domain",
"question",
"answering",
"open",
"domain",
"question",
"answering",
"qa",
"is",
"an",
"important",
"real",
"world",
"application",
"and",
"common",
"testbed",
"for",
"knowledge",
"intensive",
"tasks",
"20",
"we",
"treat",
"questions",
"and",
"answers",
"as",
"input",
"output",
"text",
"pairs",
"x",
"y",
"and",
"train",
"rag",
"by",
"directly",
"minimizing",
"the",
"negative",
"log",
"likelihood",
"of",
"answers",
"we",
"compare",
"rag",
"to",
"the",
"popular",
"extractive",
"qa",
"paradigm",
"5",
"7",
"31",
"26",
"where",
"answers",
"are",
"extracted",
"spans",
"from",
"retrieved",
"documents",
"relying",
"primarily",
"on",
"non",
"parametric",
"knowledge",
"we",
"also",
"compare",
"to",
"closed",
"book",
"qa",
"approaches",
"52",
"which",
"like",
"rag",
"generate",
"answers",
"but",
"which",
"do",
"not",
"exploit",
"retrieval",
"instead",
"relying",
"purely",
"on",
"parametric",
"knowledge",
"we",
"consider",
"four",
"popular",
"open",
"domain",
"qa",
"datasets",
"natural",
"questions",
"nq",
"29",
"triviaqa",
"tqa",
"24",
"webquestions",
"wq",
"3",
"and",
"curatedtrec",
"ct",
"2",
"as",
"ct",
"and",
"wq",
"are",
"small",
"we",
"follow",
"dpr",
"26",
"by",
"initializing",
"ct",
"and",
"wq",
"models",
"with",
"our",
"nq",
"rag",
"model",
"we",
"use",
"the",
"same",
"train",
"dev",
"test",
"splits",
"as",
"prior",
"work",
"31",
"26",
"and",
"report",
"exact",
"match",
"em",
"scores",
"for",
"tqa",
"to",
"compare",
"with",
"t5",
"52",
"we",
"also",
"evaluate",
"on",
"the",
"tqa",
"wiki",
"test",
"set",
"3",
"2",
"abstractive",
"question",
"answering",
"rag",
"models",
"can",
"go",
"beyond",
"simple",
"extractive",
"qa",
"and",
"answer",
"questions",
"with",
"free",
"form",
"abstractive",
"text",
"generation",
"to",
"test",
"rag",
"s",
"natural",
"language",
"generation",
"nlg",
"in",
"a",
"knowledge",
"intensive",
"setting",
"we",
"use",
"the",
"msmarco",
"nlg",
"task",
"v2",
"1",
"43"
],
[
"to",
"test",
"rag",
"s",
"natural",
"language",
"generation",
"nlg",
"in",
"a",
"knowledge",
"intensive",
"setting",
"we",
"use",
"the",
"msmarco",
"nlg",
"task",
"v2",
"1",
"43",
"the",
"task",
"consists",
"of",
"questions",
"ten",
"gold",
"passages",
"retrieved",
"from",
"a",
"search",
"engine",
"for",
"each",
"question",
"and",
"a",
"full",
"sentence",
"answer",
"annotated",
"from",
"the",
"retrieved",
"passages",
"we",
"do",
"not",
"use",
"the",
"supplied",
"passages",
"only",
"the",
"questions",
"and",
"answers",
"to",
"treat",
"4"
],
[
"msmarco",
"as",
"an",
"open",
"domain",
"abstractive",
"qa",
"task",
"msmarco",
"has",
"some",
"questions",
"that",
"cannot",
"be",
"answered",
"in",
"a",
"way",
"that",
"matches",
"the",
"reference",
"answer",
"without",
"access",
"to",
"the",
"gold",
"passages",
"such",
"as",
"what",
"is",
"the",
"weather",
"in",
"v",
"olcano",
"ca",
"so",
"performance",
"will",
"be",
"lower",
"without",
"using",
"gold",
"passages",
"we",
"also",
"note",
"that",
"some",
"msmarco",
"questions",
"cannot",
"be",
"answered",
"using",
"wikipedia",
"alone",
"here",
"rag",
"can",
"rely",
"on",
"parametric",
"knowledge",
"to",
"generate",
"reasonable",
"responses",
"3",
"3",
"jeopardy",
"question",
"generation",
"to",
"evaluate",
"rag",
"s",
"generation",
"abilities",
"in",
"a",
"non",
"qa",
"setting",
"we",
"study",
"open",
"domain",
"question",
"gen",
"eration",
"rather",
"than",
"use",
"questions",
"from",
"standard",
"open",
"domain",
"qa",
"tasks",
"which",
"typically",
"consist",
"of",
"short",
"simple",
"questions",
"we",
"propose",
"the",
"more",
"demanding",
"task",
"of",
"generating",
"jeopardy",
"questions",
"jeopardy",
"is",
"an",
"unusual",
"format",
"that",
"consists",
"of",
"trying",
"to",
"guess",
"an",
"entity",
"from",
"a",
"fact",
"about",
"that",
"entity",
"for",
"example",
"the",
"world",
"cup",
"is",
"the",
"answer",
"to",
"the",
"question",
"in",
"1986",
"mexico",
"scored",
"as",
"the",
"country",
"to",
"host",
"this",
"international",
"sports",
"competition",
"twice",
"as",
"jeopardy",
"questions",
"are",
"precise",
"factual",
"statements",
"generating",
"jeopardy",
"questions",
"conditioned",
"on",
"their",
"answer",
"entities",
"constitutes",
"a",
"challenging",
"knowledge",
"intensive",
"generation",
"task",
"we",
"use",
"the",
"splits",
"from",
"searchqa",
"10",
"with",
"100k",
"train",
"14k",
"dev",
"and",
"27k",
"test",
"examples",
"as",
"this",
"is",
"a",
"new",
"task",
"we",
"train",
"a",
"bart",
"model",
"for",
"comparison",
"following",
"67",
"we",
"evaluate",
"using",
"the",
"squad",
"tuned",
"q",
"bleu",
"1",
"metric",
"42",
"q",
"bleu",
"is",
"a",
"variant",
"of",
"bleu",
"with",
"a",
"higher",
"weight",
"for",
"matching",
"entities",
"and",
"has",
"higher",
"correlation",
"with",
"human",
"judgment",
"for",
"question",
"generation",
"than",
"standard",
"metrics",
"we",
"also",
"perform",
"two",
"human",
"evaluations",
"one",
"to",
"assess",
"generation",
"factuality",
"and",
"one",
"for",
"we",
"factuality",
"as",
"whether",
"a",
"statement",
"can",
"be",
"corroborated",
"by",
"trusted",
"external",
"sources",
"and",
"as",
"high",
"mutual",
"dependence",
"between",
"the",
"input",
"and",
"output",
"33",
"we",
"follow",
"best",
"practice",
"and",
"use",
"pairwise",
"comparative",
"evaluation",
"34",
"evaluators",
"are",
"shown",
"an",
"answer",
"and",
"two",
"generated",
"questions",
"one",
"from",
"bart",
"and",
"one",
"from",
"rag"
],
[
"we",
"follow",
"best",
"practice",
"and",
"use",
"pairwise",
"comparative",
"evaluation",
"34",
"evaluators",
"are",
"shown",
"an",
"answer",
"and",
"two",
"generated",
"questions",
"one",
"from",
"bart",
"and",
"one",
"from",
"rag",
"they",
"are",
"then",
"asked",
"to",
"pick",
"one",
"of",
"four",
"options",
"quuestion",
"a",
"is",
"better",
"question",
"b",
"is",
"better",
"both",
"are",
"good",
"or",
"neither",
"is",
"good",
"3",
"4",
"fact",
"fever",
"56",
"requires",
"classifying",
"whether",
"a",
"natural",
"language",
"claim",
"is",
"supported",
"or",
"refuted",
"by",
"wikipedia",
"or",
"whether",
"there",
"is",
"not",
"enough",
"information",
"to",
"decide",
"the",
"task",
"requires",
"retrieving",
"evidence",
"from",
"wikipedia",
"relating",
"to",
"the",
"claim",
"and",
"then",
"reasoning",
"over",
"this",
"evidence",
"to",
"classify",
"whether",
"the",
"claim",
"is",
"true",
"false",
"or",
"from",
"wikipedia",
"alone",
"fever",
"is",
"a",
"retrieval",
"problem",
"coupled",
"with",
"an",
"challenging",
"entailment",
"reasoning",
"task",
"it",
"also",
"provides",
"an",
"appropriate",
"testbed",
"for",
"exploring",
"the",
"rag",
"models",
"ability",
"to",
"handle",
"rather",
"than",
"generation",
"we",
"map",
"fever",
"class",
"labels",
"supports",
"refutes",
"or",
"not",
"enough",
"info",
"to",
"single",
"output",
"tokens",
"and",
"directly",
"train",
"with",
"claim",
"class",
"pairs",
"crucially",
"unlike",
"most",
"other",
"approaches",
"to",
"fever",
"we",
"do",
"not",
"use",
"supervision",
"on",
"retrieved",
"evidence",
"in",
"many",
"real",
"world",
"applications",
"retrieval",
"supervision",
"signals",
"aren",
"t",
"available",
"and",
"models",
"that",
"do",
"not",
"require",
"such",
"supervision",
"will",
"be",
"applicable",
"to",
"a",
"wider",
"range",
"of",
"tasks",
"we",
"explore",
"two",
"variants",
"the",
"standard",
"3",
"way",
"task",
"supports",
"refutes",
"not",
"enough",
"info",
"and",
"the",
"2",
"way",
"supports",
"refutes",
"task",
"studied",
"in",
"thorne",
"and",
"vlachos",
"57",
"in",
"both",
"cases",
"we",
"report",
"label",
"accuracy",
"4",
"results",
"4",
"1",
"open",
"domain",
"question",
"answering",
"table",
"1",
"shows",
"results",
"for",
"rag",
"along",
"with",
"state",
"of",
"the",
"art",
"models",
"on",
"all",
"four",
"open",
"domain",
"qa",
"tasks",
"rag",
"sets",
"a",
"new",
"state",
"of",
"the",
"art",
"only",
"on",
"the",
"t5",
"comparable",
"split",
"for",
"tqa",
"rag",
"combines",
"the",
"generation",
"of",
"the",
"closed",
"book",
"parametric",
"only",
"approaches",
"and",
"the",
"performance",
"of",
"open",
"book",
"retrieval",
"based",
"approaches",
"unlike",
"realm",
"and",
"t5",
"ssm",
"rag",
"enjoys",
"strong",
"results",
"without",
"expensive",
"specialized",
"salient",
"span",
"masking",
"pre",
"training",
"20"
],
[
"unlike",
"realm",
"and",
"t5",
"ssm",
"rag",
"enjoys",
"strong",
"results",
"without",
"expensive",
"specialized",
"salient",
"span",
"masking",
"pre",
"training",
"20",
"it",
"is",
"worth",
"noting",
"that",
"rag",
"s",
"retriever",
"is",
"initialized",
"using",
"dpr",
"s",
"retriever",
"which",
"uses",
"retrieval",
"supervision",
"on",
"natural",
"questions",
"and",
"triviaqa",
"rag",
"compares",
"favourably",
"to",
"the",
"dpr",
"qa",
"system",
"which",
"uses",
"a",
"bert",
"based",
"cross",
"encoder",
"to",
"re",
"rank",
"documents",
"along",
"with",
"an",
"extractive",
"reader",
"rag",
"demonstrates",
"that",
"neither",
"a",
"re",
"ranker",
"nor",
"extractive",
"reader",
"is",
"necessary",
"for",
"state",
"of",
"the",
"art",
"performance",
"there",
"are",
"several",
"advantages",
"to",
"generating",
"answers",
"even",
"when",
"it",
"is",
"possible",
"to",
"extract",
"them",
"docu",
"ments",
"with",
"clues",
"about",
"the",
"answer",
"but",
"do",
"not",
"contain",
"the",
"answer",
"verbatim",
"can",
"still",
"contribute",
"towards",
"a",
"correct",
"answer",
"being",
"generated",
"which",
"is",
"not",
"possible",
"with",
"standard",
"extractive",
"approaches",
"leading",
"5"
],
[
"table",
"1",
"open",
"domain",
"qa",
"test",
"scores",
"for",
"tqa",
"left",
"column",
"uses",
"the",
"standard",
"test",
"set",
"for",
"open",
"domain",
"qa",
"right",
"column",
"uses",
"the",
"tqa",
"wiki",
"test",
"set",
"see",
"appendix",
"d",
"for",
"further",
"details",
"model",
"nq",
"tqa",
"wq",
"ct",
"closed",
"bookt5",
"11b",
"52",
"34",
"5",
"50",
"1",
"37",
"4",
"t5",
"11b",
"ssm",
"52",
"36",
"6",
"60",
"5",
"44",
"7",
"open",
"bookrealm",
"20",
"40",
"4",
"40",
"7",
"46",
"8",
"dpr",
"26",
"41",
"5",
"57",
"9",
"41",
"1",
"50",
"6",
"rag",
"token",
"44",
"1",
"55",
"2",
"66",
"1",
"45",
"5",
"50",
"0",
"rag",
"seq",
"44",
"5",
"56",
"8",
"68",
"0",
"45",
"2",
"52",
"2table",
"2",
"generation",
"and",
"test",
"scores",
"ms",
"marco",
"sota",
"is",
"4",
"fever",
"3",
"is",
"68",
"and",
"fever",
"2",
"is",
"57",
"uses",
"gold",
"context",
"evidence",
"best",
"model",
"without",
"gold",
"access",
"underlined",
"model",
"jeopardy",
"msmarco",
"fvr3",
"fvr2",
"b",
"1",
"qb",
"1",
"r",
"l",
"b",
"1",
"label",
"acc",
"sota",
"49",
"8",
"49",
"9",
"76",
"8",
"92",
"2",
"bart",
"15",
"1",
"19",
"7",
"38",
"2",
"41",
"6",
"64",
"0",
"81",
"1",
"rag",
"tok",
"17",
"3",
"22",
"2",
"40",
"1",
"41",
"572",
"5",
"89",
"5rag",
"seq",
"14",
"7",
"21",
"4",
"40",
"8",
"44",
"2",
"to",
"more",
"effective",
"marginalization",
"over",
"documents",
"furthermore",
"rag",
"can",
"generate",
"correct",
"answers",
"even",
"when",
"the",
"correct",
"answer",
"is",
"not",
"in",
"any",
"retrieved",
"document",
"achieving",
"11",
"8",
"accuracy",
"in",
"such",
"cases",
"for",
"nq",
"where",
"an",
"extractive",
"model",
"would",
"score",
"0",
"4",
"2",
"abstractive",
"question",
"answering",
"as",
"shown",
"in",
"table",
"2",
"rag",
"sequence",
"outperforms",
"bart",
"on",
"open",
"ms",
"marco",
"nlg",
"by",
"2",
"6",
"bleu",
"points",
"and",
"2",
"6",
"rouge",
"l",
"points",
"rag",
"approaches",
"state",
"of",
"the",
"art",
"model",
"performance",
"which",
"is",
"impressive",
"given",
"that",
"i",
"those",
"models",
"access",
"gold",
"passages",
"with",
"information",
"required",
"to",
"generate",
"the",
"reference",
"answer",
"ii",
"many",
"questions",
"are",
"unanswerable",
"without",
"the",
"gold",
"passages",
"and",
"iii",
"not",
"all",
"questions",
"are",
"answerable",
"from",
"wikipedia",
"alone",
"table",
"3",
"shows",
"some",
"generated",
"answers",
"from",
"our",
"models",
"qualitatively",
"we",
"that",
"rag",
"models",
"hallucinate",
"less",
"and",
"generate",
"factually",
"correct",
"text",
"more",
"often",
"than",
"bart",
"later",
"we",
"also",
"show",
"that",
"rag",
"generations",
"are",
"more",
"diverse",
"than",
"bart",
"generations",
"see",
"4",
"5",
"4",
"3",
"jeopardy",
"question",
"generation",
"table",
"2",
"shows",
"that",
"rag",
"token",
"performs",
"better",
"than",
"rag",
"sequence",
"on",
"jeopardy",
"question",
"generation",
"with",
"both",
"models",
"outperforming",
"bart",
"on",
"q",
"bleu",
"1",
"4",
"shows",
"human",
"evaluation",
"results",
"over",
"452",
"pairs",
"of",
"generations",
"from",
"bart",
"and",
"rag",
"token"
],
[
"4",
"shows",
"human",
"evaluation",
"results",
"over",
"452",
"pairs",
"of",
"generations",
"from",
"bart",
"and",
"rag",
"token",
"evaluators",
"indicated",
"that",
"bart",
"was",
"more",
"factual",
"than",
"rag",
"in",
"only",
"7",
"1",
"of",
"cases",
"while",
"rag",
"was",
"more",
"factual",
"in",
"42",
"7",
"of",
"cases",
"and",
"both",
"rag",
"and",
"bart",
"were",
"factual",
"in",
"a",
"further",
"17",
"of",
"cases",
"clearly",
"demonstrating",
"the",
"effectiveness",
"of",
"rag",
"on",
"the",
"task",
"over",
"a",
"state",
"of",
"the",
"art",
"generation",
"model",
"evaluators",
"also",
"rag",
"generations",
"to",
"be",
"more",
"by",
"a",
"large",
"margin",
"table",
"3",
"shows",
"typical",
"generations",
"from",
"each",
"model",
"jeopardy",
"questions",
"often",
"contain",
"two",
"separate",
"pieces",
"of",
"information",
"and",
"rag",
"token",
"may",
"perform",
"best",
"because",
"it",
"can",
"generate",
"responses",
"that",
"combine",
"content",
"from",
"several",
"documents",
"figure",
"2",
"shows",
"an",
"example",
"when",
"generating",
"sun",
"the",
"posterior",
"is",
"high",
"for",
"document",
"2",
"which",
"mentions",
"the",
"sun",
"also",
"rises",
"similarly",
"document",
"1",
"dominates",
"the",
"posterior",
"when",
"a",
"farewell",
"to",
"arms",
"is",
"generated",
"intriguingly",
"after",
"the",
"token",
"of",
"each",
"book",
"is",
"generated",
"the",
"document",
"posterior",
"this",
"observation",
"suggests",
"that",
"the",
"generator",
"can",
"complete",
"the",
"titles",
"without",
"depending",
"on",
"documents",
"in",
"other",
"words",
"the",
"model",
"s",
"parametric",
"knowledge",
"is",
"to",
"complete",
"the",
"titles",
"we",
"evidence",
"for",
"this",
"hypothesis",
"by",
"feeding",
"the",
"bart",
"only",
"baseline",
"with",
"the",
"partial",
"decoding",
"the",
"sun",
"bart",
"completes",
"the",
"generation",
"the",
"sunalso",
"rises",
"isanovel",
"bythis",
"author",
"of",
"the",
"sun",
"also",
"rises",
"indicating",
"the",
"title",
"the",
"sun",
"also",
"rises",
"is",
"stored",
"in",
"bart",
"s",
"parameters",
"similarly",
"bart",
"will",
"complete",
"the",
"partial",
"decoding",
"the",
"sunalso",
"rises",
"isanovel",
"bythis",
"author",
"of",
"a",
"with",
"the",
"sunalso",
"rises",
"isanovel",
"bythis",
"author",
"of",
"afarewell",
"toarms",
"this",
"example",
"shows",
"how",
"parametric",
"and",
"non",
"parametric",
"memories",
"work",
"together",
"the",
"non",
"parametric",
"component",
"helps",
"to",
"guide",
"the",
"generation",
"drawing",
"out",
"knowledge",
"stored",
"in",
"the",
"parametric",
"memory",
"4",
"4",
"fact",
"table",
"2",
"shows",
"our",
"results",
"on",
"fever"
],
[
"this",
"example",
"shows",
"how",
"parametric",
"and",
"non",
"parametric",
"memories",
"work",
"together",
"the",
"non",
"parametric",
"component",
"helps",
"to",
"guide",
"the",
"generation",
"drawing",
"out",
"knowledge",
"stored",
"in",
"the",
"parametric",
"memory",
"4",
"4",
"fact",
"table",
"2",
"shows",
"our",
"results",
"on",
"fever",
"for",
"3",
"way",
"rag",
"scores",
"are",
"within",
"4",
"3",
"of",
"state",
"of",
"the",
"art",
"models",
"which",
"are",
"complex",
"pipeline",
"systems",
"with",
"domain",
"architectures",
"and",
"substantial",
"engineering",
"trained",
"using",
"intermediate",
"retrieval",
"supervision",
"which",
"rag",
"does",
"not",
"require",
"6"
],
[
"document",
"1",
"his",
"works",
"are",
"considered",
"classics",
"of",
"american",
"literature",
"his",
"wartime",
"experiences",
"formed",
"the",
"basis",
"for",
"his",
"novel",
"a",
"farewell",
"to",
"arms",
"1929",
"document",
"2",
"artists",
"of",
"the",
"1920s",
"lost",
"generation",
"expatriate",
"community",
"his",
"debut",
"novel",
"the",
"sun",
"also",
"rises",
"was",
"published",
"in",
"1926",
"bos",
"thesunalsorises",
"isa",
"novelbythis",
"authorof",
"a",
"farewellto",
"arms",
"doc",
"1",
"doc",
"2",
"doc",
"3",
"doc",
"4",
"doc",
"5figure",
"2",
"rag",
"token",
"document",
"posterior",
"p",
"zi",
"x",
"yi",
"y",
"i",
"for",
"each",
"generated",
"token",
"for",
"input",
"hem",
"ingway",
"for",
"jeopardy",
"generation",
"with",
"5",
"retrieved",
"documents",
"the",
"posterior",
"for",
"document",
"1",
"is",
"high",
"when",
"generating",
"a",
"farewell",
"to",
"arms",
"and",
"for",
"document",
"2",
"when",
"generating",
"the",
"sun",
"also",
"rises",
"table",
"3",
"examples",
"from",
"generation",
"tasks",
"rag",
"models",
"generate",
"more",
"and",
"factually",
"accurate",
"responses",
"indicates",
"factually",
"incorrect",
"responses",
"indicates",
"partially",
"correct",
"responses",
"task",
"input",
"model",
"generation",
"ms",
"middle",
"earbart",
"the",
"middle",
"ear",
"is",
"the",
"part",
"of",
"the",
"ear",
"between",
"the",
"middle",
"ear",
"and",
"the",
"nose",
"rag",
"t",
"the",
"middle",
"ear",
"is",
"the",
"portion",
"of",
"the",
"ear",
"internal",
"to",
"the",
"eardrum",
"rag",
"s",
"the",
"middle",
"ear",
"includes",
"the",
"tympanic",
"cavity",
"and",
"the",
"three",
"ossicles",
"what",
"currency",
"needed",
"in",
"scotlandbart",
"the",
"currency",
"needed",
"in",
"scotland",
"is",
"pound",
"sterling",
"rag",
"t",
"pound",
"is",
"the",
"currency",
"needed",
"in",
"scotland",
"rag",
"s",
"the",
"currency",
"needed",
"in",
"scotland",
"is",
"the",
"pound",
"sterling",
"jeopardy",
"question",
"gener",
"ationwashingtonbart",
"this",
"state",
"has",
"the",
"largest",
"number",
"of",
"counties",
"in",
"the",
"u",
"s",
"rag",
"t",
"it",
"s",
"the",
"only",
"u",
"s",
"state",
"named",
"for",
"a",
"u",
"s",
"president",
"rag",
"s",
"it",
"s",
"the",
"state",
"where",
"you",
"ll",
"mount",
"rainier",
"national",
"park",
"the",
"divine",
"comedybart",
"this",
"epic",
"poem",
"by",
"dante",
"is",
"divided",
"into",
"3",
"parts",
"the",
"inferno",
"the",
"purgatorio",
"the",
"purgatorio",
"rag",
"t",
"dante",
"s",
"inferno",
"is",
"the",
"part",
"of",
"this",
"epic",
"poem",
"rag",
"s",
"this",
"14th",
"century",
"work",
"is",
"divided",
"into",
"3",
"sections",
"inferno",
"purgatorio",
"paradiso",
"for",
"2",
"way",
"we",
"compare",
"against",
"thorne",
"and",
"vlachos",
"57",
"who",
"train",
"roberta",
"35",
"to",
"classify",
"the",
"claim",
"as",
"true",
"or",
"false",
"given",
"the",
"gold",
"evidence",
"sentence"
],
[
"rag",
"achieves",
"an",
"accuracy",
"within",
"2",
"7",
"of",
"this",
"model",
"despite",
"being",
"supplied",
"with",
"only",
"the",
"claim",
"and",
"retrieving",
"its",
"own",
"evidence",
"we",
"also",
"analyze",
"whether",
"documents",
"retrieved",
"by",
"rag",
"correspond",
"to",
"documents",
"annotated",
"as",
"gold",
"evidence",
"in",
"fever",
"we",
"calculate",
"the",
"overlap",
"in",
"article",
"titles",
"between",
"the",
"top",
"kdocuments",
"retrieved",
"by",
"rag",
"and",
"gold",
"evidence",
"annotations",
"we",
"that",
"the",
"top",
"retrieved",
"document",
"is",
"from",
"a",
"gold",
"article",
"in",
"71",
"of",
"cases",
"and",
"a",
"gold",
"article",
"is",
"present",
"in",
"the",
"top",
"10",
"retrieved",
"articles",
"in",
"90",
"of",
"cases",
"4",
"5",
"additional",
"results",
"generation",
"diversity",
"section",
"4",
"3",
"shows",
"that",
"rag",
"models",
"are",
"more",
"factual",
"and",
"than",
"bart",
"for",
"jeopardy",
"question",
"generation",
"following",
"recent",
"work",
"on",
"diversity",
"promoting",
"decoding",
"33",
"59",
"39",
"we",
"also",
"investigate",
"generation",
"diversity",
"by",
"calculating",
"the",
"ratio",
"of",
"distinct",
"ngrams",
"to",
"total",
"ngrams",
"generated",
"by",
"different",
"models",
"table",
"5",
"shows",
"that",
"rag",
"sequence",
"s",
"generations",
"are",
"more",
"diverse",
"than",
"rag",
"token",
"s",
"and",
"both",
"are",
"more",
"diverse",
"than",
"bart",
"without",
"needing",
"any",
"diversity",
"promoting",
"decoding",
"retrieval",
"ablations",
"a",
"key",
"feature",
"of",
"rag",
"is",
"learning",
"to",
"retrieve",
"relevant",
"information",
"for",
"the",
"task",
"to",
"assess",
"the",
"effectiveness",
"of",
"the",
"retrieval",
"mechanism",
"we",
"run",
"ablations",
"where",
"we",
"freeze",
"the",
"retriever",
"during",
"training",
"as",
"shown",
"in",
"table",
"6",
"learned",
"retrieval",
"improves",
"results",
"for",
"all",
"tasks",
"we",
"compare",
"rag",
"s",
"dense",
"retriever",
"to",
"a",
"word",
"overlap",
"based",
"bm25",
"retriever",
"53",
"here",
"we",
"replace",
"rag",
"s",
"retriever",
"with",
"a",
"bm25",
"system",
"and",
"use",
"bm25",
"retrieval",
"scores",
"as",
"logits",
"when",
"calculating",
"p",
"z",
"x",
"table",
"6",
"shows",
"the",
"results",
"for",
"fever",
"bm25",
"performs",
"best",
"perhaps",
"since",
"fever",
"claims",
"are",
"heavily",
"entity",
"centric",
"and",
"thus",
"well",
"suited",
"for",
"word",
"overlap",
"based",
"retrieval",
"differentiable",
"retrieval",
"improves",
"results",
"on",
"all",
"other",
"tasks",
"especially",
"for",
"open",
"domain",
"qa",
"where",
"it",
"is",
"crucial",
"index",
"hot",
"swapping",
"an",
"advantage",
"of",
"non",
"parametric",
"memory",
"models",
"like",
"rag",
"is",
"that",
"knowledge",
"can",
"be",
"easily",
"updated",
"at",
"test",
"time",
"parametric",
"only",
"models",
"like",
"t5",
"or",
"bart",
"need",
"further",
"training",
"to",
"update",
"their",
"behavior",
"as",
"the",
"world",
"changes"
],
[
"index",
"hot",
"swapping",
"an",
"advantage",
"of",
"non",
"parametric",
"memory",
"models",
"like",
"rag",
"is",
"that",
"knowledge",
"can",
"be",
"easily",
"updated",
"at",
"test",
"time",
"parametric",
"only",
"models",
"like",
"t5",
"or",
"bart",
"need",
"further",
"training",
"to",
"update",
"their",
"behavior",
"as",
"the",
"world",
"changes",
"to",
"demonstrate",
"we",
"build",
"an",
"index",
"using",
"the",
"drqa",
"5",
"wikipedia",
"dump",
"from",
"december",
"2016",
"and",
"compare",
"outputs",
"from",
"rag",
"using",
"this",
"index",
"to",
"the",
"newer",
"index",
"from",
"our",
"main",
"results",
"december",
"2018",
"we",
"prepare",
"a",
"list",
"of",
"82",
"world",
"leaders",
"who",
"had",
"changed",
"7"
],
[
"table",
"4",
"human",
"assessments",
"for",
"the",
"jeopardy",
"question",
"generation",
"task",
"factuality",
"bart",
"better",
"7",
"1",
"16",
"8",
"rag",
"better",
"42",
"7",
"37",
"4",
"both",
"good",
"11",
"7",
"11",
"8",
"both",
"poor",
"17",
"7",
"6",
"9",
"no",
"majority",
"20",
"8",
"20",
"1",
"table",
"5",
"ratio",
"of",
"distinct",
"to",
"total",
"tri",
"grams",
"for",
"generation",
"tasks",
"msmarco",
"jeopardy",
"qgen",
"gold",
"89",
"6",
"90",
"0",
"bart",
"70",
"7",
"32",
"4",
"rag",
"token",
"77",
"8",
"46",
"8",
"rag",
"seq",
"83",
"5",
"53",
"8",
"table",
"6",
"ablations",
"on",
"the",
"dev",
"set",
"as",
"fever",
"is",
"a",
"task",
"both",
"rag",
"models",
"are",
"equivalent",
"model",
"nq",
"tqa",
"wq",
"ct",
"jeopardy",
"qgen",
"msmarco",
"fvr",
"3",
"fvr",
"2",
"exact",
"match",
"b",
"1",
"qb",
"1",
"r",
"l",
"b",
"1",
"label",
"accuracy",
"rag",
"token",
"bm25",
"29",
"7",
"41",
"5",
"32",
"1",
"33",
"1",
"17",
"5",
"22",
"3",
"55",
"5",
"48",
"475",
"1",
"91",
"6rag",
"sequence",
"bm25",
"31",
"8",
"44",
"1",
"36",
"6",
"33",
"8",
"11",
"1",
"19",
"5",
"56",
"5",
"46",
"9",
"rag",
"token",
"frozen",
"37",
"8",
"50",
"1",
"37",
"1",
"51",
"1",
"16",
"7",
"21",
"7",
"55",
"9",
"49",
"472",
"9",
"89",
"4rag",
"sequence",
"frozen",
"41",
"2",
"52",
"1",
"41",
"8",
"52",
"6",
"11",
"8",
"19",
"6",
"56",
"7",
"47",
"3",
"rag",
"token",
"43",
"5",
"54",
"8",
"46",
"5",
"51",
"9",
"17",
"9",
"22",
"6",
"56",
"2",
"49",
"474",
"5",
"90",
"6rag",
"sequence",
"44",
"0",
"55",
"8",
"44",
"9",
"53",
"4",
"15",
"3",
"21",
"5",
"57",
"2",
"47",
"5",
"between",
"these",
"dates",
"and",
"use",
"a",
"template",
"who",
"is",
"position",
"e",
"g",
"who",
"is",
"the",
"president",
"of",
"peru",
"to",
"query",
"our",
"nq",
"rag",
"model",
"with",
"each",
"index",
"rag",
"answers",
"70",
"correctly",
"using",
"the",
"2016",
"index",
"for",
"2016",
"world",
"leaders",
"and",
"68",
"using",
"the",
"2018",
"index",
"for",
"2018",
"world",
"leaders",
"accuracy",
"with",
"mismatched",
"indices",
"is",
"low",
"12",
"with",
"the",
"2018",
"index",
"and",
"2016",
"leaders",
"4",
"with",
"the",
"2016",
"index",
"and",
"2018",
"leaders",
"this",
"shows",
"we",
"can",
"update",
"rag",
"s",
"world",
"knowledge",
"by",
"simply",
"replacing",
"its",
"non",
"parametric",
"memory",
"effect",
"of",
"retrieving",
"more",
"documents",
"models",
"are",
"trained",
"with",
"either",
"5",
"or",
"10",
"retrieved",
"latent",
"documents",
"and",
"we",
"do",
"not",
"observe",
"differences",
"in",
"performance",
"between",
"them",
"we",
"have",
"the",
"to",
"adjust",
"the",
"number",
"of",
"retrieved",
"documents",
"at",
"test",
"time",
"which",
"can",
"affect",
"performance",
"and",
"runtime",
"figure",
"3",
"left",
"shows",
"that",
"retrieving",
"more",
"documents",
"at",
"test",
"time",
"monotonically",
"improves",
"open",
"domain",
"qa",
"results",
"for",
"rag",
"sequence",
"but",
"performance",
"peaks",
"for",
"rag",
"token",
"at",
"10",
"retrieved",
"documents",
"figure",
"3",
"right",
"shows",
"that",
"retrieving",
"more",
"documents",
"leads",
"to",
"higher",
"rouge",
"l",
"for",
"rag",
"token",
"at",
"the",
"expense",
"of",
"bleu",
"1",
"but",
"the",
"effect",
"is",
"less",
"pronounced",
"for",
"rag",
"sequence"
],
[
"figure",
"3",
"right",
"shows",
"that",
"retrieving",
"more",
"documents",
"leads",
"to",
"higher",
"rouge",
"l",
"for",
"rag",
"token",
"at",
"the",
"expense",
"of",
"bleu",
"1",
"but",
"the",
"effect",
"is",
"less",
"pronounced",
"for",
"rag",
"sequence",
"10",
"20",
"30",
"40",
"50",
"kr",
"e",
"t",
"r",
"i",
"e",
"v",
"e",
"dd",
"o",
"c",
"s394041424344nq",
"exact",
"matchrag",
"tok",
"rag",
"seq",
"10",
"20",
"30",
"40",
"50",
"kr",
"e",
"t",
"r",
"i",
"e",
"v",
"e",
"dd",
"o",
"c",
"s4050607080nq",
"answer",
"recall",
"krag",
"tok",
"rag",
"seq",
"fixed",
"dpr",
"bm25",
"10",
"20",
"30",
"40",
"50",
"kr",
"e",
"t",
"r",
"i",
"e",
"v",
"e",
"dd",
"o",
"c",
"s4850525456bleu",
"1",
"rouge",
"l",
"scorerag",
"tok",
"r",
"l",
"rag",
"tok",
"b",
"1",
"rag",
"seq",
"r",
"l",
"rag",
"seq",
"b",
"1",
"figure",
"3",
"left",
"nq",
"performance",
"as",
"more",
"documents",
"are",
"retrieved",
"center",
"retrieval",
"recall",
"perfor",
"mance",
"in",
"nq",
"right",
"ms",
"marco",
"bleu",
"1",
"and",
"rouge",
"l",
"as",
"more",
"documents",
"are",
"retrieved",
"5",
"related",
"work",
"single",
"task",
"retrieval",
"prior",
"work",
"has",
"shown",
"that",
"retrieval",
"improves",
"performance",
"across",
"a",
"variety",
"of",
"nlp",
"tasks",
"when",
"considered",
"in",
"isolation",
"such",
"tasks",
"include",
"open",
"domain",
"question",
"answering",
"5",
"29",
"fact",
"checking",
"56",
"fact",
"completion",
"48",
"long",
"form",
"question",
"answering",
"12",
"wikipedia",
"article",
"generation",
"36",
"dialogue",
"41",
"65",
"9",
"13",
"translation",
"17",
"and",
"language",
"modeling",
"19",
"27",
"our",
"work",
"previous",
"successes",
"in",
"incorporating",
"retrieval",
"into",
"individual",
"tasks",
"showing",
"that",
"a",
"single",
"retrieval",
"based",
"architecture",
"is",
"capable",
"of",
"achieving",
"strong",
"performance",
"across",
"several",
"tasks",
"8"
],
[
"general",
"purpose",
"architectures",
"for",
"nlp",
"prior",
"work",
"on",
"general",
"purpose",
"architectures",
"for",
"nlp",
"tasks",
"has",
"shown",
"great",
"success",
"without",
"the",
"use",
"of",
"retrieval",
"a",
"single",
"pre",
"trained",
"language",
"model",
"has",
"been",
"shown",
"to",
"achieve",
"strong",
"performance",
"on",
"various",
"tasks",
"in",
"the",
"glue",
"bench",
"marks",
"60",
"61",
"after",
"tuning",
"49",
"8",
"gpt",
"2",
"50",
"later",
"showed",
"that",
"a",
"single",
"left",
"to",
"right",
"pre",
"trained",
"language",
"model",
"could",
"achieve",
"strong",
"performance",
"across",
"both",
"discriminative",
"and",
"generative",
"tasks",
"for",
"further",
"improvement",
"bart",
"32",
"and",
"t5",
"51",
"52",
"propose",
"a",
"single",
"pre",
"trained",
"encoder",
"decoder",
"model",
"that",
"leverages",
"bi",
"directional",
"attention",
"to",
"achieve",
"stronger",
"performance",
"on",
"discriminative",
"and",
"generative",
"tasks",
"our",
"work",
"aims",
"to",
"expand",
"the",
"space",
"of",
"possible",
"tasks",
"with",
"a",
"single",
"architecture",
"by",
"learning",
"a",
"retrieval",
"module",
"to",
"augment",
"pre",
"trained",
"generative",
"language",
"models",
"learned",
"retrieval",
"there",
"is",
"work",
"on",
"learning",
"to",
"retrieve",
"documents",
"in",
"information",
"retrieval",
"more",
"recently",
"with",
"pre",
"trained",
"neural",
"language",
"models",
"44",
"26",
"similar",
"to",
"ours",
"some",
"work",
"optimizes",
"the",
"retrieval",
"module",
"to",
"aid",
"in",
"a",
"downstream",
"task",
"such",
"as",
"question",
"answering",
"using",
"search",
"46",
"reinforcement",
"learning",
"6",
"63",
"62",
"or",
"a",
"latent",
"variable",
"approach",
"31",
"20",
"as",
"in",
"our",
"work",
"these",
"successes",
"leverage",
"different",
"retrieval",
"based",
"architectures",
"and",
"optimization",
"techniques",
"to",
"achieve",
"strong",
"performance",
"on",
"a",
"single",
"task",
"while",
"we",
"show",
"that",
"a",
"single",
"retrieval",
"based",
"architecture",
"can",
"be",
"tuned",
"for",
"strong",
"performance",
"on",
"a",
"variety",
"of",
"tasks",
"memory",
"based",
"architectures",
"our",
"document",
"index",
"can",
"be",
"seen",
"as",
"a",
"large",
"external",
"memory",
"for",
"neural",
"networks",
"to",
"attend",
"to",
"analogous",
"to",
"memory",
"networks",
"64",
"55",
"concurrent",
"work",
"14",
"learns",
"to",
"retrieve",
"a",
"trained",
"embedding",
"for",
"each",
"entity",
"in",
"the",
"input",
"rather",
"than",
"to",
"retrieve",
"raw",
"text",
"as",
"in",
"our",
"work",
"other",
"work",
"improves",
"the",
"ability",
"of",
"dialog",
"models",
"to",
"generate",
"factual",
"text",
"by",
"attending",
"over",
"fact",
"embeddings",
"15",
"13"
],
[
"concurrent",
"work",
"14",
"learns",
"to",
"retrieve",
"a",
"trained",
"embedding",
"for",
"each",
"entity",
"in",
"the",
"input",
"rather",
"than",
"to",
"retrieve",
"raw",
"text",
"as",
"in",
"our",
"work",
"other",
"work",
"improves",
"the",
"ability",
"of",
"dialog",
"models",
"to",
"generate",
"factual",
"text",
"by",
"attending",
"over",
"fact",
"embeddings",
"15",
"13",
"a",
"key",
"feature",
"of",
"our",
"memory",
"is",
"that",
"it",
"is",
"comprised",
"of",
"raw",
"text",
"rather",
"distributed",
"representations",
"which",
"makes",
"the",
"memory",
"both",
"i",
"human",
"readable",
"lending",
"a",
"form",
"of",
"interpretability",
"to",
"our",
"model",
"and",
"ii",
"human",
"writable",
"enabling",
"us",
"to",
"dynamically",
"update",
"the",
"model",
"s",
"memory",
"by",
"editing",
"the",
"document",
"index",
"this",
"approach",
"has",
"also",
"been",
"used",
"in",
"knowledge",
"intensive",
"dialog",
"where",
"generators",
"have",
"been",
"conditioned",
"on",
"retrieved",
"text",
"directly",
"albeit",
"obtained",
"via",
"tf",
"idf",
"rather",
"than",
"end",
"to",
"end",
"learnt",
"retrieval",
"9",
"retrieve",
"and",
"edit",
"approaches",
"our",
"method",
"shares",
"some",
"similarities",
"with",
"retrieve",
"and",
"edit",
"style",
"approaches",
"where",
"a",
"similar",
"training",
"input",
"output",
"pair",
"is",
"retrieved",
"for",
"a",
"given",
"input",
"and",
"then",
"edited",
"to",
"provide",
"a",
"output",
"these",
"approaches",
"have",
"proved",
"successful",
"in",
"a",
"number",
"of",
"domains",
"including",
"machine",
"translation",
"18",
"22",
"and",
"semantic",
"parsing",
"21",
"our",
"approach",
"does",
"have",
"several",
"differences",
"including",
"less",
"of",
"emphasis",
"on",
"lightly",
"editing",
"a",
"retrieved",
"item",
"but",
"on",
"aggregating",
"content",
"from",
"several",
"pieces",
"of",
"retrieved",
"content",
"as",
"well",
"as",
"learning",
"latent",
"retrieval",
"and",
"retrieving",
"evidence",
"documents",
"rather",
"than",
"related",
"training",
"pairs",
"this",
"said",
"rag",
"techniques",
"may",
"work",
"well",
"in",
"these",
"settings",
"and",
"could",
"represent",
"promising",
"future",
"work",
"6",
"discussion",
"in",
"this",
"work",
"we",
"presented",
"hybrid",
"generation",
"models",
"with",
"access",
"to",
"parametric",
"and",
"non",
"parametric",
"memory",
"we",
"showed",
"that",
"our",
"rag",
"models",
"obtain",
"state",
"of",
"the",
"art",
"results",
"on",
"open",
"domain",
"qa",
"we",
"found",
"that",
"people",
"prefer",
"rag",
"s",
"generation",
"over",
"purely",
"parametric",
"bart",
"rag",
"more",
"factual",
"and",
"we",
"conducted",
"an",
"thorough",
"investigation",
"of",
"the",
"learned",
"retrieval",
"component",
"validating",
"its",
"effectiveness",
"and",
"we",
"illustrated",
"how",
"the",
"retrieval",
"index",
"can",
"be",
"hot",
"swapped",
"to",
"update",
"the",
"model",
"without",
"requiring",
"any",
"retraining"
],
[
"we",
"conducted",
"an",
"thorough",
"investigation",
"of",
"the",
"learned",
"retrieval",
"component",
"validating",
"its",
"effectiveness",
"and",
"we",
"illustrated",
"how",
"the",
"retrieval",
"index",
"can",
"be",
"hot",
"swapped",
"to",
"update",
"the",
"model",
"without",
"requiring",
"any",
"retraining",
"in",
"future",
"work",
"it",
"may",
"be",
"fruitful",
"to",
"investigate",
"if",
"the",
"two",
"components",
"can",
"be",
"jointly",
"pre",
"trained",
"from",
"scratch",
"either",
"with",
"a",
"denoising",
"objective",
"similar",
"to",
"bart",
"or",
"some",
"another",
"objective",
"our",
"work",
"opens",
"up",
"new",
"research",
"directions",
"on",
"how",
"parametric",
"and",
"non",
"parametric",
"memories",
"interact",
"and",
"how",
"to",
"most",
"effectively",
"combine",
"them",
"showing",
"promise",
"in",
"being",
"applied",
"to",
"a",
"wide",
"variety",
"of",
"nlp",
"tasks",
"9"
],
[
"broader",
"impact",
"this",
"work",
"offers",
"several",
"positive",
"societal",
"over",
"previous",
"work",
"the",
"fact",
"that",
"it",
"is",
"more",
"strongly",
"grounded",
"in",
"real",
"factual",
"knowledge",
"in",
"this",
"case",
"wikipedia",
"makes",
"it",
"hallucinate",
"less",
"with",
"generations",
"that",
"are",
"more",
"factual",
"and",
"offers",
"more",
"control",
"and",
"interpretability",
"rag",
"could",
"be",
"employed",
"in",
"a",
"wide",
"variety",
"of",
"scenarios",
"with",
"direct",
"to",
"society",
"for",
"example",
"by",
"endowing",
"it",
"with",
"a",
"medical",
"index",
"and",
"asking",
"it",
"open",
"domain",
"questions",
"on",
"that",
"topic",
"or",
"by",
"helping",
"people",
"be",
"more",
"effective",
"at",
"their",
"jobs",
"with",
"these",
"advantages",
"also",
"come",
"potential",
"downsides",
"wikipedia",
"or",
"any",
"potential",
"external",
"knowledge",
"source",
"will",
"probably",
"never",
"be",
"entirely",
"factual",
"and",
"completely",
"devoid",
"of",
"bias",
"since",
"rag",
"can",
"be",
"employed",
"as",
"a",
"language",
"model",
"similar",
"concerns",
"as",
"for",
"gpt",
"2",
"50",
"are",
"valid",
"here",
"although",
"arguably",
"to",
"a",
"lesser",
"extent",
"including",
"that",
"it",
"might",
"be",
"used",
"to",
"generate",
"abuse",
"faked",
"or",
"misleading",
"content",
"in",
"the",
"news",
"or",
"on",
"social",
"media",
"to",
"impersonate",
"others",
"or",
"to",
"automate",
"the",
"production",
"of",
"spam",
"phishing",
"content",
"54",
"advanced",
"language",
"models",
"may",
"also",
"lead",
"to",
"the",
"automation",
"of",
"various",
"jobs",
"in",
"the",
"coming",
"decades",
"16",
"in",
"order",
"to",
"mitigate",
"these",
"risks",
"ai",
"systems",
"could",
"be",
"employed",
"to",
"against",
"misleading",
"content",
"and",
"automated",
"spam",
"phishing",
"acknowledgments",
"the",
"authors",
"would",
"like",
"to",
"thank",
"the",
"reviewers",
"for",
"their",
"thoughtful",
"and",
"constructive",
"feedback",
"on",
"this",
"paper",
"as",
"well",
"as",
"huggingface",
"for",
"their",
"help",
"in",
"open",
"sourcing",
"code",
"to",
"run",
"rag",
"models",
"the",
"authors",
"would",
"also",
"like",
"to",
"thank",
"kyunghyun",
"cho",
"and",
"sewon",
"min",
"for",
"productive",
"discussions",
"and",
"advice",
"ep",
"thanks",
"supports",
"from",
"the",
"nsf",
"graduate",
"research",
"fellowship",
"pl",
"is",
"supported",
"by",
"the",
"fair",
"phd",
"program",
"references",
"1",
"payal",
"bajaj",
"daniel",
"campos",
"nick",
"craswell",
"li",
"deng",
"jianfeng",
"gao",
"xiaodong",
"liu",
"rangan",
"majumder",
"andrew",
"mcnamara",
"bhaskar",
"mitra",
"tri",
"nguyen",
"mir",
"rosenberg",
"xia",
"song",
"alina",
"stoica",
"saurabh",
"tiwary",
"and",
"tong",
"wang",
"ms",
"marco",
"a",
"human",
"generated",
"machine",
"reading",
"comprehension",
"dataset",
"arxiv",
"1611",
"09268",
"cs",
"november",
"2016",
"url",
"http",
"arxiv",
"org",
"abs",
"1611",
"09268",
"arxiv",
"1611",
"09268"
],
[
"ms",
"marco",
"a",
"human",
"generated",
"machine",
"reading",
"comprehension",
"dataset",
"arxiv",
"1611",
"09268",
"cs",
"november",
"2016",
"url",
"http",
"arxiv",
"org",
"abs",
"1611",
"09268",
"arxiv",
"1611",
"09268",
"2",
"petr",
"and",
"jan",
"y",
"modeling",
"of",
"the",
"question",
"answering",
"task",
"in",
"the",
"yodaqa",
"system",
"in",
"international",
"conference",
"of",
"the",
"cross",
"language",
"evaluation",
"forum",
"for",
"european",
"languages",
"pages",
"222",
"228",
"springer",
"2015",
"url",
"https",
"link",
"springer",
"com",
"chapter",
"10",
"1007",
"2f978",
"3",
"319",
"24027",
"3",
"jonathan",
"berant",
"andrew",
"chou",
"roy",
"frostig",
"and",
"percy",
"liang",
"semantic",
"parsing",
"on",
"freebase",
"from",
"question",
"answer",
"pairs",
"in",
"proceedings",
"of",
"the",
"2013",
"conference",
"on",
"empirical",
"methods",
"in",
"natural",
"language",
"processing",
"pages",
"1533",
"1544",
"seattle",
"washington",
"usa",
"october",
"2013",
"association",
"for",
"computational",
"linguistics",
"url",
"http",
"www",
"aclweb",
"org",
"anthology",
"d13",
"1160",
"4",
"bin",
"bi",
"chenliang",
"li",
"chen",
"wu",
"ming",
"yan",
"and",
"wei",
"wang",
"palm",
"pre",
"training",
"an",
"autoencod",
"ing",
"autoregressive",
"language",
"model",
"for",
"context",
"conditioned",
"generation",
"arxiv",
"abs",
"2004",
"07159",
"2020",
"url",
"https",
"arxiv",
"org",
"abs",
"2004",
"07159",
"5",
"danqi",
"chen",
"adam",
"fisch",
"jason",
"weston",
"and",
"antoine",
"bordes",
"reading",
"wikipedia",
"to",
"answer",
"open",
"domain",
"questions",
"in",
"proceedings",
"of",
"the",
"55th",
"annual",
"meeting",
"of",
"the",
"association",
"for",
"computational",
"linguistics",
"volume",
"1",
"long",
"papers",
"pages",
"1870",
"1879",
"vancouver",
"canada",
"july",
"2017",
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"p17",
"1171",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"p17",
"1171",
"6",
"eunsol",
"choi",
"daniel",
"hewlett",
"jakob",
"uszkoreit",
"illia",
"polosukhin",
"alexandre",
"lacoste",
"and",
"jonathan",
"berant",
"coarse",
"to",
"question",
"answering",
"for",
"long",
"documents",
"in",
"proceedings",
"of",
"the",
"55th",
"annual",
"meeting",
"of",
"the",
"association",
"for",
"computational",
"linguistics",
"volume",
"1",
"long",
"papers",
"pages",
"209",
"220",
"vancouver",
"canada",
"july",
"2017",
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"p17",
"1020",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"p17",
"1020",
"10"
],
[
"7",
"christopher",
"clark",
"and",
"matt",
"gardner",
"simple",
"and",
"effective",
"multi",
"paragraph",
"reading",
"compre",
"hension",
"arxiv",
"1710",
"10723",
"cs",
"october",
"2017",
"url",
"http",
"arxiv",
"org",
"abs",
"1710",
"10723",
"arxiv",
"1710",
"10723",
"8",
"jacob",
"devlin",
"ming",
"wei",
"chang",
"kenton",
"lee",
"and",
"kristina",
"toutanova",
"bert",
"pre",
"training",
"of",
"deep",
"bidirectional",
"transformers",
"for",
"language",
"understanding",
"in",
"proceedings",
"of",
"the",
"2019",
"con",
"ference",
"of",
"the",
"north",
"american",
"chapter",
"of",
"the",
"association",
"for",
"computational",
"linguistics",
"human",
"language",
"technologies",
"volume",
"1",
"long",
"and",
"short",
"papers",
"pages",
"4171",
"4186",
"minneapolis",
"minnesota",
"june",
"2019",
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"n19",
"1423",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"n19",
"1423",
"9",
"emily",
"dinan",
"stephen",
"roller",
"kurt",
"shuster",
"angela",
"fan",
"michael",
"auli",
"and",
"jason",
"weston",
"wiz",
"ard",
"of",
"wikipedia",
"knowledge",
"powered",
"conversational",
"agents",
"in",
"international",
"conference",
"on",
"learning",
"representations",
"2019",
"url",
"https",
"openreview",
"net",
"forum",
"id",
"r1l73irqkm",
"10",
"matthew",
"dunn",
"levent",
"sagun",
"mike",
"higgins",
"v",
"ugur",
"guney",
"v",
"olkan",
"cirik",
"and",
"kyunghyun",
"cho",
"searchqa",
"a",
"new",
"q",
"a",
"dataset",
"augmented",
"with",
"context",
"from",
"a",
"search",
"engine",
"arxiv",
"1704",
"05179",
"cs",
"april",
"2017",
"url",
"http",
"arxiv",
"org",
"abs",
"1704",
"05179",
"arxiv",
"1704",
"05179",
"11",
"angela",
"fan",
"mike",
"lewis",
"and",
"yann",
"dauphin",
"hierarchical",
"neural",
"story",
"generation",
"in",
"proceed",
"ings",
"of",
"the",
"56th",
"annual",
"meeting",
"of",
"the",
"association",
"for",
"computational",
"linguistics",
"volume",
"1",
"long",
"papers",
"pages",
"889",
"898",
"melbourne",
"australia",
"july",
"2018",
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"p18",
"1082",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"p18",
"1082",
"12",
"angela",
"fan",
"yacine",
"jernite",
"ethan",
"perez",
"david",
"grangier",
"jason",
"weston",
"and",
"michael",
"auli",
"eli5",
"long",
"form",
"question",
"answering",
"in",
"proceedings",
"of",
"the",
"57th",
"annual",
"meeting",
"of",
"the",
"association",
"for",
"computational",
"linguistics",
"pages",
"3558",
"3567",
"florence",
"italy",
"july",
"2019",
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"p19",
"1346",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"p19",
"1346",
"13",
"angela",
"fan",
"claire",
"gardent",
"chloe",
"braud",
"and",
"antoine",
"bordes",
"augmenting",
"transformers",
"with",
"knn",
"based",
"composite",
"memory",
"2020"
],
[
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"p19",
"1346",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"p19",
"1346",
"13",
"angela",
"fan",
"claire",
"gardent",
"chloe",
"braud",
"and",
"antoine",
"bordes",
"augmenting",
"transformers",
"with",
"knn",
"based",
"composite",
"memory",
"2020",
"url",
"https",
"openreview",
"net",
"forum",
"id",
"h1gx1cnkph",
"14",
"thibault",
"livio",
"baldini",
"soares",
"nicholas",
"fitzgerald",
"eunsol",
"choi",
"and",
"tom",
"kwiatkowski",
"entities",
"as",
"experts",
"sparse",
"memory",
"access",
"with",
"entity",
"supervision",
"arxiv",
"abs",
"2004",
"07202",
"2020",
"url",
"https",
"arxiv",
"org",
"abs",
"2004",
"07202",
"15",
"marjan",
"ghazvininejad",
"chris",
"brockett",
"ming",
"wei",
"chang",
"bill",
"dolan",
"jianfeng",
"gao",
"wen",
"tau",
"yih",
"and",
"michel",
"galley",
"a",
"knowledge",
"grounded",
"neural",
"conversation",
"model",
"in",
"aaai",
"conference",
"on",
"intelligence",
"2018",
"url",
"https",
"www",
"aaai",
"org",
"ocs",
"index",
"php",
"aaai",
"aaai18",
"paper",
"view",
"16710",
"16",
"katja",
"grace",
"john",
"salvatier",
"allan",
"dafoe",
"baobao",
"zhang",
"and",
"owain",
"evans",
"when",
"will",
"ai",
"exceed",
"human",
"performance",
"evidence",
"from",
"ai",
"experts",
"corr",
"abs",
"1705",
"08807",
"2017",
"url",
"http",
"arxiv",
"org",
"abs",
"1705",
"08807",
"17",
"jiatao",
"gu",
"yong",
"wang",
"kyunghyun",
"cho",
"and",
"victor",
"o",
"k",
"li",
"search",
"engine",
"guided",
"neural",
"machine",
"translation",
"in",
"aaai",
"conference",
"on",
"intelligence",
"2018",
"url",
"https",
"www",
"aaai",
"org",
"ocs",
"index",
"php",
"aaai",
"aaai18",
"paper",
"view",
"17282",
"18",
"jiatao",
"gu",
"yong",
"wang",
"kyunghyun",
"cho",
"and",
"victor",
"o",
"k",
"li",
"search",
"engine",
"guided",
"neural",
"machine",
"translation",
"in",
"32nd",
"aaai",
"conference",
"on",
"intelligence",
"aaai",
"2018",
"32nd",
"aaai",
"conference",
"on",
"intelligence",
"aaai",
"2018",
"pages",
"5133",
"5140",
"aaai",
"press",
"2018",
"32nd",
"aaai",
"conference",
"on",
"intelligence",
"aaai",
"2018",
"conference",
"date",
"02",
"02",
"2018",
"through",
"07",
"02",
"2018",
"19",
"kelvin",
"guu",
"tatsunori",
"b",
"hashimoto",
"yonatan",
"oren",
"and",
"percy",
"liang",
"generating",
"sentences",
"by",
"editing",
"prototypes",
"transactions",
"of",
"the",
"association",
"for",
"computational",
"linguistics",
"6",
"437",
"450",
"2018",
"doi",
"10",
"1162",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"q18",
"1031",
"11"
],
[
"20",
"kelvin",
"guu",
"kenton",
"lee",
"zora",
"tung",
"panupong",
"pasupat",
"and",
"ming",
"wei",
"chang",
"realm",
"retrieval",
"augmented",
"language",
"model",
"pre",
"training",
"arxiv",
"abs",
"2002",
"08909",
"2020",
"url",
"https",
"arxiv",
"org",
"abs",
"2002",
"08909",
"21",
"tatsunori",
"b",
"hashimoto",
"kelvin",
"guu",
"yonatan",
"oren",
"and",
"percy",
"s",
"liang",
"a",
"retrieve",
"and",
"edit",
"framework",
"for",
"predicting",
"structured",
"outputs",
"in",
"s",
"bengio",
"h",
"wallach",
"h",
"larochelle",
"k",
"grauman",
"n",
"cesa",
"bianchi",
"and",
"r",
"garnett",
"ed",
"itors",
"advances",
"in",
"neural",
"information",
"processing",
"systems",
"31",
"pages",
"10052",
"10062",
"curran",
"associates",
"inc",
"2018",
"url",
"http",
"papers",
"nips",
"cc",
"paper",
"8209",
"a",
"retrieve",
"and",
"edit",
"framework",
"for",
"predicting",
"structured",
"outputs",
"pdf",
"22",
"nabil",
"hossain",
"marjan",
"ghazvininejad",
"and",
"luke",
"zettlemoyer",
"simple",
"and",
"effective",
"retrieve",
"edit",
"rerank",
"text",
"generation",
"in",
"proceedings",
"of",
"the",
"58th",
"annual",
"meeting",
"of",
"the",
"association",
"for",
"computational",
"linguistics",
"pages",
"2532",
"2538",
"online",
"july",
"2020",
"association",
"for",
"computa",
"tional",
"linguistics",
"doi",
"10",
"18653",
"v1",
"2020",
"acl",
"main",
"228",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"2020",
"acl",
"main",
"228",
"23",
"jeff",
"johnson",
"matthijs",
"douze",
"and",
"billion",
"scale",
"similarity",
"search",
"with",
"gpus",
"arxiv",
"preprint",
"arxiv",
"1702",
"08734",
"2017",
"url",
"https",
"arxiv",
"org",
"abs",
"1702",
"08734",
"24",
"mandar",
"joshi",
"eunsol",
"choi",
"daniel",
"weld",
"and",
"luke",
"zettlemoyer",
"triviaqa",
"a",
"large",
"scale",
"distantly",
"supervised",
"challenge",
"dataset",
"for",
"reading",
"comprehension",
"in",
"proceedings",
"of",
"the",
"55th",
"annual",
"meeting",
"of",
"the",
"association",
"for",
"computational",
"linguistics",
"volume",
"1",
"long",
"papers",
"pages",
"1601",
"1611",
"vancouver",
"canada",
"july",
"2017",
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"p17",
"1147",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"p17",
"1147",
"25",
"armand",
"joulin",
"and",
"tomas",
"mikolov",
"inferring",
"algorithmic",
"patterns",
"with",
"stack",
"augmented",
"recurrent",
"nets",
"in",
"proceedings",
"of",
"the",
"28th",
"international",
"conference",
"on",
"neural",
"information",
"processing",
"systems",
"volume",
"1",
"nips",
"15",
"page",
"190",
"198",
"cam",
"bridge",
"ma",
"usa",
"2015",
"mit",
"press",
"url",
"https",
"papers",
"nips",
"cc",
"paper",
"5857",
"inferring",
"algorithmic",
"patterns",
"with",
"stack",
"augmented",
"recurrent",
"nets",
"26",
"vladimir",
"karpukhin",
"barlas",
"oguz",
"sewon",
"min",
"ledell",
"wu",
"sergey",
"edunov",
"danqi",
"chen",
"and",
"wen",
"tau",
"yih"
],
[
"mit",
"press",
"url",
"https",
"papers",
"nips",
"cc",
"paper",
"5857",
"inferring",
"algorithmic",
"patterns",
"with",
"stack",
"augmented",
"recurrent",
"nets",
"26",
"vladimir",
"karpukhin",
"barlas",
"oguz",
"sewon",
"min",
"ledell",
"wu",
"sergey",
"edunov",
"danqi",
"chen",
"and",
"wen",
"tau",
"yih",
"dense",
"passage",
"retrieval",
"for",
"open",
"domain",
"question",
"answering",
"arxiv",
"preprint",
"arxiv",
"2004",
"04906",
"2020",
"url",
"https",
"arxiv",
"org",
"abs",
"2004",
"04906",
"27",
"urvashi",
"khandelwal",
"omer",
"levy",
"dan",
"jurafsky",
"luke",
"zettlemoyer",
"and",
"mike",
"lewis",
"generaliza",
"tion",
"through",
"memorization",
"nearest",
"neighbor",
"language",
"models",
"in",
"international",
"conference",
"on",
"learning",
"representations",
"2020",
"url",
"https",
"openreview",
"net",
"forum",
"id",
"hklbjcekvh",
"28",
"diederik",
"p",
"kingma",
"and",
"jimmy",
"ba",
"adam",
"a",
"method",
"for",
"stochastic",
"optimization",
"in",
"yoshua",
"bengio",
"and",
"yann",
"lecun",
"editors",
"3rd",
"international",
"conference",
"on",
"learning",
"representations",
"iclr",
"2015",
"san",
"diego",
"ca",
"usa",
"may",
"7",
"9",
"2015",
"conference",
"track",
"proceedings",
"2015",
"url",
"http",
"arxiv",
"org",
"abs",
"1412",
"6980",
"29",
"tom",
"kwiatkowski",
"jennimaria",
"palomaki",
"olivia",
"michael",
"collins",
"ankur",
"parikh",
"chris",
"alberti",
"danielle",
"epstein",
"illia",
"polosukhin",
"matthew",
"kelcey",
"jacob",
"devlin",
"ken",
"ton",
"lee",
"kristina",
"n",
"toutanova",
"llion",
"jones",
"ming",
"wei",
"chang",
"andrew",
"dai",
"jakob",
"uszkoreit",
"quoc",
"le",
"and",
"slav",
"petrov",
"natural",
"questions",
"a",
"benchmark",
"for",
"ques",
"tion",
"answering",
"research",
"transactions",
"of",
"the",
"association",
"of",
"computational",
"lin",
"guistics",
"2019",
"url",
"https",
"tomkwiat",
"users",
"x20web",
"corp",
"google",
"com",
"papers",
"natural",
"questions",
"main",
"1455",
"kwiatkowski",
"pdf",
"30",
"guillaume",
"lample",
"alexandre",
"sablayrolles",
"marc",
"aurelio",
"ranzato",
"ludovic",
"denoyer",
"and",
"herve",
"jegou",
"large",
"memory",
"layers",
"with",
"product",
"keys",
"in",
"h",
"wallach",
"h",
"larochelle",
"a",
"beygelzimer",
"f",
"d",
"buc",
"e",
"fox",
"and",
"r",
"garnett",
"editors",
"advances",
"in",
"neural",
"in",
"formation",
"processing",
"systems",
"32",
"pages",
"8548",
"8559",
"curran",
"associates",
"inc",
"2019",
"url",
"http",
"papers",
"nips",
"cc",
"paper",
"9061",
"large",
"memory",
"layers",
"with",
"product",
"keys",
"pdf",
"31",
"kenton",
"lee",
"ming",
"wei",
"chang",
"and",
"kristina",
"toutanova",
"latent",
"retrieval",
"for",
"weakly",
"supervised",
"open",
"domain",
"question",
"answering",
"in",
"proceedings",
"of",
"the",
"57th",
"annual",
"meeting",
"of",
"the",
"association",
"12"
],
[
"for",
"computational",
"linguistics",
"pages",
"6086",
"6096",
"florence",
"italy",
"july",
"2019",
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"p19",
"1612",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"p19",
"1612",
"32",
"mike",
"lewis",
"yinhan",
"liu",
"naman",
"goyal",
"marjan",
"ghazvininejad",
"abdelrahman",
"mohamed",
"omer",
"levy",
"veselin",
"stoyanov",
"and",
"luke",
"zettlemoyer",
"bart",
"denoising",
"sequence",
"to",
"sequence",
"pre",
"training",
"for",
"natural",
"language",
"generation",
"translation",
"and",
"comprehension",
"arxiv",
"preprint",
"arxiv",
"1910",
"13461",
"2019",
"url",
"https",
"arxiv",
"org",
"abs",
"1910",
"13461",
"33",
"jiwei",
"li",
"michel",
"galley",
"chris",
"brockett",
"jianfeng",
"gao",
"and",
"bill",
"dolan",
"a",
"diversity",
"promoting",
"objective",
"function",
"for",
"neural",
"conversation",
"models",
"in",
"proceedings",
"of",
"the",
"2016",
"conference",
"of",
"the",
"north",
"american",
"chapter",
"of",
"the",
"association",
"for",
"computational",
"linguistics",
"human",
"language",
"technologies",
"pages",
"110",
"119",
"san",
"diego",
"california",
"june",
"2016",
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"n16",
"1014",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"n16",
"1014",
"34",
"margaret",
"li",
"jason",
"weston",
"and",
"stephen",
"roller",
"acute",
"eval",
"improved",
"dialogue",
"evaluation",
"with",
"optimized",
"questions",
"and",
"multi",
"turn",
"comparisons",
"arxiv",
"abs",
"1909",
"03087",
"2019",
"url",
"https",
"arxiv",
"org",
"abs",
"1909",
"03087",
"35",
"hairong",
"liu",
"mingbo",
"ma",
"liang",
"huang",
"hao",
"xiong",
"and",
"zhongjun",
"he",
"robust",
"neural",
"machine",
"translation",
"with",
"joint",
"textual",
"and",
"phonetic",
"embedding",
"in",
"proceedings",
"of",
"the",
"57th",
"annual",
"meeting",
"of",
"the",
"association",
"for",
"computational",
"linguistics",
"pages",
"3044",
"3049",
"florence",
"italy",
"july",
"2019",
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"p19",
"1291",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"p19",
"1291",
"36",
"peter",
"j",
"liu",
"mohammad",
"saleh",
"etienne",
"pot",
"ben",
"goodrich",
"ryan",
"sepassi",
"lukasz",
"kaiser",
"and",
"noam",
"shazeer",
"generating",
"wikipedia",
"by",
"summarizing",
"long",
"sequences",
"in",
"international",
"conference",
"on",
"learning",
"representations",
"2018",
"url",
"https",
"openreview",
"net",
"forum",
"id",
"hyg0vbwc",
"37",
"yury",
"a",
"malkov",
"and",
"d",
"a",
"yashunin",
"and",
"robust",
"approximate",
"nearest",
"neighbor",
"search",
"using",
"hierarchical",
"navigable",
"small",
"world",
"graphs",
"ieee",
"transactions",
"on",
"pattern",
"analysis",
"and",
"machine",
"intelligence",
"42",
"824",
"836",
"2016"
],
[
"id",
"hyg0vbwc",
"37",
"yury",
"a",
"malkov",
"and",
"d",
"a",
"yashunin",
"and",
"robust",
"approximate",
"nearest",
"neighbor",
"search",
"using",
"hierarchical",
"navigable",
"small",
"world",
"graphs",
"ieee",
"transactions",
"on",
"pattern",
"analysis",
"and",
"machine",
"intelligence",
"42",
"824",
"836",
"2016",
"url",
"https",
"arxiv",
"org",
"abs",
"1603",
"09320",
"38",
"gary",
"marcus",
"the",
"next",
"decade",
"in",
"ai",
"four",
"steps",
"towards",
"robust",
"intelligence",
"arxiv",
"preprint",
"arxiv",
"2002",
"06177",
"2020",
"url",
"https",
"arxiv",
"org",
"abs",
"2002",
"06177",
"39",
"luca",
"massarelli",
"fabio",
"petroni",
"aleksandra",
"piktus",
"myle",
"ott",
"tim",
"vassilis",
"plachouras",
"fabrizio",
"silvestri",
"and",
"sebastian",
"riedel",
"how",
"decoding",
"strategies",
"affect",
"the",
"of",
"generated",
"text",
"arxiv",
"preprint",
"arxiv",
"1911",
"03587",
"2019",
"url",
"https",
"arxiv",
"org",
"abs",
"1911",
"03587",
"40",
"paulius",
"micikevicius",
"sharan",
"narang",
"jonah",
"alben",
"gregory",
"diamos",
"erich",
"elsen",
"david",
"garcia",
"boris",
"ginsburg",
"michael",
"houston",
"oleksii",
"kuchaiev",
"ganesh",
"venkatesh",
"and",
"hao",
"wu",
"mixed",
"precision",
"training",
"in",
"iclr",
"2018",
"url",
"https",
"openreview",
"net",
"forum",
"id",
"r1gs9jgrz",
"41",
"nikita",
"moghe",
"siddhartha",
"arora",
"suman",
"banerjee",
"and",
"mitesh",
"m",
"khapra",
"towards",
"exploit",
"ing",
"background",
"knowledge",
"for",
"building",
"conversation",
"systems",
"in",
"proceedings",
"of",
"the",
"2018",
"conference",
"on",
"empirical",
"methods",
"in",
"natural",
"language",
"processing",
"pages",
"2322",
"2332",
"brus",
"sels",
"belgium",
"october",
"november",
"2018",
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"d18",
"1255",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"d18",
"1255",
"42",
"preksha",
"nema",
"and",
"mitesh",
"m",
"khapra",
"towards",
"a",
"better",
"metric",
"for",
"evaluating",
"question",
"generation",
"systems",
"in",
"proceedings",
"of",
"the",
"2018",
"conference",
"on",
"empirical",
"methods",
"in",
"natural",
"language",
"processing",
"pages",
"3950",
"3959",
"brussels",
"belgium",
"october",
"november",
"2018",
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"d18",
"1429",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"d18",
"1429",
"43",
"tri",
"nguyen",
"mir",
"rosenberg",
"xia",
"song",
"jianfeng",
"gao",
"saurabh",
"tiwary",
"rangan",
"majumder",
"and",
"li",
"deng",
"ms",
"marco",
"a",
"human",
"generated",
"machine",
"reading",
"comprehension",
"dataset",
"in",
"tarek",
"richard",
"besold",
"antoine",
"bordes",
"artur",
"s"
],
[
"43",
"tri",
"nguyen",
"mir",
"rosenberg",
"xia",
"song",
"jianfeng",
"gao",
"saurabh",
"tiwary",
"rangan",
"majumder",
"and",
"li",
"deng",
"ms",
"marco",
"a",
"human",
"generated",
"machine",
"reading",
"comprehension",
"dataset",
"in",
"tarek",
"richard",
"besold",
"antoine",
"bordes",
"artur",
"s",
"d",
"avila",
"garcez",
"and",
"greg",
"wayne",
"editors",
"proceedings",
"of",
"the",
"workshop",
"on",
"cognitive",
"computation",
"integrating",
"neural",
"and",
"symbolic",
"13"
],
[
"approaches",
"2016",
"co",
"located",
"with",
"the",
"30th",
"annual",
"conference",
"on",
"neural",
"information",
"processing",
"systems",
"nips",
"2016",
"barcelona",
"spain",
"december",
"9",
"2016",
"volume",
"1773",
"of",
"ceur",
"workshop",
"proceedings",
"ceur",
"ws",
"org",
"2016",
"url",
"http",
"ceur",
"ws",
"org",
"vol",
"1773",
"pdf",
"44",
"rodrigo",
"nogueira",
"and",
"kyunghyun",
"cho",
"passage",
"re",
"ranking",
"with",
"bert",
"arxiv",
"preprint",
"arxiv",
"1901",
"04085",
"2019",
"url",
"https",
"arxiv",
"org",
"abs",
"1901",
"04085",
"45",
"myle",
"ott",
"sergey",
"edunov",
"alexei",
"baevski",
"angela",
"fan",
"sam",
"gross",
"nathan",
"ng",
"david",
"grangier",
"and",
"michael",
"auli",
"fairseq",
"a",
"fast",
"extensible",
"toolkit",
"for",
"sequence",
"modeling",
"in",
"proceedings",
"of",
"the",
"2019",
"conference",
"of",
"the",
"north",
"american",
"chapter",
"of",
"the",
"association",
"for",
"computational",
"linguistics",
"demonstrations",
"pages",
"48",
"53",
"minneapolis",
"minnesota",
"june",
"2019",
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"n19",
"4009",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"n19",
"4009",
"46",
"ethan",
"perez",
"siddharth",
"karamcheti",
"rob",
"fergus",
"jason",
"weston",
"douwe",
"kiela",
"and",
"kyunghyun",
"cho",
"finding",
"generalizable",
"evidence",
"by",
"learning",
"to",
"convince",
"q",
"a",
"models",
"in",
"proceedings",
"of",
"the",
"2019",
"conference",
"on",
"empirical",
"methods",
"in",
"natural",
"language",
"processing",
"and",
"the",
"9th",
"international",
"joint",
"conference",
"on",
"natural",
"language",
"processing",
"emnlp",
"ijcnlp",
"pages",
"2402",
"2411",
"hong",
"kong",
"china",
"november",
"2019",
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"d19",
"1244",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"d19",
"1244",
"47",
"fabio",
"petroni",
"tim",
"sebastian",
"riedel",
"patrick",
"lewis",
"anton",
"bakhtin",
"yuxiang",
"wu",
"and",
"alexander",
"miller",
"language",
"models",
"as",
"knowledge",
"bases",
"in",
"proceedings",
"of",
"the",
"2019",
"conference",
"on",
"empirical",
"methods",
"in",
"natural",
"language",
"processing",
"and",
"the",
"9th",
"international",
"joint",
"conference",
"on",
"natural",
"language",
"processing",
"emnlp",
"ijcnlp",
"pages",
"2463",
"2473",
"hong",
"kong",
"china",
"november",
"2019",
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"d19",
"1250",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"d19",
"1250",
"48",
"fabio",
"petroni",
"patrick",
"lewis",
"aleksandra",
"piktus",
"tim",
"yuxiang",
"wu",
"alexander",
"h",
"miller",
"and",
"sebastian",
"riedel",
"how",
"context",
"affects",
"language",
"models",
"factual",
"predictions"
],
[
"doi",
"10",
"18653",
"v1",
"d19",
"1250",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"d19",
"1250",
"48",
"fabio",
"petroni",
"patrick",
"lewis",
"aleksandra",
"piktus",
"tim",
"yuxiang",
"wu",
"alexander",
"h",
"miller",
"and",
"sebastian",
"riedel",
"how",
"context",
"affects",
"language",
"models",
"factual",
"predictions",
"in",
"automated",
"knowledge",
"base",
"construction",
"2020",
"url",
"https",
"openreview",
"net",
"forum",
"id",
"025x0zpfn",
"49",
"alec",
"radford",
"karthik",
"narasimhan",
"tim",
"salimans",
"and",
"ilya",
"sutskever",
"im",
"proving",
"language",
"understanding",
"by",
"generative",
"pre",
"training",
"2018",
"url",
"https",
"s3",
"us",
"west",
"2",
"amazonaws",
"com",
"openai",
"assets",
"research",
"covers",
"language",
"unsupervised",
"pdf",
"50",
"alec",
"radford",
"jeff",
"wu",
"rewon",
"child",
"david",
"luan",
"dario",
"amodei",
"and",
"ilya",
"sutskever",
"language",
"models",
"are",
"unsupervised",
"multitask",
"learners",
"2019",
"url",
"https",
"d4mucfpksywv",
"cloudfront",
"net",
"better",
"language",
"models",
"pdf",
"51",
"colin",
"raffel",
"noam",
"shazeer",
"adam",
"roberts",
"katherine",
"lee",
"sharan",
"narang",
"michael",
"matena",
"yanqi",
"zhou",
"wei",
"li",
"and",
"peter",
"j",
"liu",
"exploring",
"the",
"limits",
"of",
"transfer",
"learning",
"with",
"a",
"text",
"to",
"text",
"transformer",
"arxiv",
"e",
"prints",
"2019",
"url",
"https",
"arxiv",
"org",
"abs",
"1910",
"10683",
"52",
"adam",
"roberts",
"colin",
"raffel",
"and",
"noam",
"shazeer",
"how",
"much",
"knowledge",
"can",
"you",
"pack",
"into",
"the",
"parameters",
"of",
"a",
"language",
"model",
"arxiv",
"e",
"prints",
"2020",
"url",
"https",
"arxiv",
"org",
"abs",
"2002",
"08910",
"53",
"stephen",
"robertson",
"and",
"hugo",
"zaragoza",
"the",
"probabilistic",
"relevance",
"framework",
"bm25",
"and",
"beyond",
"found",
"trends",
"inf",
"retr",
"3",
"4",
"333",
"389",
"april",
"2009",
"issn",
"1554",
"0669",
"doi",
"10",
"1561",
"1500000019",
"url",
"https",
"doi",
"org",
"10",
"1561",
"1500000019",
"54",
"irene",
"solaiman",
"miles",
"brundage",
"jack",
"clark",
"amanda",
"askell",
"ariel",
"herbert",
"v",
"oss",
"jeff",
"wu",
"alec",
"radford",
"and",
"jian",
"bing",
"wang",
"release",
"strategies",
"and",
"the",
"social",
"impacts",
"of",
"language",
"models",
"arxiv",
"abs",
"1908",
"09203",
"2019",
"55",
"sainbayar",
"sukhbaatar",
"arthur",
"szlam",
"jason",
"weston",
"and",
"rob",
"fergus",
"end",
"to",
"end",
"memory",
"net",
"works",
"in",
"c",
"cortes",
"n",
"d",
"lawrence",
"d",
"d",
"lee",
"m",
"sugiyama",
"and",
"r",
"garnett",
"editors",
"advances",
"in",
"neural",
"information",
"processing",
"systems",
"28",
"pages",
"2440",
"2448",
"curran",
"associates",
"inc",
"2015"
],
[
"end",
"to",
"end",
"memory",
"net",
"works",
"in",
"c",
"cortes",
"n",
"d",
"lawrence",
"d",
"d",
"lee",
"m",
"sugiyama",
"and",
"r",
"garnett",
"editors",
"advances",
"in",
"neural",
"information",
"processing",
"systems",
"28",
"pages",
"2440",
"2448",
"curran",
"associates",
"inc",
"2015",
"url",
"http",
"papers",
"nips",
"cc",
"paper",
"5846",
"end",
"to",
"end",
"memory",
"networks",
"pdf",
"14"
],
[
"56",
"james",
"thorne",
"andreas",
"vlachos",
"christos",
"christodoulopoulos",
"and",
"arpit",
"mittal",
"fever",
"a",
"large",
"scale",
"dataset",
"for",
"fact",
"extraction",
"and",
"in",
"proceedings",
"of",
"the",
"2018",
"conference",
"of",
"the",
"north",
"american",
"chapter",
"of",
"the",
"association",
"for",
"computational",
"linguistics",
"human",
"language",
"technologies",
"volume",
"1",
"long",
"papers",
"pages",
"809",
"819",
"new",
"orleans",
"louisiana",
"june",
"2018",
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"n18",
"1074",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"n18",
"1074",
"57",
"james",
"h",
"thorne",
"and",
"andreas",
"vlachos",
"avoiding",
"catastrophic",
"forgetting",
"in",
"mitigating",
"model",
"biases",
"in",
"sentence",
"pair",
"with",
"elastic",
"weight",
"consolidation",
"arxiv",
"abs",
"2004",
"14366",
"2020",
"url",
"https",
"arxiv",
"org",
"abs",
"2004",
"14366",
"58",
"ashish",
"vaswani",
"noam",
"shazeer",
"niki",
"parmar",
"jakob",
"uszkoreit",
"llion",
"jones",
"aidan",
"n",
"gomez",
"ukasz",
"kaiser",
"and",
"illia",
"polosukhin",
"attention",
"is",
"all",
"you",
"need",
"in",
"i",
"guyon",
"u",
"v",
"luxburg",
"s",
"bengio",
"h",
"wallach",
"r",
"fergus",
"s",
"vishwanathan",
"and",
"r",
"garnett",
"editors",
"advances",
"in",
"neural",
"information",
"processing",
"systems",
"30",
"pages",
"5998",
"6008",
"curran",
"associates",
"inc",
"2017",
"url",
"http",
"papers",
"nips",
"cc",
"paper",
"7181",
"attention",
"is",
"all",
"you",
"need",
"pdf",
"59",
"ashwin",
"vijayakumar",
"michael",
"cogswell",
"ramprasaath",
"selvaraju",
"qing",
"sun",
"stefan",
"lee",
"david",
"crandall",
"and",
"dhruv",
"batra",
"diverse",
"beam",
"search",
"for",
"improved",
"description",
"of",
"complex",
"scenes",
"aaai",
"conference",
"on",
"intelligence",
"2018",
"url",
"https",
"www",
"aaai",
"org",
"ocs",
"index",
"php",
"aaai",
"aaai18",
"paper",
"view",
"17329",
"60",
"alex",
"wang",
"amanpreet",
"singh",
"julian",
"michael",
"felix",
"hill",
"omer",
"levy",
"and",
"samuel",
"bowman",
"glue",
"a",
"multi",
"task",
"benchmark",
"and",
"analysis",
"platform",
"for",
"natural",
"language",
"understanding",
"inproceedings",
"of",
"the",
"2018",
"emnlp",
"workshop",
"blackboxnlp",
"analyzing",
"and",
"interpreting",
"neural",
"networks",
"for",
"nlp",
"pages",
"353",
"355",
"brussels",
"belgium",
"november",
"2018",
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"w18",
"5446",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"w18",
"5446",
"61",
"alex",
"wang",
"yada",
"pruksachatkun",
"nikita",
"nangia",
"amanpreet",
"singh",
"julian",
"michael",
"felix",
"hill",
"omer",
"levy",
"and",
"samuel",
"bowman",
"superglue",
"a",
"stickier",
"benchmark",
"for",
"general",
"purpose",
"language",
"understanding",
"systems",
"in",
"h",
"wallach",
"h"
],
[
"61",
"alex",
"wang",
"yada",
"pruksachatkun",
"nikita",
"nangia",
"amanpreet",
"singh",
"julian",
"michael",
"felix",
"hill",
"omer",
"levy",
"and",
"samuel",
"bowman",
"superglue",
"a",
"stickier",
"benchmark",
"for",
"general",
"purpose",
"language",
"understanding",
"systems",
"in",
"h",
"wallach",
"h",
"larochelle",
"a",
"beygelzimer",
"f",
"d",
"textquotesingle",
"buc",
"e",
"fox",
"and",
"r",
"garnett",
"editors",
"advances",
"in",
"neural",
"information",
"processing",
"systems",
"32",
"pages",
"3261",
"3275",
"curran",
"associates",
"inc",
"2019",
"url",
"https",
"arxiv",
"org",
"abs",
"1905",
"00537",
"62",
"shuohang",
"wang",
"mo",
"yu",
"xiaoxiao",
"guo",
"zhiguo",
"wang",
"tim",
"klinger",
"wei",
"zhang",
"shiyu",
"chang",
"gerry",
"tesauro",
"bowen",
"zhou",
"and",
"jing",
"jiang",
"r3",
"reinforced",
"ranker",
"reader",
"for",
"open",
"domain",
"question",
"answering",
"in",
"sheila",
"a",
"mcilraith",
"and",
"kilian",
"q",
"weinberger",
"editors",
"proceedings",
"of",
"the",
"thirty",
"second",
"aaai",
"conference",
"on",
"intelligence",
"aaai",
"18",
"the",
"30th",
"innovative",
"applications",
"of",
"intelligence",
"iaai",
"18",
"and",
"the",
"8th",
"aaai",
"symposium",
"on",
"educational",
"advances",
"in",
"intelligence",
"eaai",
"18",
"new",
"orleans",
"louisiana",
"usa",
"february",
"2",
"7",
"2018",
"pages",
"5981",
"5988",
"aaai",
"press",
"2018",
"url",
"https",
"www",
"aaai",
"org",
"ocs",
"index",
"php",
"aaai",
"aaai18",
"paper",
"view",
"16712",
"63",
"shuohang",
"wang",
"mo",
"yu",
"jing",
"jiang",
"wei",
"zhang",
"xiaoxiao",
"guo",
"shiyu",
"chang",
"zhiguo",
"wang",
"tim",
"klinger",
"gerald",
"tesauro",
"and",
"murray",
"campbell",
"evidence",
"aggregation",
"for",
"answer",
"re",
"ranking",
"in",
"open",
"domain",
"question",
"answering",
"in",
"iclr",
"2018",
"url",
"https",
"openreview",
"net",
"forum",
"id",
"rjl3ym",
"ab",
"64",
"jason",
"weston",
"sumit",
"chopra",
"and",
"antoine",
"bordes",
"memory",
"networks",
"in",
"yoshua",
"bengio",
"and",
"yann",
"lecun",
"editors",
"3rd",
"international",
"conference",
"on",
"learning",
"representations",
"iclr",
"2015",
"san",
"diego",
"ca",
"usa",
"may",
"7",
"9",
"2015",
"conference",
"track",
"proceedings",
"2015",
"url",
"http",
"arxiv",
"org",
"abs",
"1410",
"3916",
"65",
"jason",
"weston",
"emily",
"dinan",
"and",
"alexander",
"miller",
"retrieve",
"and",
"improved",
"sequence",
"generation",
"models",
"for",
"dialogue",
"in",
"proceedings",
"of",
"the",
"2018",
"emnlp",
"workshop",
"scai",
"the",
"2nd",
"international",
"workshop",
"on",
"search",
"oriented",
"conversational",
"ai",
"pages",
"87",
"92",
"brussels",
"belgium",
"october",
"2018",
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"w18",
"5713",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"w18",
"5713",
"15"
],
[
"66",
"thomas",
"wolf",
"lysandre",
"debut",
"victor",
"sanh",
"julien",
"chaumond",
"clement",
"delangue",
"anthony",
"moi",
"pierric",
"cistac",
"tim",
"rault",
"louf",
"morgan",
"funtowicz",
"joe",
"davison",
"sam",
"shleifer",
"patrick",
"von",
"platen",
"clara",
"ma",
"yacine",
"jernite",
"julien",
"plu",
"canwen",
"xu",
"teven",
"le",
"scao",
"sylvain",
"gugger",
"mariama",
"drame",
"quentin",
"lhoest",
"and",
"alexander",
"m",
"rush",
"huggingface",
"s",
"transformers",
"state",
"of",
"the",
"art",
"natural",
"language",
"processing",
"arxiv",
"abs",
"1910",
"03771",
"2019",
"67",
"shiyue",
"zhang",
"and",
"mohit",
"bansal",
"addressing",
"semantic",
"drift",
"in",
"question",
"generation",
"for",
"semi",
"supervised",
"question",
"answering",
"in",
"proceedings",
"of",
"the",
"2019",
"conference",
"on",
"empirical",
"meth",
"ods",
"in",
"natural",
"language",
"processing",
"and",
"the",
"9th",
"international",
"joint",
"conference",
"on",
"natural",
"language",
"processing",
"emnlp",
"ijcnlp",
"pages",
"2495",
"2509",
"hong",
"kong",
"china",
"novem",
"ber",
"2019",
"association",
"for",
"computational",
"linguistics",
"doi",
"10",
"18653",
"v1",
"d19",
"1253",
"url",
"https",
"www",
"aclweb",
"org",
"anthology",
"d19",
"1253",
"68",
"wanjun",
"zhong",
"jingjing",
"xu",
"duyu",
"tang",
"zenan",
"xu",
"nan",
"duan",
"ming",
"zhou",
"jiahai",
"wang",
"and",
"jian",
"yin",
"reasoning",
"over",
"semantic",
"level",
"graph",
"for",
"fact",
"checking",
"arxiv",
"abs",
"1909",
"03745",
"2019",
"url",
"https",
"arxiv",
"org",
"abs",
"1909",
"03745",
"16"
],
[
"appendices",
"for",
"retrieval",
"augmented",
"generation",
"for",
"knowledge",
"intensive",
"nlp",
"tasks",
"a",
"implementation",
"details",
"for",
"open",
"domain",
"qa",
"we",
"report",
"test",
"numbers",
"using",
"15",
"retrieved",
"documents",
"for",
"rag",
"token",
"models",
"for",
"rag",
"sequence",
"models",
"we",
"report",
"test",
"results",
"using",
"50",
"retrieved",
"documents",
"and",
"we",
"use",
"the",
"thorough",
"decoding",
"approach",
"since",
"answers",
"are",
"generally",
"short",
"we",
"use",
"greedy",
"decoding",
"for",
"qa",
"as",
"we",
"did",
"not",
"beam",
"search",
"improved",
"results",
"for",
"open",
"msmarco",
"and",
"jeopardy",
"question",
"generation",
"we",
"report",
"test",
"numbers",
"using",
"ten",
"retrieved",
"documents",
"for",
"both",
"rag",
"token",
"and",
"rag",
"sequence",
"and",
"we",
"also",
"train",
"a",
"bart",
"large",
"model",
"as",
"a",
"baseline",
"we",
"use",
"a",
"beam",
"size",
"of",
"four",
"and",
"use",
"the",
"fast",
"decoding",
"approach",
"for",
"rag",
"sequence",
"models",
"as",
"thorough",
"decoding",
"did",
"not",
"improve",
"performance",
"b",
"human",
"evaluation",
"figure",
"4",
"annotation",
"interface",
"for",
"human",
"evaluation",
"of",
"factuality",
"a",
"pop",
"out",
"for",
"detailed",
"instructions",
"and",
"a",
"worked",
"example",
"appear",
"when",
"clicking",
"view",
"tool",
"guide",
"figure",
"4",
"shows",
"the",
"user",
"interface",
"for",
"human",
"evaluation",
"to",
"avoid",
"any",
"biases",
"for",
"screen",
"position",
"which",
"model",
"corresponded",
"to",
"sentence",
"a",
"and",
"sentence",
"b",
"was",
"randomly",
"selected",
"for",
"each",
"example",
"annotators",
"were",
"encouraged",
"to",
"research",
"the",
"topic",
"using",
"the",
"internet",
"and",
"were",
"given",
"detailed",
"instruc",
"tions",
"and",
"worked",
"examples",
"in",
"a",
"full",
"instructions",
"tab",
"we",
"included",
"some",
"gold",
"sentences",
"in",
"order",
"to",
"assess",
"the",
"accuracy",
"of",
"the",
"annotators",
"two",
"annotators",
"did",
"not",
"perform",
"well",
"on",
"these",
"examples",
"and",
"their",
"annotations",
"were",
"removed",
"from",
"the",
"results",
"c",
"training",
"setup",
"details",
"we",
"train",
"all",
"rag",
"models",
"and",
"bart",
"baselines",
"using",
"fairseq",
"45",
"2we",
"train",
"with",
"mixed",
"precision",
"point",
"arithmetic",
"40",
"distributing",
"training",
"across",
"8",
"32gb",
"nvidia",
"v100",
"gpus",
"though",
"training",
"and",
"inference",
"can",
"be",
"run",
"on",
"one",
"gpu",
"we",
"that",
"doing",
"maximum",
"inner",
"product",
"search",
"with",
"faiss",
"is",
"fast",
"on",
"cpu",
"so",
"we",
"store",
"document",
"index",
"vectors",
"on",
"cpu",
"requiring",
"100",
"gb",
"of",
"cpu",
"memory",
"for",
"all",
"of",
"wikipedia"
],
[
"we",
"that",
"doing",
"maximum",
"inner",
"product",
"search",
"with",
"faiss",
"is",
"fast",
"on",
"cpu",
"so",
"we",
"store",
"document",
"index",
"vectors",
"on",
"cpu",
"requiring",
"100",
"gb",
"of",
"cpu",
"memory",
"for",
"all",
"of",
"wikipedia",
"after",
"submission",
"we",
"have",
"ported",
"our",
"code",
"to",
"huggingface",
"transformers",
"66",
"3",
"which",
"achieves",
"equivalent",
"performance",
"to",
"the",
"previous",
"version",
"but",
"is",
"a",
"cleaner",
"and",
"easier",
"to",
"use",
"implementation",
"this",
"version",
"is",
"also",
"open",
"sourced",
"we",
"also",
"compress",
"the",
"document",
"index",
"using",
"faiss",
"s",
"compression",
"tools",
"reducing",
"the",
"cpu",
"memory",
"requirement",
"to",
"36gb",
"scripts",
"to",
"run",
"experiments",
"with",
"rag",
"can",
"be",
"found",
"at",
"https",
"github",
"com",
"huggingface",
"transformers",
"blob",
"master",
"examples",
"rag",
"readme",
"md",
"and",
"an",
"interactive",
"demo",
"of",
"a",
"rag",
"model",
"can",
"be",
"found",
"athttps",
"huggingface",
"co",
"rag",
"2https",
"github",
"com",
"pytorch",
"fairseq",
"3https",
"github",
"com",
"huggingface",
"transformers",
"17"
],
[
"d",
"further",
"details",
"on",
"open",
"domain",
"qa",
"for",
"open",
"domain",
"qa",
"multiple",
"answer",
"annotations",
"are",
"often",
"available",
"for",
"a",
"given",
"question",
"these",
"answer",
"annotations",
"are",
"exploited",
"by",
"extractive",
"models",
"during",
"training",
"as",
"typically",
"all",
"the",
"answer",
"annotations",
"are",
"used",
"to",
"matches",
"within",
"documents",
"when",
"preparing",
"training",
"data",
"for",
"rag",
"we",
"also",
"make",
"use",
"of",
"multiple",
"annotation",
"examples",
"for",
"natural",
"questions",
"and",
"webquestions",
"by",
"training",
"the",
"model",
"with",
"each",
"q",
"a",
"pair",
"separately",
"leading",
"to",
"a",
"small",
"increase",
"in",
"accuracy",
"for",
"triviaqa",
"there",
"are",
"often",
"many",
"valid",
"answers",
"to",
"a",
"given",
"question",
"some",
"of",
"which",
"are",
"not",
"suitable",
"training",
"targets",
"such",
"as",
"emoji",
"or",
"spelling",
"variants",
"for",
"triviaqa",
"we",
"out",
"answer",
"candidates",
"if",
"they",
"do",
"not",
"occur",
"in",
"top",
"1000",
"documents",
"for",
"the",
"query",
"curatedtrec",
"preprocessing",
"the",
"answers",
"for",
"curatedtrec",
"are",
"given",
"in",
"the",
"form",
"of",
"regular",
"expres",
"sions",
"which",
"has",
"been",
"suggested",
"as",
"a",
"reason",
"why",
"it",
"is",
"unsuitable",
"for",
"answer",
"generation",
"models",
"20",
"to",
"overcome",
"this",
"we",
"use",
"a",
"pre",
"processing",
"step",
"where",
"we",
"retrieve",
"the",
"top",
"1000",
"documents",
"for",
"each",
"query",
"and",
"use",
"the",
"answer",
"that",
"most",
"frequently",
"matches",
"the",
"regex",
"pattern",
"as",
"the",
"supervision",
"target",
"if",
"no",
"matches",
"are",
"found",
"we",
"resort",
"to",
"a",
"simple",
"heuristic",
"generate",
"all",
"possible",
"permutations",
"for",
"each",
"regex",
"replacing",
"non",
"deterministic",
"symbols",
"in",
"the",
"regex",
"nested",
"tree",
"structure",
"with",
"a",
"whitespace",
"triviaqa",
"evaluation",
"setups",
"the",
"open",
"domain",
"qa",
"community",
"customarily",
"uses",
"public",
"develop",
"ment",
"datasets",
"as",
"test",
"datasets",
"as",
"test",
"data",
"for",
"qa",
"datasets",
"is",
"often",
"restricted",
"and",
"dedicated",
"to",
"reading",
"compehension",
"purposes",
"we",
"report",
"our",
"results",
"using",
"the",
"datasets",
"splits",
"used",
"in",
"dpr",
"26",
"which",
"are",
"consistent",
"with",
"common",
"practice",
"in",
"open",
"domain",
"qa",
"for",
"triviaqa",
"this",
"test",
"dataset",
"is",
"the",
"public",
"triviaqa",
"web",
"development",
"split",
"roberts",
"et",
"al",
"52",
"used",
"the",
"triviaqa",
"wikipedia",
"test",
"set",
"instead",
"et",
"al",
"14",
"follow",
"this",
"convention",
"in",
"order",
"to",
"compare",
"with",
"roberts",
"et",
"al",
"52",
"see",
"appendix",
"of",
"14",
"we",
"report",
"results",
"on",
"both",
"test",
"sets",
"to",
"enable",
"fair",
"comparison",
"to",
"both",
"approaches"
],
[
"roberts",
"et",
"al",
"52",
"used",
"the",
"triviaqa",
"wikipedia",
"test",
"set",
"instead",
"et",
"al",
"14",
"follow",
"this",
"convention",
"in",
"order",
"to",
"compare",
"with",
"roberts",
"et",
"al",
"52",
"see",
"appendix",
"of",
"14",
"we",
"report",
"results",
"on",
"both",
"test",
"sets",
"to",
"enable",
"fair",
"comparison",
"to",
"both",
"approaches",
"we",
"that",
"our",
"performance",
"is",
"much",
"higher",
"using",
"the",
"wiki",
"test",
"set",
"rather",
"than",
"the",
"more",
"conventional",
"open",
"domain",
"test",
"set",
"which",
"we",
"attribute",
"to",
"the",
"wiki",
"test",
"set",
"questions",
"being",
"simpler",
"to",
"answer",
"from",
"wikipedia",
"e",
"further",
"details",
"on",
"fever",
"for",
"fever",
"we",
"follow",
"the",
"practice",
"from",
"32",
"and",
"re",
"generate",
"the",
"claim",
"and",
"then",
"classify",
"using",
"the",
"representation",
"of",
"the",
"hidden",
"state",
"before",
"marginalizing",
"across",
"documents",
"to",
"obtain",
"the",
"class",
"probabilities",
"the",
"fever",
"task",
"traditionally",
"has",
"two",
"sub",
"tasks",
"the",
"is",
"to",
"classify",
"the",
"claim",
"as",
"either",
"supported",
"refuted",
"or",
"not",
"enough",
"info",
"which",
"is",
"the",
"task",
"we",
"explore",
"in",
"the",
"main",
"paper",
"fever",
"s",
"other",
"sub",
"task",
"involves",
"extracting",
"sentences",
"from",
"wikipedia",
"as",
"evidence",
"supporting",
"the",
"prediction",
"as",
"fever",
"uses",
"a",
"different",
"wikipedia",
"dump",
"to",
"us",
"directly",
"tackling",
"this",
"task",
"is",
"not",
"straightforward",
"we",
"hope",
"to",
"address",
"this",
"in",
"future",
"work",
"f",
"null",
"document",
"probabilities",
"we",
"experimented",
"with",
"adding",
"null",
"document",
"mechanism",
"to",
"rag",
"similar",
"to",
"realm",
"20",
"in",
"order",
"to",
"model",
"cases",
"where",
"no",
"useful",
"information",
"could",
"be",
"retrieved",
"for",
"a",
"given",
"input",
"here",
"if",
"kdocuments",
"were",
"retrieved",
"we",
"would",
"additionally",
"retrieve",
"an",
"empty",
"document",
"and",
"predict",
"a",
"logit",
"for",
"the",
"null",
"document",
"before",
"marginalizing",
"over",
"k",
"1predictions",
"we",
"explored",
"modelling",
"this",
"null",
"document",
"logit",
"by",
"learning",
"i",
"a",
"document",
"embedding",
"for",
"the",
"null",
"document",
"ii",
"a",
"static",
"learnt",
"bias",
"term",
"or",
"iii",
"a",
"neural",
"network",
"to",
"predict",
"the",
"logit",
"we",
"did",
"not",
"that",
"these",
"improved",
"performance",
"so",
"in",
"the",
"interests",
"of",
"simplicity",
"we",
"omit",
"them"
],
[
"we",
"did",
"not",
"that",
"these",
"improved",
"performance",
"so",
"in",
"the",
"interests",
"of",
"simplicity",
"we",
"omit",
"them",
"for",
"open",
"ms",
"marco",
"where",
"useful",
"retrieved",
"documents",
"cannot",
"always",
"be",
"retrieved",
"we",
"observe",
"that",
"the",
"model",
"learns",
"to",
"always",
"retrieve",
"a",
"particular",
"set",
"of",
"documents",
"for",
"questions",
"that",
"are",
"less",
"likely",
"to",
"from",
"retrieval",
"suggesting",
"that",
"null",
"document",
"mechanisms",
"may",
"not",
"be",
"necessary",
"for",
"rag",
"g",
"parameters",
"our",
"rag",
"models",
"contain",
"the",
"trainable",
"parameters",
"for",
"the",
"bert",
"base",
"query",
"and",
"document",
"encoder",
"of",
"dpr",
"with",
"110m",
"parameters",
"each",
"although",
"we",
"do",
"not",
"train",
"the",
"document",
"encoder",
"ourselves",
"and",
"406m",
"trainable",
"parameters",
"from",
"bart",
"large",
"406m",
"parameters",
"making",
"a",
"total",
"of",
"626m",
"trainable",
"18"
],
[
"table",
"7",
"number",
"of",
"instances",
"in",
"the",
"datasets",
"used",
"a",
"hidden",
"subset",
"of",
"this",
"data",
"is",
"used",
"for",
"evaluation",
"task",
"train",
"development",
"test",
"natural",
"questions",
"79169",
"8758",
"3611",
"triviaqa",
"78786",
"8838",
"11314",
"webquestions",
"3418",
"362",
"2033",
"curatedtrec",
"635",
"134",
"635",
"jeopardy",
"question",
"generation",
"97392",
"13714",
"26849",
"ms",
"marco",
"153726",
"12468",
"101093",
"fever",
"3",
"way",
"145450",
"10000",
"10000",
"fever",
"2",
"way",
"96966",
"6666",
"6666",
"parameters",
"the",
"best",
"performing",
"closed",
"book",
"parametric",
"only",
"open",
"domain",
"qa",
"model",
"is",
"t5",
"11b",
"with",
"11",
"billion",
"trainable",
"parameters",
"the",
"t5",
"model",
"with",
"the",
"closest",
"number",
"of",
"parameters",
"to",
"our",
"models",
"is",
"t5",
"large",
"770m",
"parameters",
"which",
"achieves",
"a",
"score",
"of",
"28",
"9",
"em",
"on",
"natural",
"questions",
"52",
"substantially",
"below",
"the",
"44",
"5",
"that",
"rag",
"sequence",
"achieves",
"indicating",
"that",
"hybrid",
"parametric",
"non",
"parametric",
"models",
"require",
"far",
"fewer",
"trainable",
"parameters",
"for",
"strong",
"open",
"domain",
"qa",
"performance",
"the",
"non",
"parametric",
"memory",
"index",
"does",
"not",
"consist",
"of",
"trainable",
"parameters",
"but",
"does",
"consists",
"of",
"21m",
"728",
"dimensional",
"vectors",
"consisting",
"of",
"15",
"3b",
"values",
"these",
"can",
"be",
"easily",
"be",
"stored",
"at",
"8",
"bit",
"point",
"precision",
"to",
"manage",
"memory",
"and",
"disk",
"footprints",
"h",
"retrieval",
"collapse",
"in",
"preliminary",
"experiments",
"we",
"observed",
"that",
"for",
"some",
"tasks",
"such",
"as",
"story",
"generation",
"11",
"the",
"retrieval",
"component",
"would",
"collapse",
"and",
"learn",
"to",
"retrieve",
"the",
"same",
"documents",
"regardless",
"of",
"the",
"input",
"in",
"these",
"cases",
"once",
"retrieval",
"had",
"collapsed",
"the",
"generator",
"would",
"learn",
"to",
"ignore",
"the",
"documents",
"and",
"the",
"rag",
"model",
"would",
"perform",
"equivalently",
"to",
"bart",
"the",
"collapse",
"could",
"be",
"due",
"to",
"a",
"less",
"explicit",
"requirement",
"for",
"factual",
"knowledge",
"in",
"some",
"tasks",
"or",
"the",
"longer",
"target",
"sequences",
"which",
"could",
"result",
"in",
"less",
"informative",
"gradients",
"for",
"the",
"retriever",
"perez",
"et",
"al",
"46",
"also",
"found",
"spurious",
"retrieval",
"results",
"when",
"optimizing",
"a",
"retrieval",
"component",
"in",
"order",
"to",
"improve",
"performance",
"on",
"downstream",
"tasks",
"i",
"number",
"of",
"instances",
"per",
"dataset",
"the",
"number",
"of",
"training",
"development",
"and",
"test",
"datapoints",
"in",
"each",
"of",
"our",
"datasets",
"is",
"shown",
"in",
"table",
"7",
"19"
]
]
}